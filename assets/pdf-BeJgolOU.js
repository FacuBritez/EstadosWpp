function _mergeNamespaces($,e){for(var E=0;E<e.length;E++){const n=e[E];if(typeof n!="string"&&!Array.isArray(n)){for(const d in n)if(d!=="default"&&!(d in $)){const O=Object.getOwnPropertyDescriptor(n,d);O&&Object.defineProperty($,d,O.get?O:{enumerable:!0,get:()=>n[d]})}}}return Object.freeze(Object.defineProperty($,Symbol.toStringTag,{value:"Module"}))}function getDefaultExportFromCjs($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}function getAugmentedNamespace($){if($.__esModule)return $;var e=$.default;if(typeof e=="function"){var E=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};E.prototype=e.prototype}else E={};return Object.defineProperty(E,"__esModule",{value:!0}),Object.keys($).forEach(function(n){var d=Object.getOwnPropertyDescriptor($,n);Object.defineProperty(E,n,d.get?d:{enumerable:!0,get:function(){return $[n]}})}),E}function commonjsRequire($){throw new Error('Could not dynamically require "'+$+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(e,E){module.exports=E()})(globalThis,()=>(()=>{var __webpack_modules__=[,($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.UNSUPPORTED_FEATURES=e.TextRenderingMode=e.StreamType=e.RenderingIntentFlag=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FontType=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.AnnotationType=e.AnnotationStateModelType=e.AnnotationReviewState=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationMarkedState=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.arrayByteLength=nt,e.arraysToBytes=it,e.assert=T,e.bytesToString=et,e.createPromiseCapability=Wt,e.createValidAbsoluteUrl=i,e.escapeString=Tt,e.getModificationDate=qt,e.getVerbosityLevel=x,e.info=h,e.isArrayBuffer=Ut,e.isArrayEqual=Bt,e.isAscii=_t,e.objectFromMap=st,e.objectSize=ot,e.setVerbosityLevel=z,e.shadow=f,e.string32=at,e.stringToBytes=J,e.stringToPDFString=At,e.stringToUTF16BEString=pt,e.stringToUTF8String=Ft,e.unreachable=S,e.utf8StringToString=jt,e.warn=c,E(2);const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const d=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=d;const O=1.35;e.LINE_FACTOR=O;const R=.35;e.LINE_DESCENT_FACTOR=R;const L={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=L;const _={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=_;const s="pdfjs_internal_editor_";e.AnnotationEditorPrefix=s;const a={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};e.AnnotationEditorType=a;const u={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};e.AnnotationEditorParamsType=u;const p={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=p;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=A;const o={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=o;const g={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=g;const b={MARKED:"Marked",REVIEW:"Review"};e.AnnotationStateModelType=b;const D={MARKED:"Marked",UNMARKED:"Unmarked"};e.AnnotationMarkedState=D;const k={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};e.AnnotationReviewState=k;const M={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=M;const m={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=m;const r={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=r;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=l;const y={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=y;const w={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=w;const P={O:"PageOpen",C:"PageClose"};e.PageActionEventType=P;const j={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};e.StreamType=j;const N={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};e.FontType=N;const tt={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=tt;const Z={NONE:0,BINARY:1,STREAM:2};e.CMapCompressionType=Z;const B={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=B;const U={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};e.UNSUPPORTED_FEATURES=U;const q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=q;let Y=tt.WARNINGS;function z(Q){Number.isInteger(Q)&&(Y=Q)}function x(){return Y}function h(Q){Y>=tt.INFOS&&console.log(`Info: ${Q}`)}function c(Q){Y>=tt.WARNINGS&&console.log(`Warning: ${Q}`)}function S(Q){throw new Error(Q)}function T(Q,G){Q||S(G)}function t(Q){if(!Q)return!1;switch(Q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function i(Q,G=null,X=null){if(!Q)return null;try{if(X&&typeof Q=="string"){if(X.addDefaultProtocol&&Q.startsWith("www.")){const ct=Q.match(/\./g);ct&&ct.length>=2&&(Q=`http://${Q}`)}if(X.tryConvertEncoding)try{Q=Ft(Q)}catch{}}const rt=G?new URL(Q,G):new URL(Q);if(t(rt))return rt}catch{}return null}function f(Q,G,X){return Object.defineProperty(Q,G,{value:X,enumerable:!0,configurable:!0,writable:!1}),X}const v=function(){function G(X,rt){this.constructor===G&&S("Cannot initialize BaseException."),this.message=X,this.name=rt}return G.prototype=new Error,G.constructor=G,G}();e.BaseException=v;class C extends v{constructor(G,X){super(G,"PasswordException"),this.code=X}}e.PasswordException=C;class F extends v{constructor(G,X){super(G,"UnknownErrorException"),this.details=X}}e.UnknownErrorException=F;class I extends v{constructor(G){super(G,"InvalidPDFException")}}e.InvalidPDFException=I;class W extends v{constructor(G){super(G,"MissingPDFException")}}e.MissingPDFException=W;class V extends v{constructor(G,X){super(G,"UnexpectedResponseException"),this.status=X}}e.UnexpectedResponseException=V;class H extends v{constructor(G){super(G,"FormatError")}}e.FormatError=H;class K extends v{constructor(G){super(G,"AbortException")}}e.AbortException=K;function et(Q){(typeof Q!="object"||Q===null||Q.length===void 0)&&S("Invalid argument for bytesToString");const G=Q.length,X=8192;if(G<X)return String.fromCharCode.apply(null,Q);const rt=[];for(let ct=0;ct<G;ct+=X){const dt=Math.min(ct+X,G),ht=Q.subarray(ct,dt);rt.push(String.fromCharCode.apply(null,ht))}return rt.join("")}function J(Q){typeof Q!="string"&&S("Invalid argument for stringToBytes");const G=Q.length,X=new Uint8Array(G);for(let rt=0;rt<G;++rt)X[rt]=Q.charCodeAt(rt)&255;return X}function nt(Q){if(Q.length!==void 0)return Q.length;if(Q.byteLength!==void 0)return Q.byteLength;S("Invalid argument for arrayByteLength")}function it(Q){const G=Q.length;if(G===1&&Q[0]instanceof Uint8Array)return Q[0];let X=0;for(let dt=0;dt<G;dt++)X+=nt(Q[dt]);let rt=0;const ct=new Uint8Array(X);for(let dt=0;dt<G;dt++){let ht=Q[dt];ht instanceof Uint8Array||(typeof ht=="string"?ht=J(ht):ht=new Uint8Array(ht));const Et=ht.byteLength;ct.set(ht,rt),rt+=Et}return ct}function at(Q){return String.fromCharCode(Q>>24&255,Q>>16&255,Q>>8&255,Q&255)}function ot(Q){return Object.keys(Q).length}function st(Q){const G=Object.create(null);for(const[X,rt]of Q)G[X]=rt;return G}function ft(){const Q=new Uint8Array(4);return Q[0]=1,new Uint32Array(Q.buffer,0,1)[0]===1}function mt(){try{return new Function(""),!0}catch{return!1}}class lt{static get isLittleEndian(){return f(this,"isLittleEndian",ft())}static get isEvalSupported(){return f(this,"isEvalSupported",mt())}static get isOffscreenCanvasSupported(){return f(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}e.FeatureTest=lt;const ut=[...Array(256).keys()].map(Q=>Q.toString(16).padStart(2,"0"));class gt{static makeHexColor(G,X,rt){return`#${ut[G]}${ut[X]}${ut[rt]}`}static scaleMinMax(G,X){let rt;G[0]?(G[0]<0&&(rt=X[0],X[0]=X[1],X[1]=rt),X[0]*=G[0],X[1]*=G[0],G[3]<0&&(rt=X[2],X[2]=X[3],X[3]=rt),X[2]*=G[3],X[3]*=G[3]):(rt=X[0],X[0]=X[2],X[2]=rt,rt=X[1],X[1]=X[3],X[3]=rt,G[1]<0&&(rt=X[2],X[2]=X[3],X[3]=rt),X[2]*=G[1],X[3]*=G[1],G[2]<0&&(rt=X[0],X[0]=X[1],X[1]=rt),X[0]*=G[2],X[1]*=G[2]),X[0]+=G[4],X[1]+=G[4],X[2]+=G[5],X[3]+=G[5]}static transform(G,X){return[G[0]*X[0]+G[2]*X[1],G[1]*X[0]+G[3]*X[1],G[0]*X[2]+G[2]*X[3],G[1]*X[2]+G[3]*X[3],G[0]*X[4]+G[2]*X[5]+G[4],G[1]*X[4]+G[3]*X[5]+G[5]]}static applyTransform(G,X){const rt=G[0]*X[0]+G[1]*X[2]+X[4],ct=G[0]*X[1]+G[1]*X[3]+X[5];return[rt,ct]}static applyInverseTransform(G,X){const rt=X[0]*X[3]-X[1]*X[2],ct=(G[0]*X[3]-G[1]*X[2]+X[2]*X[5]-X[4]*X[3])/rt,dt=(-G[0]*X[1]+G[1]*X[0]+X[4]*X[1]-X[5]*X[0])/rt;return[ct,dt]}static getAxialAlignedBoundingBox(G,X){const rt=gt.applyTransform(G,X),ct=gt.applyTransform(G.slice(2,4),X),dt=gt.applyTransform([G[0],G[3]],X),ht=gt.applyTransform([G[2],G[1]],X);return[Math.min(rt[0],ct[0],dt[0],ht[0]),Math.min(rt[1],ct[1],dt[1],ht[1]),Math.max(rt[0],ct[0],dt[0],ht[0]),Math.max(rt[1],ct[1],dt[1],ht[1])]}static inverseTransform(G){const X=G[0]*G[3]-G[1]*G[2];return[G[3]/X,-G[1]/X,-G[2]/X,G[0]/X,(G[2]*G[5]-G[4]*G[3])/X,(G[4]*G[1]-G[5]*G[0])/X]}static apply3dTransform(G,X){return[G[0]*X[0]+G[1]*X[1]+G[2]*X[2],G[3]*X[0]+G[4]*X[1]+G[5]*X[2],G[6]*X[0]+G[7]*X[1]+G[8]*X[2]]}static singularValueDecompose2dScale(G){const X=[G[0],G[2],G[1],G[3]],rt=G[0]*X[0]+G[1]*X[2],ct=G[0]*X[1]+G[1]*X[3],dt=G[2]*X[0]+G[3]*X[2],ht=G[2]*X[1]+G[3]*X[3],Et=(rt+ht)/2,Pt=Math.sqrt((rt+ht)**2-4*(rt*ht-dt*ct))/2,xt=Et+Pt||1,yt=Et-Pt||1;return[Math.sqrt(xt),Math.sqrt(yt)]}static normalizeRect(G){const X=G.slice(0);return G[0]>G[2]&&(X[0]=G[2],X[2]=G[0]),G[1]>G[3]&&(X[1]=G[3],X[3]=G[1]),X}static intersect(G,X){const rt=Math.max(Math.min(G[0],G[2]),Math.min(X[0],X[2])),ct=Math.min(Math.max(G[0],G[2]),Math.max(X[0],X[2]));if(rt>ct)return null;const dt=Math.max(Math.min(G[1],G[3]),Math.min(X[1],X[3])),ht=Math.min(Math.max(G[1],G[3]),Math.max(X[1],X[3]));return dt>ht?null:[rt,dt,ct,ht]}static bezierBoundingBox(G,X,rt,ct,dt,ht,Et,Pt){const xt=[],yt=[[],[]];let wt,Ct,Mt,bt,Ot,Dt,It,Lt;for(let Nt=0;Nt<2;++Nt){if(Nt===0?(Ct=6*G-12*rt+6*dt,wt=-3*G+9*rt-9*dt+3*Et,Mt=3*rt-3*G):(Ct=6*X-12*ct+6*ht,wt=-3*X+9*ct-9*ht+3*Pt,Mt=3*ct-3*X),Math.abs(wt)<1e-12){if(Math.abs(Ct)<1e-12)continue;bt=-Mt/Ct,0<bt&&bt<1&&xt.push(bt);continue}It=Ct*Ct-4*Mt*wt,Lt=Math.sqrt(It),!(It<0)&&(Ot=(-Ct+Lt)/(2*wt),0<Ot&&Ot<1&&xt.push(Ot),Dt=(-Ct-Lt)/(2*wt),0<Dt&&Dt<1&&xt.push(Dt))}let kt=xt.length,vt;const Rt=kt;for(;kt--;)bt=xt[kt],vt=1-bt,yt[0][kt]=vt*vt*vt*G+3*vt*vt*bt*rt+3*vt*bt*bt*dt+bt*bt*bt*Et,yt[1][kt]=vt*vt*vt*X+3*vt*vt*bt*ct+3*vt*bt*bt*ht+bt*bt*bt*Pt;return yt[0][Rt]=G,yt[1][Rt]=X,yt[0][Rt+1]=Et,yt[1][Rt+1]=Pt,yt[0].length=yt[1].length=Rt+2,[Math.min(...yt[0]),Math.min(...yt[1]),Math.max(...yt[0]),Math.max(...yt[1])]}}e.Util=gt;const St=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function At(Q){if(Q[0]>="ï"){let X;if(Q[0]==="þ"&&Q[1]==="ÿ"?X="utf-16be":Q[0]==="ÿ"&&Q[1]==="þ"?X="utf-16le":Q[0]==="ï"&&Q[1]==="»"&&Q[2]==="¿"&&(X="utf-8"),X)try{const rt=new TextDecoder(X,{fatal:!0}),ct=J(Q);return rt.decode(ct)}catch(rt){c(`stringToPDFString: "${rt}".`)}}const G=[];for(let X=0,rt=Q.length;X<rt;X++){const ct=St[Q.charCodeAt(X)];G.push(ct?String.fromCharCode(ct):Q.charAt(X))}return G.join("")}function Tt(Q){return Q.replace(/([()\\\n\r])/g,G=>G===`
`?"\\n":G==="\r"?"\\r":`\\${G}`)}function _t(Q){return/^[\x00-\x7F]*$/.test(Q)}function pt(Q){const G=["þÿ"];for(let X=0,rt=Q.length;X<rt;X++){const ct=Q.charCodeAt(X);G.push(String.fromCharCode(ct>>8&255),String.fromCharCode(ct&255))}return G.join("")}function Ft(Q){return decodeURIComponent(escape(Q))}function jt(Q){return unescape(encodeURIComponent(Q))}function Ut(Q){return typeof Q=="object"&&Q!==null&&Q.byteLength!==void 0}function Bt(Q,G){if(Q.length!==G.length)return!1;for(let X=0,rt=Q.length;X<rt;X++)if(Q[X]!==G[X])return!1;return!0}function qt(Q=new Date){return[Q.getUTCFullYear().toString(),(Q.getUTCMonth()+1).toString().padStart(2,"0"),Q.getUTCDate().toString().padStart(2,"0"),Q.getUTCHours().toString().padStart(2,"0"),Q.getUTCMinutes().toString().padStart(2,"0"),Q.getUTCSeconds().toString().padStart(2,"0")].join("")}function Wt(){const Q=Object.create(null);let G=!1;return Object.defineProperty(Q,"settled",{get(){return G}}),Q.promise=new Promise(function(X,rt){Q.resolve=function(ct){G=!0,X(ct)},Q.reject=function(ct){G=!0,rt(ct)}}),Q}},($,e,E)=>{E(3)},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeJS=void 0;const E=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=E},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:$,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:E}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=$,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=E}let createPDFNetworkStream;function setPDFNetworkStreamFactory($){createPDFNetworkStream=$}function getDocument($){const e=new PDFDocumentLoadingTask;let E;if(typeof $=="string"||$ instanceof URL)E={url:$};else if((0,_util.isArrayBuffer)($))E={data:$};else if($ instanceof PDFDataRangeTransport)E={range:$};else{if(typeof $!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!$.url&&!$.data&&!$.range)throw new Error("Invalid parameter object: need either .data, .range or .url");E=$}const n=Object.create(null);let d=null,O=null;for(const L in E){const _=E[L];switch(L){case"url":if(typeof window<"u")try{n[L]=new URL(_,window.location).href;continue}catch(s){(0,_util.warn)(`Cannot create valid URL: "${s}".`)}else if(typeof _=="string"||_ instanceof URL){n[L]=_.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":d=_;continue;case"worker":O=_;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&_ instanceof Buffer)n[L]=new Uint8Array(_);else{if(_ instanceof Uint8Array)break;if(typeof _=="string")n[L]=(0,_util.stringToBytes)(_);else if(typeof _=="object"&&_!==null&&!isNaN(_.length))n[L]=new Uint8Array(_);else if((0,_util.isArrayBuffer)(_))n[L]=new Uint8Array(_);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}n[L]=_}if(n.CMapReaderFactory=n.CMapReaderFactory||DefaultCMapReaderFactory,n.StandardFontDataFactory=n.StandardFontDataFactory||DefaultStandardFontDataFactory,n.ignoreErrors=n.stopAtErrors!==!0,n.fontExtraProperties=n.fontExtraProperties===!0,n.pdfBug=n.pdfBug===!0,n.enableXfa=n.enableXfa===!0,(!Number.isInteger(n.rangeChunkSize)||n.rangeChunkSize<1)&&(n.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof n.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(n.docBaseUrl))&&(n.docBaseUrl=null),(!Number.isInteger(n.maxImageSize)||n.maxImageSize<-1)&&(n.maxImageSize=-1),typeof n.cMapUrl!="string"&&(n.cMapUrl=null),typeof n.standardFontDataUrl!="string"&&(n.standardFontDataUrl=null),typeof n.useWorkerFetch!="boolean"&&(n.useWorkerFetch=n.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&n.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof n.isEvalSupported!="boolean"&&(n.isEvalSupported=!0),typeof n.disableFontFace!="boolean"&&(n.disableFontFace=_is_node.isNodeJS),typeof n.useSystemFonts!="boolean"&&(n.useSystemFonts=!_is_node.isNodeJS&&!n.disableFontFace),(typeof n.ownerDocument!="object"||n.ownerDocument===null)&&(n.ownerDocument=globalThis.document),typeof n.disableRange!="boolean"&&(n.disableRange=!1),typeof n.disableStream!="boolean"&&(n.disableStream=!1),typeof n.disableAutoFetch!="boolean"&&(n.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(n.verbosity),!O){const L={verbosity:n.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};O=L.port?PDFWorker.fromPort(L):new PDFWorker(L),e._worker=O}const R=e.docId;return O.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const L=_fetchDocument(O,n,d,R),_=new Promise(function(s){let a;d?a=new _transport_stream.PDFDataTransportStream({length:n.length,initialData:n.initialData,progressiveDone:n.progressiveDone,contentDispositionFilename:n.contentDispositionFilename,disableRange:n.disableRange,disableStream:n.disableStream},d):n.data||(a=createPDFNetworkStream({url:n.url,length:n.length,httpHeaders:n.httpHeaders,withCredentials:n.withCredentials,rangeChunkSize:n.rangeChunkSize,disableRange:n.disableRange,disableStream:n.disableStream})),s(a)});return Promise.all([L,_]).then(function([s,a]){if(e.destroyed)throw new Error("Loading aborted");const u=new _message_handler.MessageHandler(R,s,O.port),p=new WorkerTransport(u,e,a,n);e._transport=p,u.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument($,e,E,n){if($.destroyed)throw new Error("Worker was destroyed");E&&(e.length=E.length,e.initialData=E.initialData,e.progressiveDone=E.progressiveDone,e.contentDispositionFilename=E.contentDispositionFilename);const d=await $.messageHandler.sendWithPromise("GetDocRequest",{docId:n,apiVersion:"2.16.105",source:{data:e.data,url:e.url,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length},maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,docBaseUrl:e.docBaseUrl,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,fontExtraProperties:e.fontExtraProperties,enableXfa:e.enableXfa,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null});if(e.data&&(e.data=null),$.destroyed)throw new Error("Worker was destroyed");return d}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,E,n=!1,d=null){this.length=e,this.initialData=E,this.progressiveDone=n,this.contentDispositionFilename=d,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,E){for(const n of this._rangeListeners)n(e,E)}onDataProgress(e,E){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,E)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const E of this._progressiveReadListeners)E(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,E){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,E){this._pdfInfo=e,this._transport=E,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,E,n,d,O=!1){this._pageIndex=e,this._pageInfo=E,this._ownerDocument=d,this._transport=n,this._stats=O?new _display_utils.StatTimer:null,this._pdfBug=O,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:E=this.rotate,offsetX:n=0,offsetY:d=0,dontFlip:O=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:E,offsetX:n,offsetY:d,dontFlip:O})}getAnnotations({intent:e="display"}={}){const E=this._transport.getRenderingIntent(e);let n=this._annotationPromises.get(E.cacheKey);return n||(n=this._transport.getAnnotations(this._pageIndex,E.renderingIntent),this._annotationPromises.set(E.cacheKey,n),n=n.then(d=>{for(const O of d)O.titleObj!==void 0&&Object.defineProperty(O,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),O.titleObj.str}}),O.contentsObj!==void 0&&Object.defineProperty(O,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),O.contentsObj.str}});return d})),n}getJSActions(){return this._jsActionsPromise||=this._transport.getPageJSActions(this._pageIndex)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:E,intent:n="display",annotationMode:d=_util.AnnotationMode.ENABLE,transform:O=null,imageLayer:R=null,canvasFactory:L=null,background:_=null,optionalContentConfigPromise:s=null,annotationCanvasMap:a=null,pageColors:u=null,printAnnotationStorage:p=null}){arguments[0]?.renderInteractiveForms!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&d===_util.AnnotationMode.ENABLE&&(d=_util.AnnotationMode.ENABLE_FORMS)),arguments[0]?.includeAnnotationStorage!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&d===_util.AnnotationMode.ENABLE&&(d=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const A=this._transport.getRenderingIntent(n,d,p);this.pendingCleanup=!1,s||(s=this._transport.getOptionalContentConfig());let o=this._intentStates.get(A.cacheKey);o||(o=Object.create(null),this._intentStates.set(A.cacheKey,o)),o.streamReaderCancelTimeout&&(clearTimeout(o.streamReaderCancelTimeout),o.streamReaderCancelTimeout=null);const g=L||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),b=!!(A.renderingIntent&_util.RenderingIntentFlag.PRINT);o.displayReadyCapability||(o.displayReadyCapability=(0,_util.createPromiseCapability)(),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(A));const D=m=>{o.renderTasks.delete(k),(this.cleanupAfterRender||b)&&(this.pendingCleanup=!0),this._tryCleanup(),m?(k.capability.reject(m),this._abortOperatorList({intentState:o,reason:m instanceof Error?m:new Error(m)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},k=new InternalRenderTask({callback:D,params:{canvasContext:e,viewport:E,transform:O,imageLayer:R,background:_},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:a,operatorList:o.operatorList,pageIndex:this._pageIndex,canvasFactory:g,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:u});(o.renderTasks||=new Set).add(k);const M=k.task;return Promise.all([o.displayReadyCapability.promise,s]).then(([m,r])=>{if(this.pendingCleanup){D();return}this._stats&&this._stats.time("Rendering"),k.initializeGraphics({transparency:m,optionalContentConfig:r}),k.operatorListChanged()}).catch(D),M}getOperatorList({intent:e="display",annotationMode:E=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){function d(){R.operatorList.lastChunk&&(R.opListReadCapability.resolve(R.operatorList),R.renderTasks.delete(L))}const O=this._transport.getRenderingIntent(e,E,n,!0);let R=this._intentStates.get(O.cacheKey);R||(R=Object.create(null),this._intentStates.set(O.cacheKey,R));let L;return R.opListReadCapability||(L=Object.create(null),L.operatorListChanged=d,R.opListReadCapability=(0,_util.createPromiseCapability)(),(R.renderTasks||=new Set).add(L),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(O)),R.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:E=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:E===!0},{highWaterMark:100,size(d){return d.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>_xfa_text.XfaText.textContent(n));const E=this.streamTextContent(e);return new Promise(function(n,d){function O(){R.read().then(function({value:_,done:s}){if(s){n(L);return}Object.assign(L.styles,_.styles),L.items.push(..._.items),O()},d)}const R=E.getReader(),L={items:[],styles:Object.create(null)};O()})}getStructTree(){return this._structTreePromise||=this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const E of this._intentStates.values())if(this._abortOperatorList({intentState:E,reason:new Error("Page was destroyed."),force:!0}),!E.opListReadCapability)for(const n of E.renderTasks)e.push(n.completed),n.cancel();this.objs.clear();for(const E of this._bitmaps)E.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:E,operatorList:n}of this._intentStates.values())if(E.size>0||!n.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const E of this._bitmaps)E.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,E){const n=this._intentStates.get(E);n&&(this._stats&&this._stats.timeEnd("Page Request"),n.displayReadyCapability&&n.displayReadyCapability.resolve(e))}_renderPageChunk(e,E){for(let n=0,d=e.length;n<d;n++)E.operatorList.fnArray.push(e.fnArray[n]),E.operatorList.argsArray.push(e.argsArray[n]);E.operatorList.lastChunk=e.lastChunk,E.operatorList.separateAnnots=e.separateAnnots;for(const n of E.renderTasks)n.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:E,annotationStorageMap:n}){const O=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:E,annotationStorage:n}).getReader(),R=this._intentStates.get(E);R.streamReader=O;const L=()=>{O.read().then(({value:_,done:s})=>{if(s){R.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(_,R),L())},_=>{if(R.streamReader=null,!this._transport.destroyed){if(R.operatorList){R.operatorList.lastChunk=!0;for(const s of R.renderTasks)s.operatorListChanged();this._tryCleanup()}if(R.displayReadyCapability)R.displayReadyCapability.reject(_);else if(R.opListReadCapability)R.opListReadCapability.reject(_);else throw _}})};L()}_abortOperatorList({intentState:e,reason:E,force:n=!1}){if(e.streamReader){if(!n){if(e.renderTasks.size>0)return;if(E instanceof _display_utils.RenderingCancelledException){e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:E,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(e.streamReader.cancel(new _util.AbortException(E.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[d,O]of this._intentStates)if(O===e){this._intentStates.delete(d);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(e,E){const n={data:structuredClone(e,E)};this._deferred.then(()=>{for(const d of this._listeners)d.call(this,n)})}addEventListener(e,E){this._listeners.push(E)}removeEventListener(e,E){const n=this._listeners.indexOf(E);this._listeners.splice(n,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const $=document?.currentScript?.src;$&&(PDFWorkerUtil.fallbackWorkerSrc=$.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function($,e){let E;try{if(E=new URL($),!E.origin||E.origin==="null")return!1}catch{return!1}const n=new URL(e,E);return E.origin===n.origin},PDFWorkerUtil.createCDNWrapper=function($){const e=`importScripts("${$}");`;return URL.createObjectURL(new Blob([e]))}}class PDFWorker{static#workerPorts=new WeakMap;constructor({name:$=null,port:e=null,verbosity:E=(0,_util.getVerbosityLevel)()}={}){if(e&&PDFWorker.#workerPorts.has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=$,this.destroyed=!1,this.verbosity=E,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){PDFWorker.#workerPorts.set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort($){this._port=$,this._messageHandler=new _message_handler.MessageHandler("main","worker",$),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:$}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,$)||($=PDFWorkerUtil.createCDNWrapper(new URL($,window.location).href));const e=new Worker($),E=new _message_handler.MessageHandler("main","worker",e),n=()=>{e.removeEventListener("error",d),E.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},d=()=>{this._webWorker||n()};e.addEventListener("error",d),E.on("test",R=>{if(e.removeEventListener("error",d),this.destroyed){n();return}R?(this._messageHandler=E,this._port=e,this._webWorker=e,this._readyCapability.resolve(),E.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),E.destroy(),e.terminate())}),E.on("ready",R=>{if(e.removeEventListener("error",d),this.destroyed){n();return}try{O()}catch{this._setupFakeWorker()}});const O=()=>{const R=new Uint8Array;E.send("test",R,[R.buffer])};O();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then($=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const E=`fake${PDFWorkerUtil.fakeWorkerId++}`,n=new _message_handler.MessageHandler(E+"_worker",E,e);$.setup(n,e);const d=new _message_handler.MessageHandler(E,E+"_worker",e);this._messageHandler=d,this._readyCapability.resolve(),d.send("configure",{verbosity:this.verbosity})}).catch($=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${$.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort($){if(!$?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has($.port)?this.#workerPorts.get($.port):new PDFWorker($)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{#t=null;#e=new Map;#i=new Map;#s=null;constructor(e,E,n,d){this.messageHandler=e,this.loadingTask=E,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:E.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:d.ownerDocument,styleElement:d.styleElement}),this._params=d,d.useWorkerFetch||(this.CMapReaderFactory=new d.CMapReaderFactory({baseUrl:d.cMapUrl,isCompressed:d.cMapPacked}),this.StandardFontDataFactory=new d.StandardFontDataFactory({baseUrl:d.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return this.#t}getRenderingIntent(e,E=_util.AnnotationMode.ENABLE,n=null,d=!1){let O=_util.RenderingIntentFlag.DISPLAY,R=null;switch(e){case"any":O=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":O=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(E){case _util.AnnotationMode.DISABLE:O+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:O+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:O+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,R=(O&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${E}`)}return d&&(O+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:O,cacheKey:`${O}_${_annotation_storage.AnnotationStorage.getHash(R)}`,annotationStorageMap:R}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#e.values())e.push(n._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const E=this.messageHandler.sendWithPromise("Terminate",null);return e.push(E),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#s=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:E}=this;e.on("GetReader",(n,d)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=O=>{this._lastProgress={loaded:O.loaded,total:O.total}},d.onPull=()=>{this._fullReader.read().then(function({value:O,done:R}){if(R){d.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(O),"GetReader - expected an ArrayBuffer."),d.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{d.error(O)})},d.onCancel=O=>{this._fullReader.cancel(O),d.ready.catch(R=>{if(!this.destroyed)throw R})}}),e.on("ReaderHeadersReady",n=>{const d=(0,_util.createPromiseCapability)(),O=this._fullReader;return O.headersReady.then(()=>{(!O.isStreamingSupported||!O.isRangeSupported)&&(this._lastProgress&&E.onProgress?.(this._lastProgress),O.onProgress=R=>{E.onProgress?.({loaded:R.loaded,total:R.total})}),d.resolve({isStreamingSupported:O.isStreamingSupported,isRangeSupported:O.isRangeSupported,contentLength:O.contentLength})},d.reject),d.promise}),e.on("GetRangeReader",(n,d)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const O=this._networkStream.getRangeReader(n.begin,n.end);if(!O){d.close();return}d.onPull=()=>{O.read().then(function({value:R,done:L}){if(L){d.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(R),"GetRangeReader - expected an ArrayBuffer."),d.enqueue(new Uint8Array(R),1,[R])}).catch(R=>{d.error(R)})},d.onCancel=R=>{O.cancel(R),d.ready.catch(L=>{if(!this.destroyed)throw L})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,E._capability.resolve(new PDFDocumentProxy(n,this))}),e.on("DocException",function(n){let d;switch(n.name){case"PasswordException":d=new _util.PasswordException(n.message,n.code);break;case"InvalidPDFException":d=new _util.InvalidPDFException(n.message);break;case"MissingPDFException":d=new _util.MissingPDFException(n.message);break;case"UnexpectedResponseException":d=new _util.UnexpectedResponseException(n.message,n.status);break;case"UnknownErrorException":d=new _util.UnknownErrorException(n.message,n.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}E._capability.reject(d)}),e.on("PasswordRequest",n=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),E.onPassword){const d=O=>{O instanceof Error?this._passwordCapability.reject(O):this._passwordCapability.resolve({password:O})};try{E.onPassword(d,n.code)}catch(O){this._passwordCapability.reject(O)}}else this._passwordCapability.reject(new _util.PasswordException(n.message,n.code));return this._passwordCapability.promise}),e.on("DataLoaded",n=>{E.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,d,O])=>{if(!this.destroyed&&!this.commonObjs.has(n))switch(d){case"Font":const R=this._params;if("error"in O){const s=O.error;(0,_util.warn)(`Error during font loading: ${s}`),this.commonObjs.resolve(n,s);break}let L=null;R.pdfBug&&globalThis.FontInspector?.enabled&&(L={registerFont(s,a){globalThis.FontInspector.fontAdded(s,a)}});const _=new _font_loader.FontFaceObject(O,{isEvalSupported:R.isEvalSupported,disableFontFace:R.disableFontFace,ignoreErrors:R.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:L});this.fontLoader.bind(_).catch(s=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!R.fontExtraProperties&&_.data&&(_.data=null),this.commonObjs.resolve(n,_)});break;case"FontPath":case"Image":this.commonObjs.resolve(n,O);break;default:throw new Error(`Got unknown common object type ${d}`)}}),e.on("obj",([n,d,O,R])=>{if(this.destroyed)return;const L=this.#e.get(d);if(!L.objs.has(n))switch(O){case"Image":L.objs.resolve(n,R);const _=8e6;if(R){let s;if(R.bitmap){const{bitmap:a,width:u,height:p}=R;s=u*p*4,L._bitmaps.add(a)}else s=R.data?.length||0;s>_&&(L.cleanupAfterRender=!0)}break;case"Pattern":L.objs.resolve(n,R);break;default:throw new Error(`Got unknown object type ${O}`)}}),e.on("DocProgress",n=>{this.destroyed||E.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("DocStats",n=>{this.destroyed||(this.#t=Object.freeze({streamTypes:Object.freeze(n.streamTypes),fontTypes:Object.freeze(n.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const E=e-1,n=this.#i.get(E);if(n)return n;const d=this.messageHandler.sendWithPromise("GetPage",{pageIndex:E}).then(O=>{if(this.destroyed)throw new Error("Transport destroyed");const R=new PDFPageProxy(E,O,this,this._params.ownerDocument,this._params.pdfBug);return this.#e.set(E,R),R});return this.#i.set(E,d),d}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,E){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:E})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#s||=this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const E of this.#e.values())if(!E.cleanup())throw new Error(`startCleanup: Page ${E.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#s=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}class PDFObjects{#t=Object.create(null);#e(e){const E=this.#t[e];return E||(this.#t[e]={capability:(0,_util.createPromiseCapability)(),data:null})}get(e,E=null){if(E){const d=this.#e(e);return d.capability.promise.then(()=>E(d.data)),null}const n=this.#t[e];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){return this.#t[e]?.capability.settled||!1}resolve(e,E=null){const n=this.#e(e);n.data=E,n.capability.resolve()}clear(){this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(e){this.#t=e,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(){this.#t.cancel()}get separateAnnots(){const{separateAnnots:e}=this.#t.operatorList;if(!e)return!1;const{annotationCanvasMap:E}=this.#t;return e.form||e.canvas&&E?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:e,params:E,objs:n,commonObjs:d,annotationCanvasMap:O,operatorList:R,pageIndex:L,canvasFactory:_,useRequestAnimationFrame:s=!1,pdfBug:a=!1,pageColors:u=null}){this.callback=e,this.params=E,this.objs=n,this.commonObjs=d,this.annotationCanvasMap=O,this.operatorListIdx=null,this.operatorList=R,this._pageIndex=L,this.canvasFactory=_,this._pdfBug=a,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=s===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=E.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:E}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:d,transform:O,imageLayer:R,background:L}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,R,E,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:O,viewport:d,transparency:e,background:L}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(e=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=E(1),d=E(6),O=E(10);class R{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(s,a){const u=this._storage.get(s);return u===void 0?a:Object.assign(a,u)}getRawValue(s){return this._storage.get(s)}remove(s){if(this._storage.delete(s),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const a of this._storage.values())if(a instanceof d.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(s,a){const u=this._storage.get(s);let p=!1;if(u!==void 0)for(const[A,o]of Object.entries(a))u[A]!==o&&(p=!0,u[A]=o);else p=!0,this._storage.set(s,a);p&&this.#t(),a instanceof d.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(a.constructor._type)}has(s){return this._storage.has(s)}getAll(){return this._storage.size>0?(0,n.objectFromMap)(this._storage):null}get size(){return this._storage.size}#t(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new L(this)}get serializable(){if(this._storage.size===0)return null;const s=new Map;for(const[a,u]of this._storage){const p=u instanceof d.AnnotationEditor?u.serialize():u;p&&s.set(a,p)}return s}static getHash(s){if(!s)return"";const a=new O.MurmurHash3_64;for(const[u,p]of s)a.update(`${u}:${JSON.stringify(p)}`);return a.hexdigest()}}e.AnnotationStorage=R;class L extends R{#t=null;constructor(s){super(),this.#t=structuredClone(s.serializable)}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}e.PrintAnnotationStorage=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=E(7),d=E(1);class O{#t=this.focusin.bind(this);#e=this.focusout.bind(this);#i=!1;#s=!1;#r=!1;#h=O._zIndex++;static _colorManager=new n.ColorManager;static _zIndex=1;constructor(L){this.constructor===O&&(0,d.unreachable)("Cannot initialize AnnotationEditor."),this.parent=L.parent,this.id=L.id,this.width=this.height=null,this.pageIndex=L.parent.pageIndex,this.name=L.name,this.div=null;const[_,s]=this.parent.viewportBaseDimensions;this.x=L.x/_,this.y=L.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,d.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#h}focusin(L){this.#i?this.#i=!1:this.parent.setSelected(this)}focusout(L){!this.isAttachedToDOM||L.relatedTarget?.closest(`#${this.id}`)||(L.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(L){const _=this.parent.div.getBoundingClientRect();this.startX=L.clientX-_.x,this.startY=L.clientY-_.y,L.dataTransfer.setData("text/plain",this.id),L.dataTransfer.effectAllowed="move"}setAt(L,_,s,a){const[u,p]=this.parent.viewportBaseDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(L+s)/u,this.y=(_+a)/p,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(L,_){const[s,a]=this.parent.viewportBaseDimensions;[L,_]=this.screenToPageTranslation(L,_),this.x+=L/s,this.y+=_/a,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(L,_){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[_,-L];case 180:return[-L,-_];case 270:return[-_,L];default:return[L,_]}}setDims(L,_){const[s,a]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*L/s}%`,this.div.style.height=`${100*_/a}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#t),this.div.addEventListener("focusout",this.#e);const[L,_]=this.getInitialTranslation();return this.translate(L,_),(0,n.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(L){const _=n.KeyboardManager.platform.isMac;if(L.button!==0||L.ctrlKey&&_){L.preventDefault();return}L.ctrlKey&&!_||L.shiftKey||L.metaKey&&_?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#i=!0}getRect(L,_){const[s,a]=this.parent.viewportBaseDimensions,[u,p]=this.parent.pageDimensions,A=u*L/s,o=p*_/a,g=this.x*u,b=this.y*p,D=this.width*u,k=this.height*p;switch(this.rotation){case 0:return[g+A,p-b-o-k,g+A+D,p-b-o];case 90:return[g+o,p-b+A,g+o+k,p-b+A+D];case 180:return[g-A-D,p-b+o,g-A,p-b+o+k];case 270:return[g-o-k,p-b-A-D,g-o,p-b-A];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(L,_){const[s,a,u,p]=L,A=u-s,o=p-a;switch(this.rotation){case 0:return[s,_-p,A,o];case 90:return[s,_-a,o,A];case 180:return[u,_-a,A,o];case 270:return[u,_-p,o,A];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#t)}serialize(){(0,d.unreachable)("An editor must be serializable")}static deserialize(L,_){const s=new this.prototype.constructor({parent:_,id:_.getNextId()});s.rotation=L.rotation;const[a,u]=_.pageDimensions,[p,A,o,g]=s.getRectInCurrentCoords(L.rect,u);return s.x=p/a,s.y=A/u,s.width=o/a,s.height=g/u,s}remove(){this.div.removeEventListener("focusin",this.#t),this.div.removeEventListener("focusout",this.#e),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(L,_){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#s}set isEditing(L){this.#s=L,L?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}e.AnnotationEditor=O},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=O,e.opacityToHex=R;var n=E(1),d=E(8);function O(A,o,g){for(const b of g)o.addEventListener(b,A[b].bind(A))}function R(A){return Math.round(Math.min(255,Math.max(1,255*A))).toString(16).padStart(2,"0")}class L{#t=0;getId(){return`${n.AnnotationEditorPrefix}${this.#t++}`}}class _{#t=[];#e=!1;#i;#s=-1;constructor(o=128){this.#i=o}add({cmd:o,undo:g,mustExec:b,type:D=NaN,overwriteIfSameType:k=!1,keepUndo:M=!1}){if(b&&o(),this.#e)return;const m={cmd:o,undo:g,type:D};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(m);return}if(k&&this.#t[this.#s].type===D){M&&(m.undo=this.#t[this.#s].undo),this.#t[this.#s]=m;return}const r=this.#s+1;r===this.#i?this.#t.splice(0,1):(this.#s=r,r<this.#t.length&&this.#t.splice(r)),this.#t.push(m)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}e.CommandManager=_;class s{constructor(o){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const g=s.platform.isMac;for(const[b,D]of o)for(const k of b){const M=k.startsWith("mac+");g&&M?(this.callbacks.set(k.slice(4),D),this.allKeys.add(k.split("+").at(-1))):!g&&!M&&(this.callbacks.set(k,D),this.allKeys.add(k.split("+").at(-1)))}}static get platform(){const o=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:o.includes("Win"),isMac:o.includes("Mac")})}#t(o){o.altKey&&this.buffer.push("alt"),o.ctrlKey&&this.buffer.push("ctrl"),o.metaKey&&this.buffer.push("meta"),o.shiftKey&&this.buffer.push("shift"),this.buffer.push(o.key);const g=this.buffer.join("+");return this.buffer.length=0,g}exec(o,g){if(!this.allKeys.has(g.key))return;const b=this.callbacks.get(this.#t(g));b&&(b.bind(o)(),g.stopPropagation(),g.preventDefault())}}e.KeyboardManager=s;class a{#t=null;copy(o){o&&(Array.isArray(o)?this.#t=o.map(g=>g.serialize()):this.#t=[o.serialize()],this.#t=this.#t.filter(g=>!!g),this.#t.length===0&&(this.#t=null))}paste(){return this.#t}isEmpty(){return this.#t===null}destroy(){this.#t=null}}class u{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const o=new Map([["CanvasText",null],["Canvas",null]]);return(0,d.getColorValues)(o),(0,n.shadow)(this,"_colors",o)}convert(o){const g=(0,d.getRGB)(o);if(!window.matchMedia("(forced-colors: active)").matches)return g;for(const[b,D]of this._colors)if(D.every((k,M)=>k===g[M]))return u._colorsMapping.get(b);return g}getHexCode(o){const g=this._colors.get(o);return g?n.Util.makeHexColor(...g):o}}e.ColorManager=u;class p{#t=null;#e=new Map;#i=new Map;#s=new a;#r=new _;#h=0;#o=null;#n=null;#u=new L;#l=!1;#c=n.AnnotationEditorType.NONE;#a=new Set;#m=this.keydown.bind(this);#p=this.onEditingAction.bind(this);#C=this.onPageChanging.bind(this);#T={isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#b=null;static _keyboardManager=new s([[["ctrl+a","mac+meta+a"],p.prototype.selectAll],[["ctrl+c","mac+meta+c"],p.prototype.copy],[["ctrl+v","mac+meta+v"],p.prototype.paste],[["ctrl+x","mac+meta+x"],p.prototype.cut],[["ctrl+z","mac+meta+z"],p.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],p.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],p.prototype.delete],[["Escape","mac+Escape"],p.prototype.unselectAll]]);constructor(o,g){this.#b=o,this.#n=g,this.#n._on("editingaction",this.#p),this.#n._on("pagechanging",this.#C)}destroy(){this.#y(),this.#n._off("editingaction",this.#p),this.#n._off("pagechanging",this.#C);for(const o of this.#i.values())o.destroy();this.#i.clear(),this.#e.clear(),this.#t=null,this.#a.clear(),this.#s.destroy(),this.#r.destroy()}onPageChanging({pageNumber:o}){this.#h=o-1}focusMainContainer(){this.#b.focus()}#x(){this.#b.addEventListener("keydown",this.#m)}#y(){this.#b.removeEventListener("keydown",this.#m)}keydown(o){this.getActive()?.shouldGetKeyboardEvents()||p._keyboardManager.exec(this,o)}onEditingAction(o){["undo","redo","cut","copy","paste","delete","selectAll"].includes(o.name)&&this[o.name]()}#d(o){Object.entries(o).some(([b,D])=>this.#T[b]!==D)&&this.#n.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#T,o)})}#A(o){this.#n.dispatch("annotationeditorparamschanged",{source:this,details:o})}setEditingState(o){o?(this.#x(),this.#d({isEditing:this.#c!==n.AnnotationEditorType.NONE,isEmpty:this.#g(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:this.#s.isEmpty()})):(this.#y(),this.#d({isEditing:!1}))}registerEditorTypes(o){this.#o=o;for(const g of this.#o)this.#A(g.defaultPropertiesToUpdate)}getId(){return this.#u.getId()}addLayer(o){this.#i.set(o.pageIndex,o),this.#l?o.enable():o.disable()}removeLayer(o){this.#i.delete(o.pageIndex)}updateMode(o){if(this.#c=o,o===n.AnnotationEditorType.NONE)this.setEditingState(!1),this.#f();else{this.setEditingState(!0),this.#P();for(const g of this.#i.values())g.updateMode(o)}}updateToolbar(o){o!==this.#c&&this.#n.dispatch("switchannotationeditormode",{source:this,mode:o})}updateParams(o,g){for(const b of this.#a)b.updateParams(o,g);for(const b of this.#o)b.updateDefaultParams(o,g)}#P(){if(!this.#l){this.#l=!0;for(const o of this.#i.values())o.enable()}}#f(){if(this.unselectAll(),this.#l){this.#l=!1;for(const o of this.#i.values())o.disable()}}getEditors(o){const g=[];for(const b of this.#e.values())b.pageIndex===o&&g.push(b);return g}getEditor(o){return this.#e.get(o)}addEditor(o){this.#e.set(o.id,o)}removeEditor(o){this.#e.delete(o.id),this.unselect(o)}#v(o){const g=this.#i.get(o.pageIndex);g?g.addOrRebuild(o):this.addEditor(o)}setActiveEditor(o){this.#t!==o&&(this.#t=o,o&&this.#A(o.propertiesToUpdate))}toggleSelected(o){if(this.#a.has(o)){this.#a.delete(o),o.unselect(),this.#d({hasSelectedEditor:this.hasSelection});return}this.#a.add(o),o.select(),this.#A(o.propertiesToUpdate),this.#d({hasSelectedEditor:!0})}setSelected(o){for(const g of this.#a)g!==o&&g.unselect();this.#a.clear(),this.#a.add(o),o.select(),this.#A(o.propertiesToUpdate),this.#d({hasSelectedEditor:!0})}isSelected(o){return this.#a.has(o)}unselect(o){o.unselect(),this.#a.delete(o),this.#d({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#a.size!==0}undo(){this.#r.undo(),this.#d({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#g()})}redo(){this.#r.redo(),this.#d({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#g()})}addCommands(o){this.#r.add(o),this.#d({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#g()})}#g(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const o of this.#e.values())return o.isEmpty();return!1}delete(){if(this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;const o=[...this.#a],g=()=>{for(const D of o)D.remove()},b=()=>{for(const D of o)this.#v(D)};this.addCommands({cmd:g,undo:b,mustExec:!0})}copy(){if(this.#t&&this.#t.commitOrRemove(),this.hasSelection){const o=[];for(const g of this.#a)g.isEmpty()||o.push(g);if(o.length===0)return;this.#s.copy(o),this.#d({hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(this.#s.isEmpty())return;this.unselectAll();const o=this.#i.get(this.#h),g=this.#s.paste().map(k=>o.deserialize(k)),b=()=>{for(const k of g)this.#v(k);this.#_(g)},D=()=>{for(const k of g)k.remove()};this.addCommands({cmd:b,undo:D,mustExec:!0})}#_(o){this.#a.clear();for(const g of o)g.isEmpty()||(this.#a.add(g),g.select());this.#d({hasSelectedEditor:!0})}selectAll(){for(const o of this.#a)o.commit();this.#_(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.#_.size!==0){for(const o of this.#a)o.unselect();this.#a.clear(),this.#d({hasSelectedEditor:!1})}}isActive(o){return this.#t===o}getActive(){return this.#t}getMode(){return this.#c}}e.AnnotationEditorUIManager=p},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=l,e.getColorValues=N,e.getCurrentTransform=tt,e.getCurrentTransformInverse=Z,e.getFilenameFromUrl=D,e.getPdfFilenameFromUrl=k,e.getRGB=j,e.getXfaPageViewport=P,e.isDataScheme=g,e.isPdfFile=b,e.isValidFetchUrl=m,e.loadScript=r;var n=E(9),d=E(1);const O="http://www.w3.org/2000/svg",R="pdfjs_internal_id_";e.AnnotationPrefix=R;class L{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}e.PixelsPerInch=L;class _ extends n.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,q){const Y=this._document.createElement("canvas");return Y.width=U,Y.height=q,Y}}e.DOMCanvasFactory=_;async function s(B,U=!1){if(m(B,document.baseURI)){const q=await fetch(B);if(!q.ok)throw new Error(q.statusText);return U?new Uint8Array(await q.arrayBuffer()):(0,d.stringToBytes)(await q.text())}return new Promise((q,Y)=>{const z=new XMLHttpRequest;z.open("GET",B,!0),U&&(z.responseType="arraybuffer"),z.onreadystatechange=()=>{if(z.readyState===XMLHttpRequest.DONE){if(z.status===200||z.status===0){let x;if(U&&z.response?x=new Uint8Array(z.response):!U&&z.responseText&&(x=(0,d.stringToBytes)(z.responseText)),x){q(x);return}}Y(new Error(z.statusText))}},z.send(null)})}class a extends n.BaseCMapReaderFactory{_fetchData(U,q){return s(U,this.isCompressed).then(Y=>({cMapData:Y,compressionType:q}))}}e.DOMCMapReaderFactory=a;class u extends n.BaseStandardFontDataFactory{_fetchData(U){return s(U,!0)}}e.DOMStandardFontDataFactory=u;class p extends n.BaseSVGFactory{_createSVG(U){return document.createElementNS(O,U)}}e.DOMSVGFactory=p;class A{constructor({viewBox:U,scale:q,rotation:Y,offsetX:z=0,offsetY:x=0,dontFlip:h=!1}){this.viewBox=U,this.scale=q,this.rotation=Y,this.offsetX=z,this.offsetY=x;const c=(U[2]+U[0])/2,S=(U[3]+U[1])/2;let T,t,i,f;switch(Y%=360,Y<0&&(Y+=360),Y){case 180:T=-1,t=0,i=0,f=1;break;case 90:T=0,t=1,i=1,f=0;break;case 270:T=0,t=-1,i=-1,f=0;break;case 0:T=1,t=0,i=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}h&&(i=-i,f=-f);let v,C,F,I;T===0?(v=Math.abs(S-U[1])*q+z,C=Math.abs(c-U[0])*q+x,F=Math.abs(U[3]-U[1])*q,I=Math.abs(U[2]-U[0])*q):(v=Math.abs(c-U[0])*q+z,C=Math.abs(S-U[1])*q+x,F=Math.abs(U[2]-U[0])*q,I=Math.abs(U[3]-U[1])*q),this.transform=[T*q,t*q,i*q,f*q,v-T*q*c-i*q*S,C-t*q*c-f*q*S],this.width=F,this.height=I}clone({scale:U=this.scale,rotation:q=this.rotation,offsetX:Y=this.offsetX,offsetY:z=this.offsetY,dontFlip:x=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:U,rotation:q,offsetX:Y,offsetY:z,dontFlip:x})}convertToViewportPoint(U,q){return d.Util.applyTransform([U,q],this.transform)}convertToViewportRectangle(U){const q=d.Util.applyTransform([U[0],U[1]],this.transform),Y=d.Util.applyTransform([U[2],U[3]],this.transform);return[q[0],q[1],Y[0],Y[1]]}convertToPdfPoint(U,q){return d.Util.applyInverseTransform([U,q],this.transform)}}e.PageViewport=A;class o extends d.BaseException{constructor(U,q){super(U,"RenderingCancelledException"),this.type=q}}e.RenderingCancelledException=o;function g(B){const U=B.length;let q=0;for(;q<U&&B[q].trim()==="";)q++;return B.substring(q,q+5).toLowerCase()==="data:"}function b(B){return typeof B=="string"&&/\.pdf$/i.test(B)}function D(B){const U=B.indexOf("#"),q=B.indexOf("?"),Y=Math.min(U>0?U:B.length,q>0?q:B.length);return B.substring(B.lastIndexOf("/",Y)+1,Y)}function k(B,U="document.pdf"){if(typeof B!="string")return U;if(g(B))return(0,d.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;const q=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Y=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,z=q.exec(B);let x=Y.exec(z[1])||Y.exec(z[2])||Y.exec(z[3]);if(x&&(x=x[0],x.includes("%")))try{x=Y.exec(decodeURIComponent(x))[0]}catch{}return x||U}class M{constructor(){this.started=Object.create(null),this.times=[]}time(U){U in this.started&&(0,d.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,d.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){const U=[];let q=0;for(const Y of this.times){const z=Y.name;z.length>q&&(q=z.length)}for(const Y of this.times){const z=Y.end-Y.start;U.push(`${Y.name.padEnd(q)} ${z}ms
`)}return U.join("")}}e.StatTimer=M;function m(B,U){try{const{protocol:q}=U?new URL(B,U):new URL(B);return q==="http:"||q==="https:"}catch{return!1}}function r(B,U=!1){return new Promise((q,Y)=>{const z=document.createElement("script");z.src=B,z.onload=function(x){U&&z.remove(),q(x)},z.onerror=function(){Y(new Error(`Cannot load script at: ${z.src}`))},(document.head||document.documentElement).append(z)})}function l(B){console.log("Deprecated API usage: "+B)}let y;class w{static toDateObject(U){if(!U||typeof U!="string")return null;y||(y=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const q=y.exec(U);if(!q)return null;const Y=parseInt(q[1],10);let z=parseInt(q[2],10);z=z>=1&&z<=12?z-1:0;let x=parseInt(q[3],10);x=x>=1&&x<=31?x:1;let h=parseInt(q[4],10);h=h>=0&&h<=23?h:0;let c=parseInt(q[5],10);c=c>=0&&c<=59?c:0;let S=parseInt(q[6],10);S=S>=0&&S<=59?S:0;const T=q[7]||"Z";let t=parseInt(q[8],10);t=t>=0&&t<=23?t:0;let i=parseInt(q[9],10)||0;return i=i>=0&&i<=59?i:0,T==="-"?(h+=t,c+=i):T==="+"&&(h-=t,c-=i),new Date(Date.UTC(Y,z,x,h,c,S))}}e.PDFDateString=w;function P(B,{scale:U=1,rotation:q=0}){const{width:Y,height:z}=B.attributes.style,x=[0,0,parseInt(Y),parseInt(z)];return new A({viewBox:x,scale:U,rotation:q})}function j(B){if(B.startsWith("#")){const U=parseInt(B.slice(1),16);return[(U&16711680)>>16,(U&65280)>>8,U&255]}return B.startsWith("rgb(")?B.slice(4,-1).split(",").map(U=>parseInt(U)):B.startsWith("rgba(")?B.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,d.warn)(`Not a valid color format: "${B}"`),[0,0,0])}function N(B){const U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(const q of B.keys()){U.style.color=q;const Y=window.getComputedStyle(U).color;B.set(q,j(Y))}U.remove()}function tt(B){const{a:U,b:q,c:Y,d:z,e:x,f:h}=B.getTransform();return[U,q,Y,z,x,h]}function Z(B){const{a:U,b:q,c:Y,d:z,e:x,f:h}=B.getTransform().invertSelf();return[U,q,Y,z,x,h]}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=E(1);class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(s,a){if(s<=0||a<=0)throw new Error("Invalid canvas size");const u=this._createCanvas(s,a);return{canvas:u,context:u.getContext("2d")}}reset(s,a,u){if(!s.canvas)throw new Error("Canvas is not specified");if(a<=0||u<=0)throw new Error("Invalid canvas size");s.canvas.width=a,s.canvas.height=u}destroy(s){if(!s.canvas)throw new Error("Canvas is not specified");s.canvas.width=0,s.canvas.height=0,s.canvas=null,s.context=null}_createCanvas(s,a){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=d;class O{constructor({baseUrl:s=null,isCompressed:a=!1}){this.constructor===O&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=s,this.isCompressed=a}async fetch({name:s}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!s)throw new Error("CMap name must be specified.");const a=this.baseUrl+s+(this.isCompressed?".bcmap":""),u=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(a,u).catch(p=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${a}`)})}_fetchData(s,a){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=O;class R{constructor({baseUrl:s=null}){this.constructor===R&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=s}async fetch({filename:s}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!s)throw new Error("Font filename must be specified.");const a=`${this.baseUrl}${s}`;return this._fetchData(a).catch(u=>{throw new Error(`Unable to load font data at: ${a}`)})}_fetchData(s){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=R;class L{constructor(){this.constructor===L&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(s,a,u=!1){if(s<=0||a<=0)throw new Error("Invalid SVG dimensions");const p=this._createSVG("svg:svg");return p.setAttribute("version","1.1"),u||(p.setAttribute("width",`${s}px`),p.setAttribute("height",`${a}px`)),p.setAttribute("preserveAspectRatio","none"),p.setAttribute("viewBox",`0 0 ${s} ${a}`),p}createElement(s){if(typeof s!="string")throw new Error("Invalid SVG element type");return this._createSVG(s)}_createSVG(s){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=E(1);const d=3285377520,O=4294901760,R=65535;class L{constructor(s){this.h1=s?s&4294967295:d,this.h2=s?s&4294967295:d}update(s){let a,u;if(typeof s=="string"){a=new Uint8Array(s.length*2),u=0;for(let y=0,w=s.length;y<w;y++){const P=s.charCodeAt(y);P<=255?a[u++]=P:(a[u++]=P>>>8,a[u++]=P&255)}}else if((0,n.isArrayBuffer)(s))a=s.slice(),u=a.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const p=u>>2,A=u-p*4,o=new Uint32Array(a.buffer,0,p);let g=0,b=0,D=this.h1,k=this.h2;const M=3432918353,m=461845907,r=M&R,l=m&R;for(let y=0;y<p;y++)y&1?(g=o[y],g=g*M&O|g*r&R,g=g<<15|g>>>17,g=g*m&O|g*l&R,D^=g,D=D<<13|D>>>19,D=D*5+3864292196):(b=o[y],b=b*M&O|b*r&R,b=b<<15|b>>>17,b=b*m&O|b*l&R,k^=b,k=k<<13|k>>>19,k=k*5+3864292196);switch(g=0,A){case 3:g^=a[p*4+2]<<16;case 2:g^=a[p*4+1]<<8;case 1:g^=a[p*4],g=g*M&O|g*r&R,g=g<<15|g>>>17,g=g*m&O|g*l&R,p&1?D^=g:k^=g}this.h1=D,this.h2=k}hexdigest(){let s=this.h1,a=this.h2;s^=a>>>1,s=s*3981806797&O|s*36045&R,a=a*4283543511&O|((a<<16|s>>>16)*2950163797&O)>>>16,s^=a>>>1,s=s*444984403&O|s*60499&R,a=a*3301882366&O|((a<<16|s>>>16)*3120437893&O)>>>16,s^=a>>>1;const u=(s>>>0).toString(16),p=(a>>>0).toString(16);return u.padStart(8,"0")+p.padStart(8,"0")}}e.MurmurHash3_64=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=E(1);class d{constructor({docId:_,onUnsupportedFeature:s,ownerDocument:a=globalThis.document,styleElement:u=null}){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseFontLoader."),this.docId=_,this._onUnsupportedFeature=s,this._document=a,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(_){this.nativeFontFaces.push(_),this._document.fonts.add(_)}insertRule(_){let s=this.styleElement;s||(s=this.styleElement=this._document.createElement("style"),s.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(s));const a=s.sheet;a.insertRule(_,a.cssRules.length)}clear(){for(const _ of this.nativeFontFaces)this._document.fonts.delete(_);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(_){if(_.attached||_.missingFile)return;if(_.attached=!0,this.isFontLoadingAPISupported){const a=_.createNativeFontFace();if(a){this.addNativeFontFace(a);try{await a.loaded}catch(u){throw this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,n.warn)(`Failed to load font '${a.family}': '${u}'.`),_.disableFontFace=!0,u}}return}const s=_.createFontFaceRule();if(s){if(this.insertRule(s),this.isSyncFontLoadingSupported)return;await new Promise(a=>{const u=this._queueLoadingCallback(a);this._prepareFontLoadEvent([s],[_],u)})}}_queueLoadingCallback(_){(0,n.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){const _=!!this._document?.fonts;return(0,n.shadow)(this,"isFontLoadingAPISupported",_)}get isSyncFontLoadingSupported(){(0,n.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,n.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(_,s,a){(0,n.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let O;e.FontLoader=O,e.FontLoader=O=class extends d{constructor(_){super(_),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let _=!1;return(typeof navigator>"u"||/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent)?.[1]>=14)&&(_=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",_)}_queueLoadingCallback(_){function s(){for((0,n.assert)(!u.done,"completeRequest() cannot be called twice."),u.done=!0;a.requests.length>0&&a.requests[0].done;){const p=a.requests.shift();setTimeout(p.callback,0)}}const a=this.loadingContext,u={id:`pdfjs-font-loading-${a.nextRequestId++}`,done:!1,complete:s,callback:_};return a.requests.push(u),u}get _loadTestFont(){const _=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,n.shadow)(this,"_loadTestFont",_())}_prepareFontLoadEvent(_,s,a){function u(Z,B){return Z.charCodeAt(B)<<24|Z.charCodeAt(B+1)<<16|Z.charCodeAt(B+2)<<8|Z.charCodeAt(B+3)&255}function p(Z,B,U,q){const Y=Z.substring(0,B),z=Z.substring(B+U);return Y+q+z}let A,o;const g=this._document.createElement("canvas");g.width=1,g.height=1;const b=g.getContext("2d");let D=0;function k(Z,B){if(D++,D>30){(0,n.warn)("Load test font never loaded."),B();return}if(b.font="30px "+Z,b.fillText(".",0,20),b.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(k.bind(null,Z,B))}const M=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=p(m,976,M.length,M);const l=16,y=1482184792;let w=u(m,l);for(A=0,o=M.length-3;A<o;A+=4)w=w-y+u(M,A)|0;A<M.length&&(w=w-y+u(M+"XXX",A)|0),m=p(m,l,4,(0,n.string32)(w));const P=`url(data:font/opentype;base64,${btoa(m)});`,j=`@font-face {font-family:"${M}";src:${P}}`;this.insertRule(j);const N=[];for(const Z of s)N.push(Z.loadedName);N.push(M);const tt=this._document.createElement("div");tt.style.visibility="hidden",tt.style.width=tt.style.height="10px",tt.style.position="absolute",tt.style.top=tt.style.left="0px";for(const Z of N){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=Z,tt.append(B)}this._document.body.append(tt),k(M,()=>{tt.remove(),a.complete()})}};class R{constructor(_,{isEvalSupported:s=!0,disableFontFace:a=!1,ignoreErrors:u=!1,onUnsupportedFeature:p,fontRegistry:A=null}){this.compiledGlyphs=Object.create(null);for(const o in _)this[o]=_[o];this.isEvalSupported=s!==!1,this.disableFontFace=a===!0,this.ignoreErrors=u===!0,this._onUnsupportedFeature=p,this.fontRegistry=A}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let _;if(!this.cssFontInfo)_=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),_=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return this.fontRegistry&&this.fontRegistry.registerFont(this),_}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const _=(0,n.bytesToString)(this.data),s=`url(data:${this.mimetype};base64,${btoa(_)});`;let a;if(!this.cssFontInfo)a=`@font-face {font-family:"${this.loadedName}";src:${s}}`;else{let u=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(u+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),a=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${u}src:${s}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,s),a}getPathGenerator(_,s){if(this.compiledGlyphs[s]!==void 0)return this.compiledGlyphs[s];let a;try{a=_.get(this.loadedName+"_path_"+s)}catch(u){if(!this.ignoreErrors)throw u;return this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,n.warn)(`getPathGenerator - ignoring character: "${u}".`),this.compiledGlyphs[s]=function(p,A){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const u=[];for(const p of a){const A=p.args!==void 0?p.args.join(","):"";u.push("c.",p.cmd,"(",A,`);
`)}return this.compiledGlyphs[s]=new Function("c","size",u.join(""))}return this.compiledGlyphs[s]=function(u,p){for(const A of a)A.cmd==="scale"&&(A.args=[p,-p]),u[A.cmd].apply(u,A.args)}}}e.FontFaceObject=R},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=E(8),d=E(1),O=E(13),R=E(14),L=E(3);const _=16,s=100,a=4096,u=15,p=10,A=L.isNodeJS&&typeof Path2D>"u"?-1:1e3,o=16;function g(x,h){if(x._removeMirroring)throw new Error("Context is already forwarding operations.");x.__originalSave=x.save,x.__originalRestore=x.restore,x.__originalRotate=x.rotate,x.__originalScale=x.scale,x.__originalTranslate=x.translate,x.__originalTransform=x.transform,x.__originalSetTransform=x.setTransform,x.__originalResetTransform=x.resetTransform,x.__originalClip=x.clip,x.__originalMoveTo=x.moveTo,x.__originalLineTo=x.lineTo,x.__originalBezierCurveTo=x.bezierCurveTo,x.__originalRect=x.rect,x.__originalClosePath=x.closePath,x.__originalBeginPath=x.beginPath,x._removeMirroring=()=>{x.save=x.__originalSave,x.restore=x.__originalRestore,x.rotate=x.__originalRotate,x.scale=x.__originalScale,x.translate=x.__originalTranslate,x.transform=x.__originalTransform,x.setTransform=x.__originalSetTransform,x.resetTransform=x.__originalResetTransform,x.clip=x.__originalClip,x.moveTo=x.__originalMoveTo,x.lineTo=x.__originalLineTo,x.bezierCurveTo=x.__originalBezierCurveTo,x.rect=x.__originalRect,x.closePath=x.__originalClosePath,x.beginPath=x.__originalBeginPath,delete x._removeMirroring},x.save=function(){h.save(),this.__originalSave()},x.restore=function(){h.restore(),this.__originalRestore()},x.translate=function(S,T){h.translate(S,T),this.__originalTranslate(S,T)},x.scale=function(S,T){h.scale(S,T),this.__originalScale(S,T)},x.transform=function(S,T,t,i,f,v){h.transform(S,T,t,i,f,v),this.__originalTransform(S,T,t,i,f,v)},x.setTransform=function(S,T,t,i,f,v){h.setTransform(S,T,t,i,f,v),this.__originalSetTransform(S,T,t,i,f,v)},x.resetTransform=function(){h.resetTransform(),this.__originalResetTransform()},x.rotate=function(S){h.rotate(S),this.__originalRotate(S)},x.clip=function(S){h.clip(S),this.__originalClip(S)},x.moveTo=function(c,S){h.moveTo(c,S),this.__originalMoveTo(c,S)},x.lineTo=function(c,S){h.lineTo(c,S),this.__originalLineTo(c,S)},x.bezierCurveTo=function(c,S,T,t,i,f){h.bezierCurveTo(c,S,T,t,i,f),this.__originalBezierCurveTo(c,S,T,t,i,f)},x.rect=function(c,S,T,t){h.rect(c,S,T,t),this.__originalRect(c,S,T,t)},x.closePath=function(){h.closePath(),this.__originalClosePath()},x.beginPath=function(){h.beginPath(),this.__originalBeginPath()}}class b{constructor(h){this.canvasFactory=h,this.cache=Object.create(null)}getCanvas(h,c,S){let T;return this.cache[h]!==void 0?(T=this.cache[h],this.canvasFactory.reset(T,c,S)):(T=this.canvasFactory.create(c,S),this.cache[h]=T),T}delete(h){delete this.cache[h]}clear(){for(const h in this.cache){const c=this.cache[h];this.canvasFactory.destroy(c),delete this.cache[h]}}}function D(x,h,c,S,T,t,i,f,v,C){const[F,I,W,V,H,K]=(0,n.getCurrentTransform)(x);if(I===0&&W===0){const nt=i*F+H,it=Math.round(nt),at=f*V+K,ot=Math.round(at),st=(i+v)*F+H,ft=Math.abs(Math.round(st)-it)||1,mt=(f+C)*V+K,lt=Math.abs(Math.round(mt)-ot)||1;return x.setTransform(Math.sign(F),0,0,Math.sign(V),it,ot),x.drawImage(h,c,S,T,t,0,0,ft,lt),x.setTransform(F,I,W,V,H,K),[ft,lt]}if(F===0&&V===0){const nt=f*W+H,it=Math.round(nt),at=i*I+K,ot=Math.round(at),st=(f+C)*W+H,ft=Math.abs(Math.round(st)-it)||1,mt=(i+v)*I+K,lt=Math.abs(Math.round(mt)-ot)||1;return x.setTransform(0,Math.sign(I),Math.sign(W),0,it,ot),x.drawImage(h,c,S,T,t,0,0,lt,ft),x.setTransform(F,I,W,V,H,K),[lt,ft]}x.drawImage(h,c,S,T,t,i,f,v,C);const et=Math.hypot(F,I),J=Math.hypot(W,V);return[et*v,J*C]}function k(x){const{width:h,height:c}=x;if(h>A||c>A)return null;const S=1e3,T=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),t=h+1;let i=new Uint8Array(t*(c+1)),f,v,C;const F=h+7&-8;let I=new Uint8Array(F*c),W=0;for(const J of x.data){let nt=128;for(;nt>0;)I[W++]=J&nt?0:255,nt>>=1}let V=0;for(W=0,I[W]!==0&&(i[0]=1,++V),v=1;v<h;v++)I[W]!==I[W+1]&&(i[v]=I[W]?2:1,++V),W++;for(I[W]!==0&&(i[v]=2,++V),f=1;f<c;f++){W=f*F,C=f*t,I[W-F]!==I[W]&&(i[C]=I[W]?1:8,++V);let J=(I[W]?4:0)+(I[W-F]?8:0);for(v=1;v<h;v++)J=(J>>2)+(I[W+1]?4:0)+(I[W-F+1]?8:0),T[J]&&(i[C+v]=T[J],++V),W++;if(I[W-F]!==I[W]&&(i[C+v]=I[W]?2:4,++V),V>S)return null}for(W=F*(c-1),C=f*t,I[W]!==0&&(i[C]=8,++V),v=1;v<h;v++)I[W]!==I[W+1]&&(i[C+v]=I[W]?4:8,++V),W++;if(I[W]!==0&&(i[C+v]=4,++V),V>S)return null;const H=new Int32Array([0,t,-1,0,-t,0,0,0,1]),K=new Path2D;for(f=0;V&&f<=c;f++){let J=f*t;const nt=J+h;for(;J<nt&&!i[J];)J++;if(J===nt)continue;K.moveTo(J%t,f);const it=J;let at=i[J];do{const ot=H[at];do J+=ot;while(!i[J]);const st=i[J];st!==5&&st!==10?(at=st,i[J]=0):(at=st&51*at>>4,i[J]&=at>>2|at<<2),K.lineTo(J%t,J/t|0),i[J]||--V}while(it!==J);--f}return I=null,i=null,function(J){J.save(),J.scale(1/h,-1/c),J.translate(0,-c),J.fill(K),J.beginPath(),J.restore()}}class M{constructor(h,c){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=d.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=d.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,h,c])}clone(){const h=Object.create(this);return h.clipBox=this.clipBox.slice(),h}setCurrentPoint(h,c){this.x=h,this.y=c}updatePathMinMax(h,c,S){[c,S]=d.Util.applyTransform([c,S],h),this.minX=Math.min(this.minX,c),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,c),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(h,c){const S=d.Util.applyTransform(c,h),T=d.Util.applyTransform(c.slice(2),h);this.minX=Math.min(this.minX,S[0],T[0]),this.minY=Math.min(this.minY,S[1],T[1]),this.maxX=Math.max(this.maxX,S[0],T[0]),this.maxY=Math.max(this.maxY,S[1],T[1])}updateScalingPathMinMax(h,c){d.Util.scaleMinMax(h,c),this.minX=Math.min(this.minX,c[0]),this.maxX=Math.max(this.maxX,c[1]),this.minY=Math.min(this.minY,c[2]),this.maxY=Math.max(this.maxY,c[3])}updateCurvePathMinMax(h,c,S,T,t,i,f,v,C,F){const I=d.Util.bezierBoundingBox(c,S,T,t,i,f,v,C);if(F){F[0]=Math.min(F[0],I[0],I[2]),F[1]=Math.max(F[1],I[0],I[2]),F[2]=Math.min(F[2],I[1],I[3]),F[3]=Math.max(F[3],I[1],I[3]);return}this.updateRectMinMax(h,I)}getPathBoundingBox(h=O.PathType.FILL,c=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(h===O.PathType.STROKE){c||(0,d.unreachable)("Stroke bounding box must include transform.");const T=d.Util.singularValueDecompose2dScale(c),t=T[0]*this.lineWidth/2,i=T[1]*this.lineWidth/2;S[0]-=t,S[1]-=i,S[2]+=t,S[3]+=i}return S}updateClipFromPath(){const h=d.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(h||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(h){this.clipBox=h,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(h=O.PathType.FILL,c=null){return d.Util.intersect(this.clipBox,this.getPathBoundingBox(h,c))}}function m(x,h,c=null){if(typeof ImageData<"u"&&h instanceof ImageData){x.putImageData(h,0,0);return}const S=h.height,T=h.width,t=S%o,i=(S-t)/o,f=t===0?i:i+1,v=x.createImageData(T,o);let C=0,F;const I=h.data,W=v.data;let V,H,K,et,J,nt,it,at;if(c)switch(c.length){case 1:J=c[0],nt=c[0],it=c[0],at=c[0];break;case 4:J=c[0],nt=c[1],it=c[2],at=c[3];break}if(h.kind===d.ImageKind.GRAYSCALE_1BPP){const ot=I.byteLength,st=new Uint32Array(W.buffer,0,W.byteLength>>2),ft=st.length,mt=T+7>>3;let lt=4294967295,ut=d.FeatureTest.isLittleEndian?4278190080:255;for(at&&at[0]===255&&at[255]===0&&([lt,ut]=[ut,lt]),V=0;V<f;V++){for(K=V<i?o:t,F=0,H=0;H<K;H++){const gt=ot-C;let St=0;const At=gt>mt?T:gt*8-7,Tt=At&-8;let _t=0,pt=0;for(;St<Tt;St+=8)pt=I[C++],st[F++]=pt&128?lt:ut,st[F++]=pt&64?lt:ut,st[F++]=pt&32?lt:ut,st[F++]=pt&16?lt:ut,st[F++]=pt&8?lt:ut,st[F++]=pt&4?lt:ut,st[F++]=pt&2?lt:ut,st[F++]=pt&1?lt:ut;for(;St<At;St++)_t===0&&(pt=I[C++],_t=128),st[F++]=pt&_t?lt:ut,_t>>=1}for(;F<ft;)st[F++]=0;x.putImageData(v,0,V*o)}}else if(h.kind===d.ImageKind.RGBA_32BPP){const ot=!!(J||nt||it);for(H=0,et=T*o*4,V=0;V<i;V++){if(W.set(I.subarray(C,C+et)),C+=et,ot)for(let st=0;st<et;st+=4)J&&(W[st+0]=J[W[st+0]]),nt&&(W[st+1]=nt[W[st+1]]),it&&(W[st+2]=it[W[st+2]]);x.putImageData(v,0,H),H+=o}if(V<f){if(et=T*t*4,W.set(I.subarray(C,C+et)),ot)for(let st=0;st<et;st+=4)J&&(W[st+0]=J[W[st+0]]),nt&&(W[st+1]=nt[W[st+1]]),it&&(W[st+2]=it[W[st+2]]);x.putImageData(v,0,H)}}else if(h.kind===d.ImageKind.RGB_24BPP){const ot=!!(J||nt||it);for(K=o,et=T*K,V=0;V<f;V++){for(V>=i&&(K=t,et=T*K),F=0,H=et;H--;)W[F++]=I[C++],W[F++]=I[C++],W[F++]=I[C++],W[F++]=255;if(ot)for(let st=0;st<F;st+=4)J&&(W[st+0]=J[W[st+0]]),nt&&(W[st+1]=nt[W[st+1]]),it&&(W[st+2]=it[W[st+2]]);x.putImageData(v,0,V*o)}}else throw new Error(`bad image kind: ${h.kind}`)}function r(x,h){if(h.bitmap){x.drawImage(h.bitmap,0,0);return}const c=h.height,S=h.width,T=c%o,t=(c-T)/o,i=T===0?t:t+1,f=x.createImageData(S,o);let v=0;const C=h.data,F=f.data;for(let I=0;I<i;I++){const W=I<t?o:T;({srcPos:v}=(0,R.applyMaskImageData)({src:C,srcPos:v,dest:F,width:S,height:W})),x.putImageData(f,0,I*o)}}function l(x,h){const c=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let S=0,T=c.length;S<T;S++){const t=c[S];x[t]!==void 0&&(h[t]=x[t])}x.setLineDash!==void 0&&(h.setLineDash(x.getLineDash()),h.lineDashOffset=x.lineDashOffset)}function y(x,h){x.strokeStyle=x.fillStyle=h||"#000000",x.fillRule="nonzero",x.globalAlpha=1,x.lineWidth=1,x.lineCap="butt",x.lineJoin="miter",x.miterLimit=10,x.globalCompositeOperation="source-over",x.font="10px sans-serif",x.setLineDash!==void 0&&(x.setLineDash([]),x.lineDashOffset=0)}function w(x,h,c,S){const T=x.length;for(let t=3;t<T;t+=4){const i=x[t];if(i===0)x[t-3]=h,x[t-2]=c,x[t-1]=S;else if(i<255){const f=255-i;x[t-3]=x[t-3]*i+h*f>>8,x[t-2]=x[t-2]*i+c*f>>8,x[t-1]=x[t-1]*i+S*f>>8}}}function P(x,h,c){const S=x.length,T=1/255;for(let t=3;t<S;t+=4){const i=c?c[x[t]]:x[t];h[t]=h[t]*i*T|0}}function j(x,h,c){const S=x.length;for(let T=3;T<S;T+=4){const t=x[T-3]*77+x[T-2]*152+x[T-1]*28;h[T]=c?h[T]*c[t>>8]>>8:h[T]*t>>16}}function N(x,h,c,S,T,t,i,f,v,C,F){const I=!!t,W=I?t[0]:0,V=I?t[1]:0,H=I?t[2]:0;let K;T==="Luminosity"?K=j:K=P;const J=Math.min(S,Math.ceil(1048576/c));for(let nt=0;nt<S;nt+=J){const it=Math.min(J,S-nt),at=x.getImageData(f-C,nt+(v-F),c,it),ot=h.getImageData(f,nt+v,c,it);I&&w(at.data,W,V,H),K(at.data,ot.data,i),h.putImageData(ot,f,nt+v)}}function tt(x,h,c,S){const T=S[0],t=S[1],i=S[2]-T,f=S[3]-t;i===0||f===0||(N(h.context,c,i,f,h.subtype,h.backdrop,h.transferMap,T,t,h.offsetX,h.offsetY),x.save(),x.globalAlpha=1,x.globalCompositeOperation="source-over",x.setTransform(1,0,0,1,0,0),x.drawImage(c.canvas,0,0),x.restore())}function Z(x,h){const c=d.Util.singularValueDecompose2dScale(x);c[0]=Math.fround(c[0]),c[1]=Math.fround(c[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*n.PixelsPerInch.PDF_TO_CSS_UNITS);return h!==void 0?h:c[0]<=S||c[1]<=S}const B=["butt","round","square"],U=["miter","round","bevel"],q={},Y={};class z{constructor(h,c,S,T,t,i,f,v){this.ctx=h,this.current=new M(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=c,this.objs=S,this.canvasFactory=T,this.imageLayer=t,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=i,this.cachedCanvases=new b(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=v?.background||null,this.foregroundColor=v?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(h,c=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):c}beginDrawing({transform:h,viewport:c,transparency:S=!1,background:T=null}){const t=this.ctx.canvas.width,i=this.ctx.canvas.height,f=T||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const v=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const C=this.backgroundColor=this.ctx.fillStyle;let F=!0,I=f;if(this.ctx.fillStyle=f,I=this.ctx.fillStyle,F=typeof I=="string"&&/^#[0-9A-Fa-f]{6}$/.test(I),v==="#000000"&&C==="#ffffff"||v===C||!F)this.foregroundColor=this.backgroundColor=null;else{const[W,V,H]=(0,n.getRGB)(I),K=J=>(J/=255,J<=.03928?J/12.92:((J+.055)/1.055)**2.4),et=Math.round(.2126*K(W)+.7152*K(V)+.0722*K(H));this.selectColor=(J,nt,it)=>{const at=.2126*K(J)+.7152*K(nt)+.0722*K(it);return Math.round(at)===et?C:v}}}if(this.ctx.fillStyle=this.backgroundColor||f,this.ctx.fillRect(0,0,t,i),this.ctx.restore(),S){const v=this.cachedCanvases.getCanvas("transparent",t,i);this.compositeCtx=this.ctx,this.transparentCanvas=v.canvas,this.ctx=v.context,this.ctx.save(),this.ctx.transform(...(0,n.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),y(this.ctx,this.foregroundColor),h&&(this.ctx.transform(...h),this.outputScaleX=h[0],this.outputScaleY=h[0]),this.ctx.transform(...c.transform),this.viewportScale=c.scale,this.baseTransform=(0,n.getCurrentTransform)(this.ctx),this.imageLayer&&((0,n.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(h,c,S,T){const t=h.argsArray,i=h.fnArray;let f=c||0;const v=t.length;if(v===f)return f;const C=v-f>p&&typeof S=="function",F=C?Date.now()+u:0;let I=0;const W=this.commonObjs,V=this.objs;let H;for(;;){if(T!==void 0&&f===T.nextBreakPoint)return T.breakIt(f,S),f;if(H=i[f],H!==d.OPS.dependency)this[H].apply(this,t[f]);else for(const K of t[f]){const et=K.startsWith("g_")?W:V;if(!et.has(K))return et.get(K,S),f}if(f++,f===v)return f;if(C&&++I>p){if(Date.now()>F)return S(),f;I=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const h of this._cachedBitmapsMap.values()){for(const c of h.values())typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement&&(c.width=c.height=0);h.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(h,c){const S=h.width,T=h.height;let t=Math.max(Math.hypot(c[0],c[1]),1),i=Math.max(Math.hypot(c[2],c[3]),1),f=S,v=T,C="prescale1",F,I;for(;t>2&&f>1||i>2&&v>1;){let W=f,V=v;t>2&&f>1&&(W=Math.ceil(f/2),t/=f/W),i>2&&v>1&&(V=Math.ceil(v/2),i/=v/V),F=this.cachedCanvases.getCanvas(C,W,V),I=F.context,I.clearRect(0,0,W,V),I.drawImage(h,0,0,f,v,0,0,W,V),h=F.canvas,f=W,v=V,C=C==="prescale1"?"prescale2":"prescale1"}return{img:h,paintWidth:f,paintHeight:v}}_createMaskCanvas(h){const c=this.ctx,{width:S,height:T}=h,t=this.current.fillColor,i=this.current.patternFill,f=(0,n.getCurrentTransform)(c);let v,C,F,I;if((h.bitmap||h.data)&&h.count>1){const ft=h.bitmap||h.data.buffer,mt=f.slice(0,4);C=JSON.stringify(i?mt:[mt,t]),v=this._cachedBitmapsMap.get(ft),v||(v=new Map,this._cachedBitmapsMap.set(ft,v));const lt=v.get(C);if(lt&&!i){const ut=Math.round(Math.min(f[0],f[2])+f[4]),gt=Math.round(Math.min(f[1],f[3])+f[5]);return{canvas:lt,offsetX:ut,offsetY:gt}}F=lt}F||(I=this.cachedCanvases.getCanvas("maskCanvas",S,T),r(I.context,h));let W=d.Util.transform(f,[1/S,0,0,-1/T,0,0]);W=d.Util.transform(W,[1,0,0,1,0,-T]);const V=d.Util.applyTransform([0,0],W),H=d.Util.applyTransform([S,T],W),K=d.Util.normalizeRect([V[0],V[1],H[0],H[1]]),et=Math.round(K[2]-K[0])||1,J=Math.round(K[3]-K[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",et,J),it=nt.context,at=Math.min(V[0],H[0]),ot=Math.min(V[1],H[1]);it.translate(-at,-ot),it.transform(...W),F||(F=this._scaleImage(I.canvas,(0,n.getCurrentTransformInverse)(it)),F=F.img,v&&i&&v.set(C,F)),it.imageSmoothingEnabled=Z((0,n.getCurrentTransform)(it),h.interpolate),D(it,F,0,0,F.width,F.height,0,0,S,T),it.globalCompositeOperation="source-in";const st=d.Util.transform((0,n.getCurrentTransformInverse)(it),[1,0,0,1,-at,-ot]);return it.fillStyle=i?t.getPattern(c,this,st,O.PathType.FILL):t,it.fillRect(0,0,S,T),v&&!i&&(this.cachedCanvases.delete("fillCanvas"),v.set(C,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(at),offsetY:Math.round(ot)}}setLineWidth(h){h!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=h,this.ctx.lineWidth=h}setLineCap(h){this.ctx.lineCap=B[h]}setLineJoin(h){this.ctx.lineJoin=U[h]}setMiterLimit(h){this.ctx.miterLimit=h}setDash(h,c){const S=this.ctx;S.setLineDash!==void 0&&(S.setLineDash(h),S.lineDashOffset=c)}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(let c=0,S=h.length;c<S;c++){const T=h[c],t=T[0],i=T[1];switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=T[1];break;case"ca":this.current.fillAlpha=T[1],this.ctx.globalAlpha=T[1];break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=i}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const h=this.inSMaskMode;this.current.activeSMask&&!h?this.beginSMaskMode():!this.current.activeSMask&&h&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const h=this.ctx.canvas.width,c=this.ctx.canvas.height,S="smaskGroupAt"+this.groupLevel,T=this.cachedCanvases.getCanvas(S,h,c);this.suspendedCtx=this.ctx,this.ctx=T.context;const t=this.ctx;t.setTransform(...(0,n.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,t),g(t,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(h){if(!this.current.activeSMask)return;h?(h[0]=Math.floor(h[0]),h[1]=Math.floor(h[1]),h[2]=Math.ceil(h[2]),h[3]=Math.ceil(h[3])):h=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const c=this.current.activeSMask,S=this.suspendedCtx;tt(S,c,this.ctx,h),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const h=this.current;this.stateStack.push(h),this.current=h.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(h,c,S,T,t,i){this.ctx.transform(h,c,S,T,t,i),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(h,c,S){const T=this.ctx,t=this.current;let i=t.x,f=t.y,v,C;const F=(0,n.getCurrentTransform)(T),I=F[0]===0&&F[3]===0||F[1]===0&&F[2]===0,W=I?S.slice(0):null;for(let V=0,H=0,K=h.length;V<K;V++)switch(h[V]|0){case d.OPS.rectangle:i=c[H++],f=c[H++];const et=c[H++],J=c[H++],nt=i+et,it=f+J;T.moveTo(i,f),et===0||J===0?T.lineTo(nt,it):(T.lineTo(nt,f),T.lineTo(nt,it),T.lineTo(i,it)),I||t.updateRectMinMax(F,[i,f,nt,it]),T.closePath();break;case d.OPS.moveTo:i=c[H++],f=c[H++],T.moveTo(i,f),I||t.updatePathMinMax(F,i,f);break;case d.OPS.lineTo:i=c[H++],f=c[H++],T.lineTo(i,f),I||t.updatePathMinMax(F,i,f);break;case d.OPS.curveTo:v=i,C=f,i=c[H+4],f=c[H+5],T.bezierCurveTo(c[H],c[H+1],c[H+2],c[H+3],i,f),t.updateCurvePathMinMax(F,v,C,c[H],c[H+1],c[H+2],c[H+3],i,f,W),H+=6;break;case d.OPS.curveTo2:v=i,C=f,T.bezierCurveTo(i,f,c[H],c[H+1],c[H+2],c[H+3]),t.updateCurvePathMinMax(F,v,C,i,f,c[H],c[H+1],c[H+2],c[H+3],W),i=c[H+2],f=c[H+3],H+=4;break;case d.OPS.curveTo3:v=i,C=f,i=c[H+2],f=c[H+3],T.bezierCurveTo(c[H],c[H+1],i,f,i,f),t.updateCurvePathMinMax(F,v,C,c[H],c[H+1],i,f,i,f,W),H+=4;break;case d.OPS.closePath:T.closePath();break}I&&t.updateScalingPathMinMax(F,W),t.setCurrentPoint(i,f)}closePath(){this.ctx.closePath()}stroke(h){h=typeof h<"u"?h:!0;const c=this.ctx,S=this.current.strokeColor;c.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof S=="object"&&S?.getPattern?(c.save(),c.strokeStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),O.PathType.STROKE),this.rescaleAndStroke(!1),c.restore()):this.rescaleAndStroke(!0)),h&&this.consumePath(this.current.getClippedPathBoundingBox()),c.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(h){h=typeof h<"u"?h:!0;const c=this.ctx,S=this.current.fillColor,T=this.current.patternFill;let t=!1;T&&(c.save(),c.fillStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),O.PathType.FILL),t=!0);const i=this.current.getClippedPathBoundingBox();this.contentVisible&&i!==null&&(this.pendingEOFill?(c.fill("evenodd"),this.pendingEOFill=!1):c.fill()),t&&c.restore(),h&&this.consumePath(i)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=q}eoClip(){this.pendingClip=Y}beginText(){this.current.textMatrix=d.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const h=this.pendingTextPaths,c=this.ctx;if(h===void 0){c.beginPath();return}c.save(),c.beginPath();for(const S of h)c.setTransform(...S.transform),c.translate(S.x,S.y),S.addToPath(c,S.fontSize);c.restore(),c.clip(),c.beginPath(),delete this.pendingTextPaths}setCharSpacing(h){this.current.charSpacing=h}setWordSpacing(h){this.current.wordSpacing=h}setHScale(h){this.current.textHScale=h/100}setLeading(h){this.current.leading=-h}setFont(h,c){const S=this.commonObjs.get(h),T=this.current;if(!S)throw new Error(`Can't find font for ${h}`);if(T.fontMatrix=S.fontMatrix||d.FONT_IDENTITY_MATRIX,(T.fontMatrix[0]===0||T.fontMatrix[3]===0)&&(0,d.warn)("Invalid font matrix for font "+h),c<0?(c=-c,T.fontDirection=-1):T.fontDirection=1,this.current.font=S,this.current.fontSize=c,S.isType3Font)return;const t=S.loadedName||"sans-serif";let i="normal";S.black?i="900":S.bold&&(i="bold");const f=S.italic?"italic":"normal",v=`"${t}", ${S.fallbackName}`;let C=c;c<_?C=_:c>s&&(C=s),this.current.fontSizeScale=c/C,this.ctx.font=`${f} ${i} ${C}px ${v}`}setTextRenderingMode(h){this.current.textRenderingMode=h}setTextRise(h){this.current.textRise=h}moveText(h,c){this.current.x=this.current.lineX+=h,this.current.y=this.current.lineY+=c}setLeadingMoveText(h,c){this.setLeading(-c),this.moveText(h,c)}setTextMatrix(h,c,S,T,t,i){this.current.textMatrix=[h,c,S,T,t,i],this.current.textMatrixScale=Math.hypot(h,c),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(h,c,S,T){const t=this.ctx,i=this.current,f=i.font,v=i.textRenderingMode,C=i.fontSize/i.fontSizeScale,F=v&d.TextRenderingMode.FILL_STROKE_MASK,I=!!(v&d.TextRenderingMode.ADD_TO_PATH_FLAG),W=i.patternFill&&!f.missingFile;let V;(f.disableFontFace||I||W)&&(V=f.getPathGenerator(this.commonObjs,h)),f.disableFontFace||W?(t.save(),t.translate(c,S),t.beginPath(),V(t,C),T&&t.setTransform(...T),(F===d.TextRenderingMode.FILL||F===d.TextRenderingMode.FILL_STROKE)&&t.fill(),(F===d.TextRenderingMode.STROKE||F===d.TextRenderingMode.FILL_STROKE)&&t.stroke(),t.restore()):((F===d.TextRenderingMode.FILL||F===d.TextRenderingMode.FILL_STROKE)&&t.fillText(h,c,S),(F===d.TextRenderingMode.STROKE||F===d.TextRenderingMode.FILL_STROKE)&&t.strokeText(h,c,S)),I&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,n.getCurrentTransform)(t),x:c,y:S,fontSize:C,addToPath:V})}get isFontSubpixelAAEnabled(){const{context:h}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);h.scale(1.5,1),h.fillText("I",0,10);const c=h.getImageData(0,0,10,10).data;let S=!1;for(let T=3;T<c.length;T+=4)if(c[T]>0&&c[T]<255){S=!0;break}return(0,d.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(h){const c=this.current,S=c.font;if(S.isType3Font)return this.showType3Text(h);const T=c.fontSize;if(T===0)return;const t=this.ctx,i=c.fontSizeScale,f=c.charSpacing,v=c.wordSpacing,C=c.fontDirection,F=c.textHScale*C,I=h.length,W=S.vertical,V=W?1:-1,H=S.defaultVMetrics,K=T*c.fontMatrix[0],et=c.textRenderingMode===d.TextRenderingMode.FILL&&!S.disableFontFace&&!c.patternFill;t.save(),t.transform(...c.textMatrix),t.translate(c.x,c.y+c.textRise),C>0?t.scale(F,-1):t.scale(F,1);let J;if(c.patternFill){t.save();const st=c.fillColor.getPattern(t,this,(0,n.getCurrentTransformInverse)(t),O.PathType.FILL);J=(0,n.getCurrentTransform)(t),t.restore(),t.fillStyle=st}let nt=c.lineWidth;const it=c.textMatrixScale;if(it===0||nt===0){const st=c.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;(st===d.TextRenderingMode.STROKE||st===d.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=it;i!==1&&(t.scale(i,i),nt/=i),t.lineWidth=nt;let at=0,ot;for(ot=0;ot<I;++ot){const st=h[ot];if(typeof st=="number"){at+=V*st*T/1e3;continue}let ft=!1;const mt=(st.isSpace?v:0)+f,lt=st.fontChar,ut=st.accent;let gt,St,At=st.width;if(W){const _t=st.vmetric||H,pt=-(st.vmetric?_t[1]:At*.5)*K,Ft=_t[2]*K;At=_t?-_t[0]:At,gt=pt/i,St=(at+Ft)/i}else gt=at/i,St=0;if(S.remeasure&&At>0){const _t=t.measureText(lt).width*1e3/T*i;if(At<_t&&this.isFontSubpixelAAEnabled){const pt=At/_t;ft=!0,t.save(),t.scale(pt,1),gt/=pt}else At!==_t&&(gt+=(At-_t)/2e3*T/i)}if(this.contentVisible&&(st.isInFont||S.missingFile)){if(et&&!ut)t.fillText(lt,gt,St);else if(this.paintChar(lt,gt,St,J),ut){const _t=gt+T*ut.offset.x/i,pt=St-T*ut.offset.y/i;this.paintChar(ut.fontChar,_t,pt,J)}}let Tt;W?Tt=At*K-mt*C:Tt=At*K+mt*C,at+=Tt,ft&&t.restore()}W?c.y-=at:c.x+=at*F,t.restore(),this.compose()}showType3Text(h){const c=this.ctx,S=this.current,T=S.font,t=S.fontSize,i=S.fontDirection,f=T.vertical?1:-1,v=S.charSpacing,C=S.wordSpacing,F=S.textHScale*i,I=S.fontMatrix||d.FONT_IDENTITY_MATRIX,W=h.length,V=S.textRenderingMode===d.TextRenderingMode.INVISIBLE;let H,K,et,J;if(!(V||t===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,c.save(),c.transform(...S.textMatrix),c.translate(S.x,S.y),c.scale(F,i),H=0;H<W;++H){if(K=h[H],typeof K=="number"){J=f*K*t/1e3,this.ctx.translate(J,0),S.x+=J*F;continue}const nt=(K.isSpace?C:0)+v,it=T.charProcOperatorList[K.operatorListId];if(!it){(0,d.warn)(`Type3 character "${K.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=K,this.save(),c.scale(t,t),c.transform(...I),this.executeOperatorList(it),this.restore()),et=d.Util.applyTransform([K.width,0],I)[0]*t+nt,c.translate(et,0),S.x+=et*F}c.restore(),this.processingType3=null}}setCharWidth(h,c){}setCharWidthAndBounds(h,c,S,T,t,i){this.ctx.rect(S,T,t-S,i-T),this.ctx.clip(),this.endPath()}getColorN_Pattern(h){let c;if(h[0]==="TilingPattern"){const S=h[1],T=this.baseTransform||(0,n.getCurrentTransform)(this.ctx),t={createCanvasGraphics:i=>new z(i,this.commonObjs,this.objs,this.canvasFactory)};c=new O.TilingPattern(h,S,this.ctx,t,T)}else c=this._getPattern(h[1],h[2]);return c}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(h,c,S){const T=this.selectColor?.(h,c,S)||d.Util.makeHexColor(h,c,S);this.ctx.strokeStyle=T,this.current.strokeColor=T}setFillRGBColor(h,c,S){const T=this.selectColor?.(h,c,S)||d.Util.makeHexColor(h,c,S);this.ctx.fillStyle=T,this.current.fillColor=T,this.current.patternFill=!1}_getPattern(h,c=null){let S;return this.cachedPatterns.has(h)?S=this.cachedPatterns.get(h):(S=(0,O.getShadingPattern)(this.objs.get(h)),this.cachedPatterns.set(h,S)),c&&(S.matrix=c),S}shadingFill(h){if(!this.contentVisible)return;const c=this.ctx;this.save();const S=this._getPattern(h);c.fillStyle=S.getPattern(c,this,(0,n.getCurrentTransformInverse)(c),O.PathType.SHADING);const T=(0,n.getCurrentTransformInverse)(c);if(T){const t=c.canvas,i=t.width,f=t.height,v=d.Util.applyTransform([0,0],T),C=d.Util.applyTransform([0,f],T),F=d.Util.applyTransform([i,0],T),I=d.Util.applyTransform([i,f],T),W=Math.min(v[0],C[0],F[0],I[0]),V=Math.min(v[1],C[1],F[1],I[1]),H=Math.max(v[0],C[0],F[0],I[0]),K=Math.max(v[1],C[1],F[1],I[1]);this.ctx.fillRect(W,V,H-W,K-V)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,d.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,d.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(h,c){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(h)&&h.length===6&&this.transform(...h),this.baseTransform=(0,n.getCurrentTransform)(this.ctx),c)){const S=c[2]-c[0],T=c[3]-c[1];this.ctx.rect(c[0],c[1],S,T),this.current.updateRectMinMax((0,n.getCurrentTransform)(this.ctx),c),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(h){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const c=this.ctx;h.isolated||(0,d.info)("TODO: Support non-isolated groups."),h.knockout&&(0,d.warn)("Knockout groups not supported.");const S=(0,n.getCurrentTransform)(c);if(h.matrix&&c.transform(...h.matrix),!h.bbox)throw new Error("Bounding box is required.");let T=d.Util.getAxialAlignedBoundingBox(h.bbox,(0,n.getCurrentTransform)(c));const t=[0,0,c.canvas.width,c.canvas.height];T=d.Util.intersect(T,t)||[0,0,0,0];const i=Math.floor(T[0]),f=Math.floor(T[1]);let v=Math.max(Math.ceil(T[2])-i,1),C=Math.max(Math.ceil(T[3])-f,1),F=1,I=1;v>a&&(F=v/a,v=a),C>a&&(I=C/a,C=a),this.current.startNewPathAndClipBox([0,0,v,C]);let W="groupAt"+this.groupLevel;h.smask&&(W+="_smask_"+this.smaskCounter++%2);const V=this.cachedCanvases.getCanvas(W,v,C),H=V.context;H.scale(1/F,1/I),H.translate(-i,-f),H.transform(...S),h.smask?this.smaskStack.push({canvas:V.canvas,context:H,offsetX:i,offsetY:f,scaleX:F,scaleY:I,subtype:h.smask.subtype,backdrop:h.smask.backdrop,transferMap:h.smask.transferMap||null,startTransformInverse:null}):(c.setTransform(1,0,0,1,0,0),c.translate(i,f),c.scale(F,I),c.save()),l(c,H),this.ctx=H,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(c),this.groupLevel++}endGroup(h){if(!this.contentVisible)return;this.groupLevel--;const c=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,h.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const T=(0,n.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...T);const t=d.Util.getAxialAlignedBoundingBox([0,0,c.canvas.width,c.canvas.height],T);this.ctx.drawImage(c.canvas,0,0),this.ctx.restore(),this.compose(t)}}beginAnnotation(h,c,S,T,t){if(this.#t(),y(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(c)&&c.length===4){const i=c[2]-c[0],f=c[3]-c[1];if(t&&this.annotationCanvasMap){S=S.slice(),S[4]-=c[0],S[5]-=c[1],c=c.slice(),c[0]=c[1]=0,c[2]=i,c[3]=f;const[v,C]=d.Util.singularValueDecompose2dScale((0,n.getCurrentTransform)(this.ctx)),{viewportScale:F}=this,I=Math.ceil(i*this.outputScaleX*F),W=Math.ceil(f*this.outputScaleY*F);this.annotationCanvas=this.canvasFactory.create(I,W);const{canvas:V,context:H}=this.annotationCanvas;this.annotationCanvasMap.set(h,V),this.annotationCanvas.savedCtx=this.ctx,this.ctx=H,this.ctx.setTransform(v,0,0,-C,0,f*C),y(this.ctx,this.foregroundColor)}else y(this.ctx,this.foregroundColor),this.ctx.rect(c[0],c[1],i,f),this.ctx.clip(),this.endPath()}this.current=new M(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...T)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(h){if(!this.contentVisible)return;const c=h.count;h=this.getObject(h.data,h),h.count=c;const S=this.ctx,T=this.processingType3;if(T&&(T.compiled===void 0&&(T.compiled=k(h)),T.compiled)){T.compiled(S);return}const t=this._createMaskCanvas(h),i=t.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(i,t.offsetX,t.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(h,c,S=0,T=0,t,i){if(!this.contentVisible)return;h=this.getObject(h.data,h);const f=this.ctx;f.save();const v=(0,n.getCurrentTransform)(f);f.transform(c,S,T,t,0,0);const C=this._createMaskCanvas(h);f.setTransform(1,0,0,1,0,0);for(let F=0,I=i.length;F<I;F+=2){const W=d.Util.transform(v,[c,S,T,t,i[F],i[F+1]]),[V,H]=d.Util.applyTransform([0,0],W);f.drawImage(C.canvas,V,H)}f.restore(),this.compose()}paintImageMaskXObjectGroup(h){if(!this.contentVisible)return;const c=this.ctx,S=this.current.fillColor,T=this.current.patternFill;for(const t of h){const{data:i,width:f,height:v,transform:C}=t,F=this.cachedCanvases.getCanvas("maskCanvas",f,v),I=F.context;I.save();const W=this.getObject(i,t);r(I,W),I.globalCompositeOperation="source-in",I.fillStyle=T?S.getPattern(I,this,(0,n.getCurrentTransformInverse)(c),O.PathType.FILL):S,I.fillRect(0,0,f,v),I.restore(),c.save(),c.transform(...C),c.scale(1,-1),D(c,F.canvas,0,0,f,v,0,-1,1,1),c.restore()}this.compose()}paintImageXObject(h){if(!this.contentVisible)return;const c=this.getObject(h);if(!c){(0,d.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(c)}paintImageXObjectRepeat(h,c,S,T){if(!this.contentVisible)return;const t=this.getObject(h);if(!t){(0,d.warn)("Dependent image isn't ready yet");return}const i=t.width,f=t.height,v=[];for(let C=0,F=T.length;C<F;C+=2)v.push({transform:[c,0,0,S,T[C],T[C+1]],x:0,y:0,w:i,h:f});this.paintInlineImageXObjectGroup(t,v)}paintInlineImageXObject(h){if(!this.contentVisible)return;const c=h.width,S=h.height,T=this.ctx;this.save(),T.scale(1/c,-1/S);let t;if(typeof HTMLElement=="function"&&h instanceof HTMLElement||!h.data)t=h;else{const C=this.cachedCanvases.getCanvas("inlineImage",c,S),F=C.context;m(F,h,this.current.transferMaps),t=C.canvas}const i=this._scaleImage(t,(0,n.getCurrentTransformInverse)(T));T.imageSmoothingEnabled=Z((0,n.getCurrentTransform)(T),h.interpolate);const[f,v]=D(T,i.img,0,0,i.paintWidth,i.paintHeight,0,-S,c,S);if(this.imageLayer){const[C,F]=d.Util.applyTransform([0,-S],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:h,left:C,top:F,width:f,height:v})}this.compose(),this.restore()}paintInlineImageXObjectGroup(h,c){if(!this.contentVisible)return;const S=this.ctx,T=h.width,t=h.height,i=this.cachedCanvases.getCanvas("inlineImage",T,t),f=i.context;m(f,h,this.current.transferMaps);for(const v of c){if(S.save(),S.transform(...v.transform),S.scale(1,-1),D(S,i.canvas,v.x,v.y,v.w,v.h,0,-1,1,1),this.imageLayer){const[C,F]=d.Util.applyTransform([v.x,v.y],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:h,left:C,top:F,width:T,height:t})}S.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(h){}markPointProps(h,c){}beginMarkedContent(h){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(h,c){h==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(c)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(h){const c=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(h);const S=this.ctx;this.pendingClip&&(c||(this.pendingClip===Y?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const h=(0,n.getCurrentTransform)(this.ctx);if(h[1]===0&&h[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(h[0]),Math.abs(h[3]));else{const c=Math.abs(h[0]*h[3]-h[2]*h[1]),S=Math.hypot(h[0],h[2]),T=Math.hypot(h[1],h[3]);this._cachedGetSinglePixelWidth=Math.max(S,T)/c}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:h}=this.current,c=(0,n.getCurrentTransform)(this.ctx);let S,T;if(c[1]===0&&c[2]===0){const t=Math.abs(c[0]),i=Math.abs(c[3]);if(h===0)S=1/t,T=1/i;else{const f=t*h,v=i*h;S=f<1?1/f:1,T=v<1?1/v:1}}else{const t=Math.abs(c[0]*c[3]-c[2]*c[1]),i=Math.hypot(c[0],c[1]),f=Math.hypot(c[2],c[3]);if(h===0)S=f/t,T=i/t;else{const v=h*t;S=f>v?f/v:1,T=i>v?i/v:1}}this._cachedScaleForStroking=[S,T]}return this._cachedScaleForStroking}rescaleAndStroke(h){const{ctx:c}=this,{lineWidth:S}=this.current,[T,t]=this.getScaleForStroking();if(c.lineWidth=S||1,T===1&&t===1){c.stroke();return}let i,f,v;h&&(i=(0,n.getCurrentTransform)(c),f=c.getLineDash().slice(),v=c.lineDashOffset),c.scale(T,t);const C=Math.max(T,t);c.setLineDash(c.getLineDash().map(F=>F/C)),c.lineDashOffset/=C,c.stroke(),h&&(c.setTransform(...i),c.setLineDash(f),c.lineDashOffset=v)}isContentVisible(){for(let h=this.markedContentStack.length-1;h>=0;h--)if(!this.markedContentStack[h].visible)return!1;return!0}}e.CanvasGraphics=z;for(const x in d.OPS)z.prototype[x]!==void 0&&(z.prototype[d.OPS[x]]=z.prototype[x])},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=o;var n=E(1),d=E(8),O=E(3);const R={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=R;function L(D,k){if(!k||O.isNodeJS)return;const M=k[2]-k[0],m=k[3]-k[1],r=new Path2D;r.rect(k[0],k[1],M,m),D.clip(r)}class _{constructor(){this.constructor===_&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class s extends _{constructor(k){super(),this._type=k[1],this._bbox=k[2],this._colorStops=k[3],this._p0=k[4],this._p1=k[5],this._r0=k[6],this._r1=k[7],this.matrix=null}_createGradient(k){let M;this._type==="axial"?M=k.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(M=k.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const m of this._colorStops)M.addColorStop(m[0],m[1]);return M}getPattern(k,M,m,r){let l;if(r===R.STROKE||r===R.FILL){const y=M.current.getClippedPathBoundingBox(r,(0,d.getCurrentTransform)(k))||[0,0,0,0],w=Math.ceil(y[2]-y[0])||1,P=Math.ceil(y[3]-y[1])||1,j=M.cachedCanvases.getCanvas("pattern",w,P,!0),N=j.context;N.clearRect(0,0,N.canvas.width,N.canvas.height),N.beginPath(),N.rect(0,0,N.canvas.width,N.canvas.height),N.translate(-y[0],-y[1]),m=n.Util.transform(m,[1,0,0,1,y[0],y[1]]),N.transform(...M.baseTransform),this.matrix&&N.transform(...this.matrix),L(N,this._bbox),N.fillStyle=this._createGradient(N),N.fill(),l=k.createPattern(j.canvas,"no-repeat");const tt=new DOMMatrix(m);try{l.setTransform(tt)}catch(Z){(0,n.warn)(`RadialAxialShadingPattern.getPattern: "${Z?.message}".`)}}else L(k,this._bbox),l=this._createGradient(k);return l}}function a(D,k,M,m,r,l,y,w){const P=k.coords,j=k.colors,N=D.data,tt=D.width*4;let Z;P[M+1]>P[m+1]&&(Z=M,M=m,m=Z,Z=l,l=y,y=Z),P[m+1]>P[r+1]&&(Z=m,m=r,r=Z,Z=y,y=w,w=Z),P[M+1]>P[m+1]&&(Z=M,M=m,m=Z,Z=l,l=y,y=Z);const B=(P[M]+k.offsetX)*k.scaleX,U=(P[M+1]+k.offsetY)*k.scaleY,q=(P[m]+k.offsetX)*k.scaleX,Y=(P[m+1]+k.offsetY)*k.scaleY,z=(P[r]+k.offsetX)*k.scaleX,x=(P[r+1]+k.offsetY)*k.scaleY;if(U>=x)return;const h=j[l],c=j[l+1],S=j[l+2],T=j[y],t=j[y+1],i=j[y+2],f=j[w],v=j[w+1],C=j[w+2],F=Math.round(U),I=Math.round(x);let W,V,H,K,et,J,nt,it;for(let at=F;at<=I;at++){if(at<Y){let lt;at<U?lt=0:lt=(U-at)/(U-Y),W=B-(B-q)*lt,V=h-(h-T)*lt,H=c-(c-t)*lt,K=S-(S-i)*lt}else{let lt;at>x?lt=1:Y===x?lt=0:lt=(Y-at)/(Y-x),W=q-(q-z)*lt,V=T-(T-f)*lt,H=t-(t-v)*lt,K=i-(i-C)*lt}let ot;at<U?ot=0:at>x?ot=1:ot=(U-at)/(U-x),et=B-(B-z)*ot,J=h-(h-f)*ot,nt=c-(c-v)*ot,it=S-(S-C)*ot;const st=Math.round(Math.min(W,et)),ft=Math.round(Math.max(W,et));let mt=tt*at+st*4;for(let lt=st;lt<=ft;lt++)ot=(W-lt)/(W-et),ot<0?ot=0:ot>1&&(ot=1),N[mt++]=V-(V-J)*ot|0,N[mt++]=H-(H-nt)*ot|0,N[mt++]=K-(K-it)*ot|0,N[mt++]=255}}function u(D,k,M){const m=k.coords,r=k.colors;let l,y;switch(k.type){case"lattice":const w=k.verticesPerRow,P=Math.floor(m.length/w)-1,j=w-1;for(l=0;l<P;l++){let N=l*w;for(let tt=0;tt<j;tt++,N++)a(D,M,m[N],m[N+1],m[N+w],r[N],r[N+1],r[N+w]),a(D,M,m[N+w+1],m[N+1],m[N+w],r[N+w+1],r[N+1],r[N+w])}break;case"triangles":for(l=0,y=m.length;l<y;l+=3)a(D,M,m[l],m[l+1],m[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class p extends _{constructor(k){super(),this._coords=k[2],this._colors=k[3],this._figures=k[4],this._bounds=k[5],this._bbox=k[7],this._background=k[8],this.matrix=null}_createMeshCanvas(k,M,m){const w=Math.floor(this._bounds[0]),P=Math.floor(this._bounds[1]),j=Math.ceil(this._bounds[2])-w,N=Math.ceil(this._bounds[3])-P,tt=Math.min(Math.ceil(Math.abs(j*k[0]*1.1)),3e3),Z=Math.min(Math.ceil(Math.abs(N*k[1]*1.1)),3e3),B=j/tt,U=N/Z,q={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-P,scaleX:1/B,scaleY:1/U},Y=tt+2*2,z=Z+2*2,x=m.getCanvas("mesh",Y,z,!1),h=x.context,c=h.createImageData(tt,Z);if(M){const T=c.data;for(let t=0,i=T.length;t<i;t+=4)T[t]=M[0],T[t+1]=M[1],T[t+2]=M[2],T[t+3]=255}for(const T of this._figures)u(c,T,q);return h.putImageData(c,2,2),{canvas:x.canvas,offsetX:w-2*B,offsetY:P-2*U,scaleX:B,scaleY:U}}getPattern(k,M,m,r){L(k,this._bbox);let l;if(r===R.SHADING)l=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(k));else if(l=n.Util.singularValueDecompose2dScale(M.baseTransform),this.matrix){const w=n.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*w[0],l[1]*w[1]]}const y=this._createMeshCanvas(l,r===R.SHADING?null:this._background,M.cachedCanvases);return r!==R.SHADING&&(k.setTransform(...M.baseTransform),this.matrix&&k.transform(...this.matrix)),k.translate(y.offsetX,y.offsetY),k.scale(y.scaleX,y.scaleY),k.createPattern(y.canvas,"no-repeat")}}class A extends _{getPattern(){return"hotpink"}}function o(D){switch(D[0]){case"RadialAxial":return new s(D);case"Mesh":return new p(D);case"Dummy":return new A}throw new Error(`Unknown IR type: ${D[0]}`)}const g={COLORED:1,UNCOLORED:2};class b{static get MAX_PATTERN_SIZE(){return(0,n.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(k,M,m,r,l){this.operatorList=k[2],this.matrix=k[3]||[1,0,0,1,0,0],this.bbox=k[4],this.xstep=k[5],this.ystep=k[6],this.paintType=k[7],this.tilingType=k[8],this.color=M,this.ctx=m,this.canvasGraphicsFactory=r,this.baseTransform=l}createPatternCanvas(k){const M=this.operatorList,m=this.bbox,r=this.xstep,l=this.ystep,y=this.paintType,w=this.tilingType,P=this.color,j=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+w);const N=m[0],tt=m[1],Z=m[2],B=m[3],U=n.Util.singularValueDecompose2dScale(this.matrix),q=n.Util.singularValueDecompose2dScale(this.baseTransform),Y=[U[0]*q[0],U[1]*q[1]],z=this.getSizeAndScale(r,this.ctx.canvas.width,Y[0]),x=this.getSizeAndScale(l,this.ctx.canvas.height,Y[1]),h=k.cachedCanvases.getCanvas("pattern",z.size,x.size,!0),c=h.context,S=j.createCanvasGraphics(c);S.groupLevel=k.groupLevel,this.setFillAndStrokeStyleToContext(S,y,P);let T=N,t=tt,i=Z,f=B;return N<0&&(T=0,i+=Math.abs(N)),tt<0&&(t=0,f+=Math.abs(tt)),c.translate(-(z.scale*T),-(x.scale*t)),S.transform(z.scale,0,0,x.scale,0,0),c.save(),this.clipBbox(S,T,t,i,f),S.baseTransform=(0,d.getCurrentTransform)(S.ctx),S.executeOperatorList(M),S.endDrawing(),{canvas:h.canvas,scaleX:z.scale,scaleY:x.scale,offsetX:T,offsetY:t}}getSizeAndScale(k,M,m){k=Math.abs(k);const r=Math.max(b.MAX_PATTERN_SIZE,M);let l=Math.ceil(k*m);return l>=r?l=r:m=l/k,{scale:m,size:l}}clipBbox(k,M,m,r,l){const y=r-M,w=l-m;k.ctx.rect(M,m,y,w),k.current.updateRectMinMax((0,d.getCurrentTransform)(k.ctx),[M,m,r,l]),k.clip(),k.endPath()}setFillAndStrokeStyleToContext(k,M,m){const r=k.ctx,l=k.current;switch(M){case g.COLORED:const y=this.ctx;r.fillStyle=y.fillStyle,r.strokeStyle=y.strokeStyle,l.fillColor=y.fillStyle,l.strokeColor=y.strokeStyle;break;case g.UNCOLORED:const w=n.Util.makeHexColor(m[0],m[1],m[2]);r.fillStyle=w,r.strokeStyle=w,l.fillColor=w,l.strokeColor=w;break;default:throw new n.FormatError(`Unsupported paint type: ${M}`)}}getPattern(k,M,m,r){let l=m;r!==R.SHADING&&(l=n.Util.transform(l,M.baseTransform),this.matrix&&(l=n.Util.transform(l,this.matrix)));const y=this.createPatternCanvas(M);let w=new DOMMatrix(l);w=w.translate(y.offsetX,y.offsetY),w=w.scale(1/y.scaleX,1/y.scaleY);const P=k.createPattern(y.canvas,"repeat");try{P.setTransform(w)}catch(j){(0,n.warn)(`TilingPattern.getPattern: "${j?.message}".`)}return P}}e.TilingPattern=b},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.applyMaskImageData=d;var n=E(1);function d({src:O,srcPos:R=0,dest:L,destPos:_=0,width:s,height:a,inverseDecode:u=!1}){const p=n.FeatureTest.isLittleEndian?4278190080:255,[A,o]=u?[0,p]:[p,0],g=s>>3,b=s&7,D=O.length;L=new Uint32Array(L.buffer);for(let k=0;k<a;k++){for(const m=R+g;R<m;R++){const r=R<D?O[R]:255;L[_++]=r&128?o:A,L[_++]=r&64?o:A,L[_++]=r&32?o:A,L[_++]=r&16?o:A,L[_++]=r&8?o:A,L[_++]=r&4?o:A,L[_++]=r&2?o:A,L[_++]=r&1?o:A}if(b===0)continue;const M=R<D?O[R++]:255;for(let m=0;m<b;m++)L[_++]=M&1<<7-m?o:A}return{srcPos:R,destPos:_}}},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const E=Object.create(null);e.GlobalWorkerOptions=E,E.workerPort=E.workerPort===void 0?null:E.workerPort,E.workerSrc=E.workerSrc===void 0?"":E.workerSrc},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=E(1);const d={DATA:1,ERROR:2},O={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function R(_){switch(_ instanceof Error||typeof _=="object"&&_!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),_.name){case"AbortException":return new n.AbortException(_.message);case"MissingPDFException":return new n.MissingPDFException(_.message);case"PasswordException":return new n.PasswordException(_.message,_.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(_.message,_.status);case"UnknownErrorException":return new n.UnknownErrorException(_.message,_.details);default:return new n.UnknownErrorException(_.message,_.toString())}}class L{constructor(s,a,u){this.sourceName=s,this.targetName=a,this.comObj=u,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=p=>{const A=p.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const g=A.callbackId,b=this.callbackCapabilities[g];if(!b)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],A.callback===d.DATA)b.resolve(A.data);else if(A.callback===d.ERROR)b.reject(R(A.reason));else throw new Error("Unexpected callback case");return}const o=this.actionHandler[A.action];if(!o)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const g=this.sourceName,b=A.sourceName;new Promise(function(D){D(o(A.data))}).then(function(D){u.postMessage({sourceName:g,targetName:b,callback:d.DATA,callbackId:A.callbackId,data:D})},function(D){u.postMessage({sourceName:g,targetName:b,callback:d.ERROR,callbackId:A.callbackId,reason:R(D)})});return}if(A.streamId){this._createStreamSink(A);return}o(A.data)},u.addEventListener("message",this._onComObjOnMessage)}on(s,a){const u=this.actionHandler;if(u[s])throw new Error(`There is already an actionName called "${s}"`);u[s]=a}send(s,a,u){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,data:a},u)}sendWithPromise(s,a,u){const p=this.callbackId++,A=(0,n.createPromiseCapability)();this.callbackCapabilities[p]=A;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,callbackId:p,data:a},u)}catch(o){A.reject(o)}return A.promise}sendWithStream(s,a,u,p){const A=this.streamId++,o=this.sourceName,g=this.targetName,b=this.comObj;return new ReadableStream({start:D=>{const k=(0,n.createPromiseCapability)();return this.streamControllers[A]={controller:D,startCall:k,pullCall:null,cancelCall:null,isClosed:!1},b.postMessage({sourceName:o,targetName:g,action:s,streamId:A,data:a,desiredSize:D.desiredSize},p),k.promise},pull:D=>{const k=(0,n.createPromiseCapability)();return this.streamControllers[A].pullCall=k,b.postMessage({sourceName:o,targetName:g,stream:O.PULL,streamId:A,desiredSize:D.desiredSize}),k.promise},cancel:D=>{(0,n.assert)(D instanceof Error,"cancel must have a valid reason");const k=(0,n.createPromiseCapability)();return this.streamControllers[A].cancelCall=k,this.streamControllers[A].isClosed=!0,b.postMessage({sourceName:o,targetName:g,stream:O.CANCEL,streamId:A,reason:R(D)}),k.promise}},u)}_createStreamSink(s){const a=s.streamId,u=this.sourceName,p=s.sourceName,A=this.comObj,o=this,g=this.actionHandler[s.action],b={enqueue(D,k=1,M){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=k,m>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),A.postMessage({sourceName:u,targetName:p,stream:O.ENQUEUE,streamId:a,chunk:D},M)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:u,targetName:p,stream:O.CLOSE,streamId:a}),delete o.streamSinks[a])},error(D){(0,n.assert)(D instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:u,targetName:p,stream:O.ERROR,streamId:a,reason:R(D)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:s.desiredSize,ready:null};b.sinkCapability.resolve(),b.ready=b.sinkCapability.promise,this.streamSinks[a]=b,new Promise(function(D){D(g(s.data,b))}).then(function(){A.postMessage({sourceName:u,targetName:p,stream:O.START_COMPLETE,streamId:a,success:!0})},function(D){A.postMessage({sourceName:u,targetName:p,stream:O.START_COMPLETE,streamId:a,reason:R(D)})})}_processStreamMessage(s){const a=s.streamId,u=this.sourceName,p=s.sourceName,A=this.comObj,o=this.streamControllers[a],g=this.streamSinks[a];switch(s.stream){case O.START_COMPLETE:s.success?o.startCall.resolve():o.startCall.reject(R(s.reason));break;case O.PULL_COMPLETE:s.success?o.pullCall.resolve():o.pullCall.reject(R(s.reason));break;case O.PULL:if(!g){A.postMessage({sourceName:u,targetName:p,stream:O.PULL_COMPLETE,streamId:a,success:!0});break}g.desiredSize<=0&&s.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=s.desiredSize,new Promise(function(b){b(g.onPull&&g.onPull())}).then(function(){A.postMessage({sourceName:u,targetName:p,stream:O.PULL_COMPLETE,streamId:a,success:!0})},function(b){A.postMessage({sourceName:u,targetName:p,stream:O.PULL_COMPLETE,streamId:a,reason:R(b)})});break;case O.ENQUEUE:if((0,n.assert)(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(s.chunk);break;case O.CLOSE:if((0,n.assert)(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this._deleteStreamController(o,a);break;case O.ERROR:(0,n.assert)(o,"error should have stream controller"),o.controller.error(R(s.reason)),this._deleteStreamController(o,a);break;case O.CANCEL_COMPLETE:s.success?o.cancelCall.resolve():o.cancelCall.reject(R(s.reason)),this._deleteStreamController(o,a);break;case O.CANCEL:if(!g)break;new Promise(function(b){b(g.onCancel&&g.onCancel(R(s.reason)))}).then(function(){A.postMessage({sourceName:u,targetName:p,stream:O.CANCEL_COMPLETE,streamId:a,success:!0})},function(b){A.postMessage({sourceName:u,targetName:p,stream:O.CANCEL_COMPLETE,streamId:a,reason:R(b)})}),g.sinkCapability.reject(R(s.reason)),g.isCancelled=!0,delete this.streamSinks[a];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(s,a){await Promise.allSettled([s.startCall&&s.startCall.promise,s.pullCall&&s.pullCall.promise,s.cancelCall&&s.cancelCall.promise]),delete this.streamControllers[a]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}e.MessageHandler=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=E(1);class d{#t;#e;constructor({parsedData:R,rawData:L}){this.#t=R,this.#e=L}getRaw(){return this.#e}get(R){return this.#t.get(R)??null}getAll(){return(0,n.objectFromMap)(this.#t)}has(R){return this.#t.has(R)}}e.Metadata=d},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=E(1);const d=Symbol("INTERNAL");class O{#t=!0;constructor(_,s){this.name=_,this.intent=s}get visible(){return this.#t}_setVisible(_,s){_!==d&&(0,n.unreachable)("Internal method `_setVisible` called."),this.#t=s}}class R{#t=!0;#e=new Map;#i=null;#s=null;constructor(_){if(this.name=null,this.creator=null,_!==null){this.name=_.name,this.creator=_.creator,this.#s=_.order;for(const s of _.groups)this.#e.set(s.id,new O(s.name,s.intent));if(_.baseState==="OFF")for(const s of this.#e.values())s._setVisible(d,!1);for(const s of _.on)this.#e.get(s)._setVisible(d,!0);for(const s of _.off)this.#e.get(s)._setVisible(d,!1);this.#i=new Map;for(const[s,a]of this.#e)this.#i.set(s,a.visible)}}#r(_){const s=_.length;if(s<2)return!0;const a=_[0];for(let u=1;u<s;u++){const p=_[u];let A;if(Array.isArray(p))A=this.#r(p);else if(this.#e.has(p))A=this.#e.get(p).visible;else return(0,n.warn)(`Optional content group not found: ${p}`),!0;switch(a){case"And":if(!A)return!1;break;case"Or":if(A)return!0;break;case"Not":return!A;default:return!0}}return a==="And"}isVisible(_){if(this.#e.size===0)return!0;if(!_)return(0,n.warn)("Optional content group not defined."),!0;if(_.type==="OCG")return this.#e.has(_.id)?this.#e.get(_.id).visible:((0,n.warn)(`Optional content group not found: ${_.id}`),!0);if(_.type==="OCMD"){if(_.expression)return this.#r(_.expression);if(!_.policy||_.policy==="AnyOn"){for(const s of _.ids){if(!this.#e.has(s))return(0,n.warn)(`Optional content group not found: ${s}`),!0;if(this.#e.get(s).visible)return!0}return!1}else if(_.policy==="AllOn"){for(const s of _.ids){if(!this.#e.has(s))return(0,n.warn)(`Optional content group not found: ${s}`),!0;if(!this.#e.get(s).visible)return!1}return!0}else if(_.policy==="AnyOff"){for(const s of _.ids){if(!this.#e.has(s))return(0,n.warn)(`Optional content group not found: ${s}`),!0;if(!this.#e.get(s).visible)return!0}return!1}else if(_.policy==="AllOff"){for(const s of _.ids){if(!this.#e.has(s))return(0,n.warn)(`Optional content group not found: ${s}`),!0;if(this.#e.get(s).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${_.policy}.`),!0}return(0,n.warn)(`Unknown group type ${_.type}.`),!0}setVisibility(_,s=!0){if(!this.#e.has(_)){(0,n.warn)(`Optional content group not found: ${_}`);return}this.#e.get(_)._setVisible(d,!!s),this.#t=null}get hasInitialVisibility(){if(this.#t!==null)return this.#t;for(const[_,s]of this.#e){const a=this.#i.get(_);if(s.visible!==a)return this.#t=!1}return this.#t=!0}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,n.objectFromMap)(this.#e):null}getGroup(_){return this.#e.get(_)||null}}e.OptionalContentConfig=R},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=E(1),d=E(8);class O{constructor(s,a){(0,n.assert)(a,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=s.progressiveDone||!1,this._contentDispositionFilename=s.contentDispositionFilename||null;const u=s.initialData;if(u?.length>0){const p=new Uint8Array(u).buffer;this._queuedChunks.push(p)}this._pdfDataRangeTransport=a,this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._contentLength=s.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((p,A)=>{this._onReceiveData({begin:p,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((p,A)=>{this._onProgress({loaded:p,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(p=>{this._onReceiveData({chunk:p})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(s){const a=new Uint8Array(s.chunk).buffer;if(s.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(a):this._queuedChunks.push(a);else{const u=this._rangeReaders.some(function(p){return p._begin!==s.begin?!1:(p._enqueue(a),!0)});(0,n.assert)(u,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(s){if(s.total===void 0){const a=this._rangeReaders[0];a?.onProgress&&a.onProgress({loaded:s.loaded})}else{const a=this._fullRequestReader;a?.onProgress&&a.onProgress({loaded:s.loaded,total:s.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(s){const a=this._rangeReaders.indexOf(s);a>=0&&this._rangeReaders.splice(a,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const s=this._queuedChunks;return this._queuedChunks=null,new R(this,s,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(s,a){if(a<=this._progressiveDataLength)return null;const u=new L(this,s,a);return this._pdfDataRangeTransport.requestDataRange(s,a),this._rangeReaders.push(u),u}cancelAllRequests(s){this._fullRequestReader&&this._fullRequestReader.cancel(s);for(const a of this._rangeReaders.slice(0))a.cancel(s);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=O;class R{constructor(s,a,u=!1,p=null){this._stream=s,this._done=u||!1,this._filename=(0,d.isPdfFile)(p)?p:null,this._queuedChunks=a||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),s._fullRequestReader=this,this.onProgress=null}_enqueue(s){this._done||(this._requests.length>0?this._requests.shift().resolve({value:s,done:!1}):this._queuedChunks.push(s),this._loaded+=s.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const s=(0,n.createPromiseCapability)();return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class L{constructor(s,a,u){this._stream=s,this._begin=a,this._end=u,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(s){if(!this._done){if(this._requests.length===0)this._queuedChunk=s;else{this._requests.shift().resolve({value:s,done:!1});for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const a=this._queuedChunk;return this._queuedChunk=null,{value:a,done:!1}}if(this._done)return{value:void 0,done:!0};const s=(0,n.createPromiseCapability)();return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class E{static textContent(d){const O=[],R={items:O,styles:Object.create(null)};function L(_){if(!_)return;let s=null;const a=_.name;if(a==="#text")s=_.value;else if(E.shouldBuildText(a))_?.attributes?.textContent?s=_.attributes.textContent:_.value&&(s=_.value);else return;if(s!==null&&O.push({str:s}),!!_.children)for(const u of _.children)L(u)}return L(d),R}static shouldBuildText(d){return!(d==="textarea"||d==="input"||d==="option"||d==="select")}}e.XfaText=E},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=E(9);const d=function(_){return new Promise((s,a)=>{require$$5.readFile(_,(p,A)=>{if(p||!A){a(new Error(p));return}s(new Uint8Array(A))})})};class O extends n.BaseCanvasFactory{_createCanvas(s,a){return require$$5.createCanvas(s,a)}}e.NodeCanvasFactory=O;class R extends n.BaseCMapReaderFactory{_fetchData(s,a){return d(s).then(u=>({cMapData:u,compressionType:a}))}}e.NodeCMapReaderFactory=R;class L extends n.BaseStandardFontDataFactory{_fetchData(s){return d(s)}}e.NodeStandardFontDataFactory=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=E(7),d=E(1),O=E(23),R=E(24);class L{#t;#e=!1;#i=this.pointerup.bind(this);#s=this.pointerdown.bind(this);#r=new Map;#h=!1;#o=!1;#n;static _initialized=!1;constructor(s){L._initialized||(L._initialized=!0,O.FreeTextEditor.initialize(s.l10n),R.InkEditor.initialize(s.l10n),s.uiManager.registerEditorTypes([O.FreeTextEditor,R.InkEditor])),this.#n=s.uiManager,this.annotationStorage=s.annotationStorage,this.pageIndex=s.pageIndex,this.div=s.div,this.#t=s.accessibilityManager,this.#n.addLayer(this)}updateToolbar(s){this.#n.updateToolbar(s)}updateMode(s=this.#n.getMode()){this.#a(),s===d.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#n.unselectAll()}addInkEditorIfNeeded(s){if(!s&&this.#n.getMode()!==d.AnnotationEditorType.INK)return;if(!s){for(const u of this.#r.values())if(u.isEmpty()){u.setInBackground();return}}this.#c({offsetX:0,offsetY:0}).setInBackground()}setEditingState(s){this.#n.setEditingState(s)}addCommands(s){this.#n.addCommands(s)}enable(){this.div.style.pointerEvents="auto";for(const s of this.#r.values())s.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const s of this.#r.values())s.disableEditing()}setActiveEditor(s){this.#n.getActive()!==s&&this.#n.setActiveEditor(s)}enableClick(){this.div.addEventListener("pointerdown",this.#s),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#s),this.div.removeEventListener("pointerup",this.#i)}attach(s){this.#r.set(s.id,s)}detach(s){this.#r.delete(s.id),this.#t?.removePointerInTextLayer(s.contentDiv)}remove(s){this.#n.removeEditor(s),this.detach(s),this.annotationStorage.remove(s.id),s.div.style.display="none",setTimeout(()=>{s.div.style.display="",s.div.remove(),s.isAttachedToDOM=!1,document.activeElement===document.body&&this.#n.focusMainContainer()},0),this.#o||this.addInkEditorIfNeeded(!1)}#u(s){s.parent!==this&&(this.attach(s),s.pageIndex=this.pageIndex,s.parent?.detach(s),s.parent=this,s.div&&s.isAttachedToDOM&&(s.div.remove(),this.div.append(s.div)))}add(s){if(this.#u(s),this.#n.addEditor(s),this.attach(s),!s.isAttachedToDOM){const a=s.render();this.div.append(a),s.isAttachedToDOM=!0}this.moveEditorInDOM(s),s.onceAdded(),this.addToAnnotationStorage(s)}moveEditorInDOM(s){this.#t?.moveElementInDOM(this.div,s.div,s.contentDiv,!0)}addToAnnotationStorage(s){!s.isEmpty()&&!this.annotationStorage.has(s.id)&&this.annotationStorage.setValue(s.id,s)}addOrRebuild(s){s.needsToBeRebuilt()?s.rebuild():this.add(s)}addANewEditor(s){const a=()=>{this.addOrRebuild(s)},u=()=>{s.remove()};this.addCommands({cmd:a,undo:u,mustExec:!0})}addUndoableEditor(s){const a=()=>{this.addOrRebuild(s)},u=()=>{s.remove()};this.addCommands({cmd:a,undo:u,mustExec:!1})}getNextId(){return this.#n.getId()}#l(s){switch(this.#n.getMode()){case d.AnnotationEditorType.FREETEXT:return new O.FreeTextEditor(s);case d.AnnotationEditorType.INK:return new R.InkEditor(s)}return null}deserialize(s){switch(s.annotationType){case d.AnnotationEditorType.FREETEXT:return O.FreeTextEditor.deserialize(s,this);case d.AnnotationEditorType.INK:return R.InkEditor.deserialize(s,this)}return null}#c(s){const a=this.getNextId(),u=this.#l({parent:this,id:a,x:s.offsetX,y:s.offsetY});return u&&this.add(u),u}setSelected(s){this.#n.setSelected(s)}toggleSelected(s){this.#n.toggleSelected(s)}isSelected(s){return this.#n.isSelected(s)}unselect(s){this.#n.unselect(s)}pointerup(s){const a=n.KeyboardManager.platform.isMac;if(!(s.button!==0||s.ctrlKey&&a)&&s.target===this.div&&this.#h){if(this.#h=!1,!this.#e){this.#e=!0;return}this.#c(s)}}pointerdown(s){const a=n.KeyboardManager.platform.isMac;if(s.button!==0||s.ctrlKey&&a||s.target!==this.div)return;this.#h=!0;const u=this.#n.getActive();this.#e=!u||u.isEmpty()}drop(s){const a=s.dataTransfer.getData("text/plain"),u=this.#n.getEditor(a);if(!u)return;s.preventDefault(),s.dataTransfer.dropEffect="move",this.#u(u);const p=this.div.getBoundingClientRect(),A=s.clientX-p.x,o=s.clientY-p.y;u.translate(A-u.startX,o-u.startY),this.moveEditorInDOM(u),u.div.focus()}dragover(s){s.preventDefault()}destroy(){this.#n.getActive()?.parent===this&&this.#n.setActiveEditor(null);for(const s of this.#r.values())this.#t?.removePointerInTextLayer(s.contentDiv),s.isAttachedToDOM=!1,s.div.remove(),s.parent=null;this.div=null,this.#r.clear(),this.#n.removeLayer(this)}#a(){this.#o=!0;for(const s of this.#r.values())s.isEmpty()&&s.remove();this.#o=!1}render(s){this.viewport=s.viewport,(0,n.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const a of this.#n.getEditors(this.pageIndex))this.add(a);this.updateMode()}update(s){this.viewport=s.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[s,a,u,p]=this.viewport.viewBox,A=u-s,o=p-a;return[A,o]}get viewportBaseDimensions(){const{width:s,height:a,rotation:u}=this.viewport;return u%180===0?[s,a]:[a,s]}setDimensions(){const{width:s,height:a,rotation:u}=this.viewport,p=u%180!==0,A=Math.floor(s)+"px",o=Math.floor(a)+"px";this.div.style.width=p?o:A,this.div.style.height=p?A:o,this.div.setAttribute("data-main-rotation",u)}}e.AnnotationEditorLayer=L},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=E(1),d=E(7),O=E(6);class R extends O.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivKeydown.bind(this);#s;#r="";#h=!1;#o;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new d.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],R.prototype.commitOrRemove]]);static _type="freetext";constructor(_){super({..._,name:"freeTextEditor"}),this.#s=_.color||R._defaultColor||O.AnnotationEditor._defaultLineColor,this.#o=_.fontSize||R._defaultFontSize}static initialize(_){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(a=>[a,_.get(a)]));const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(_,s){switch(_){case n.AnnotationEditorParamsType.FREETEXT_SIZE:R._defaultFontSize=s;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:R._defaultColor=s;break}}updateParams(_,s){switch(_){case n.AnnotationEditorParamsType.FREETEXT_SIZE:this.#n(s);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:this.#u(s);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,R._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,R._defaultColor||O.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,this.#o],[n.AnnotationEditorParamsType.FREETEXT_COLOR,this.#s]]}#n(_){const s=u=>{this.editorDiv.style.fontSize=`calc(${u}px * var(--scale-factor))`,this.translate(0,-(u-this.#o)*this.parent.scaleFactor),this.#o=u,this.#c()},a=this.#o;this.parent.addCommands({cmd:()=>{s(_)},undo:()=>{s(a)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#u(_){const s=this.#s;this.parent.addCommands({cmd:()=>{this.#s=_,this.editorDiv.style.color=_},undo:()=>{this.#s=s,this.editorDiv.style.color=s},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){return[-R._internalPadding*this.parent.scaleFactor,-(R._internalPadding+this.#o)*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.div.focus(),this.isEditing=!1)}focusin(_){super.focusin(_),_.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}#l(){const _=this.editorDiv.getElementsByTagName("div");if(_.length===0)return this.editorDiv.innerText;const s=[];for(let a=0,u=_.length;a<u;a++){const A=_[a].firstChild;A?.nodeName==="#text"?s.push(A.data):s.push("")}return s.join(`
`)}#c(){const[_,s]=this.parent.viewportBaseDimensions,a=this.div.getBoundingClientRect();this.width=a.width/_,this.height=a.height/s}commit(){super.commit(),this.#h||(this.#h=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#r=this.#l().trimEnd(),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(_){this.enableEditMode(),this.editorDiv.focus()}keydown(_){_.target===this.div&&_.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(_){R._keyboardManager.exec(this,_)}editorDivFocus(_){this.isEditing=!0}editorDivBlur(_){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let _,s;this.width&&(_=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),R._l10nPromise.get("editor_free_text_aria_label").then(u=>this.editorDiv?.setAttribute("aria-label",u)),R._l10nPromise.get("free_text_default_content").then(u=>this.editorDiv?.setAttribute("default-content",u)),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${this.#o}px * var(--scale-factor))`,a.color=this.#s,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,d.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[u,p]=this.parent.viewportBaseDimensions;this.setAt(_*u,s*p,this.width*u,this.height*p);for(const A of this.#r.split(`
`)){const o=document.createElement("div");o.append(A?document.createTextNode(A):document.createElement("br")),this.editorDiv.append(o)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(_,s){const a=super.deserialize(_,s);return a.#o=_.fontSize,a.#s=n.Util.makeHexColor(..._.color),a.#r=_.value,a}serialize(){if(this.isEmpty())return null;const _=R._internalPadding*this.parent.scaleFactor,s=this.getRect(_,_),a=O.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:n.AnnotationEditorType.FREETEXT,color:a,fontSize:this.#o,value:this.#r,pageIndex:this.parent.pageIndex,rect:s,rotation:this.rotation}}}e.FreeTextEditor=R},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,Object.defineProperty(e,"fitCurve",{enumerable:!0,get:function(){return O.fitCurve}});var n=E(1),d=E(6),O=E(25),R=E(7);const L=16;class _ extends d.AnnotationEditor{#t=0;#e=0;#i=0;#s=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#h=this.canvasPointerup.bind(this);#o=this.canvasPointerdown.bind(this);#n=!1;#u=!1;#l=null;#c=null;#a=0;#m=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(a){super({...a,name:"inkEditor"}),this.color=a.color||null,this.thickness=a.thickness||null,this.opacity=a.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(a){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(u=>[u,a.get(u)]))}static updateDefaultParams(a,u){switch(a){case n.AnnotationEditorParamsType.INK_THICKNESS:_._defaultThickness=u;break;case n.AnnotationEditorParamsType.INK_COLOR:_._defaultColor=u;break;case n.AnnotationEditorParamsType.INK_OPACITY:_._defaultOpacity=u/100;break}}updateParams(a,u){switch(a){case n.AnnotationEditorParamsType.INK_THICKNESS:this.#C(u);break;case n.AnnotationEditorParamsType.INK_COLOR:this.#T(u);break;case n.AnnotationEditorParamsType.INK_OPACITY:this.#b(u);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,_._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,_._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(_._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||_._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||_._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??_._defaultOpacity))]]}#C(a){const u=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=a,this.#E()},undo:()=>{this.thickness=u,this.#E()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#T(a){const u=this.color;this.parent.addCommands({cmd:()=>{this.color=a,this.#f()},undo:()=>{this.color=u,this.#f()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#b(a){a/=100;const u=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=a,this.#f()},undo:()=>{this.opacity=u,this.#f()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#g(),this.#_()),this.isAttachedToDOM||(this.parent.add(this),this.#S()),this.#E())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#c.disconnect(),this.#c=null,super.remove())}enableEditMode(){this.#n||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#o),this.canvas.addEventListener("pointerup",this.#h))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#o),this.canvas.removeEventListener("pointerup",this.#h))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#x(){const{width:a,height:u,rotation:p}=this.parent.viewport;switch(p){case 90:return[0,a,a,u];case 180:return[a,u,a,u];case 270:return[u,0,a,u];default:return[0,0,a,u]}}#y(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,R.opacityToHex)(this.opacity)}`}#d(a,u){this.isEditing=!0,this.#u||(this.#u=!0,this.#S(),this.thickness||=_._defaultThickness,this.color||=_._defaultColor||d.AnnotationEditor._defaultLineColor,this.opacity??=_._defaultOpacity),this.currentPath.push([a,u]),this.#l=null,this.#y(),this.ctx.beginPath(),this.ctx.moveTo(a,u),this.#p=()=>{this.#p&&(this.#l&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#f(),this.ctx.lineTo(...this.#l),this.#l=null,this.ctx.stroke()),window.requestAnimationFrame(this.#p))},window.requestAnimationFrame(this.#p)}#A(a,u){const[p,A]=this.currentPath.at(-1);a===p&&u===A||(this.currentPath.push([a,u]),this.#l=[a,u])}#P(a,u){this.ctx.closePath(),this.#p=null,a=Math.min(Math.max(a,0),this.canvas.width),u=Math.min(Math.max(u,0),this.canvas.height);const[p,A]=this.currentPath.at(-1);(a!==p||u!==A)&&this.currentPath.push([a,u]);let o;if(this.currentPath.length!==1)o=(0,O.fitCurve)(this.currentPath,30,null);else{const k=[a,u];o=[[k,k.slice(),k.slice(),k]]}const g=_.#F(o);this.currentPath.length=0;const b=()=>{this.paths.push(o),this.bezierPath2D.push(g),this.rebuild()},D=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#g(),this.#_()),this.#E())};this.parent.addCommands({cmd:b,undo:D,mustExec:!0})}#f(){if(this.isEmpty()){this.#w();return}this.#y();const{canvas:a,ctx:u}=this;u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,a.width,a.height),this.#w();for(const p of this.bezierPath2D)u.stroke(p)}commit(){this.#n||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#n=!0,this.div.classList.add("disabled"),this.#E(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(a){super.focusin(a),this.enableEditMode()}canvasPointerdown(a){a.button!==0||!this.isInEditMode()||this.#n||(this.setInForeground(),a.type!=="mouse"&&this.div.focus(),a.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#s),this.#d(a.offsetX,a.offsetY))}canvasPointermove(a){a.stopPropagation(),this.#A(a.offsetX,a.offsetY)}canvasPointerup(a){a.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(a.stopPropagation(),this.#v(a),this.setInBackground())}canvasPointerleave(a){this.#v(a),this.setInBackground()}#v(a){this.#P(a.offsetX,a.offsetY),this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#s),this.parent.addToAnnotationStorage(this)}#g(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",_._l10nPromise.get("editor_ink_canvas_aria_label").then(a=>this.canvas?.setAttribute("aria-label",a)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#_(){this.#c=new ResizeObserver(a=>{const u=a[0].contentRect;u.width&&u.height&&this.setDimensions(u.width,u.height)}),this.#c.observe(this.div)}render(){if(this.div)return this.div;let a,u;this.width&&(a=this.x,u=this.y),super.render(),_._l10nPromise.get("editor_ink_aria_label").then(b=>this.div?.setAttribute("aria-label",b));const[p,A,o,g]=this.#x();if(this.setAt(p,A,0,0),this.setDims(o,g),this.#g(),this.width){const[b,D]=this.parent.viewportBaseDimensions;this.setAt(a*b,u*D,this.width*b,this.height*D),this.#u=!0,this.#S(),this.setDims(this.width*b,this.height*D),this.#f(),this.#O(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#_(),this.div}#S(){if(!this.#u)return;const[a,u]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*a),this.canvas.height=Math.ceil(this.height*u),this.#w()}setDimensions(a,u){const p=Math.round(a),A=Math.round(u);if(this.#a===p&&this.#m===A)return;this.#a=p,this.#m=A,this.canvas.style.visibility="hidden",this.#t&&Math.abs(this.#t-a/u)>.01&&(u=Math.ceil(a/this.#t),this.setDims(a,u));const[o,g]=this.parent.viewportBaseDimensions;this.width=a/o,this.height=u/g,this.#n&&this.#R(a,u),this.#S(),this.#f(),this.canvas.style.visibility="visible"}#R(a,u){const p=this.#k(),A=(a-p)/this.#i,o=(u-p)/this.#e;this.scaleFactor=Math.min(A,o)}#w(){const a=this.#k()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+a,this.translationY*this.scaleFactor+a)}static#F(a){const u=new Path2D;for(let p=0,A=a.length;p<A;p++){const[o,g,b,D]=a[p];p===0&&u.moveTo(...o),u.bezierCurveTo(g[0],g[1],b[0],b[1],D[0],D[1])}return u}#D(a,u,p,A){const g=[],b=this.thickness/2;let D,k;for(const M of this.paths){D=[],k=[];for(let m=0,r=M.length;m<r;m++){const[l,y,w,P]=M[m],j=a*(l[0]+u)+b,N=A-a*(l[1]+p)-b,tt=a*(y[0]+u)+b,Z=A-a*(y[1]+p)-b,B=a*(w[0]+u)+b,U=A-a*(w[1]+p)-b,q=a*(P[0]+u)+b,Y=A-a*(P[1]+p)-b;m===0&&(D.push(j,N),k.push(j,N)),D.push(tt,Z,B,U,q,Y),this.#I(j,N,tt,Z,B,U,q,Y,4,k)}g.push({bezier:D,points:k})}return g}#I(a,u,p,A,o,g,b,D,k,M){if(this.#L(a,u,p,A,o,g,b,D)){M.push(b,D);return}for(let m=1;m<k-1;m++){const r=m/k,l=1-r;let y=r*a+l*p,w=r*u+l*A,P=r*p+l*o,j=r*A+l*g;const N=r*o+l*b,tt=r*g+l*D;y=r*y+l*P,w=r*w+l*j,P=r*P+l*N,j=r*j+l*tt,y=r*y+l*P,w=r*w+l*j,M.push(y,w)}M.push(b,D)}#L(a,u,p,A,o,g,b,D){const M=(3*p-2*a-b)**2,m=(3*A-2*u-D)**2,r=(3*o-a-2*b)**2,l=(3*g-u-2*D)**2;return Math.max(M,r)+Math.max(m,l)<=10}#M(){let a=1/0,u=-1/0,p=1/0,A=-1/0;for(const o of this.paths)for(const[g,b,D,k]of o){const M=n.Util.bezierBoundingBox(...g,...b,...D,...k);a=Math.min(a,M[0]),p=Math.min(p,M[1]),u=Math.max(u,M[2]),A=Math.max(A,M[3])}return[a,p,u,A]}#k(){return this.#n?Math.ceil(this.thickness*this.parent.scaleFactor):0}#E(a=!1){if(this.isEmpty())return;if(!this.#n){this.#f();return}const u=this.#M(),p=this.#k();this.#i=Math.max(L,u[2]-u[0]),this.#e=Math.max(L,u[3]-u[1]);const A=Math.ceil(p+this.#i*this.scaleFactor),o=Math.ceil(p+this.#e*this.scaleFactor),[g,b]=this.parent.viewportBaseDimensions;this.width=A/g,this.height=o/b,this.#t=A/o,this.#O();const D=this.translationX,k=this.translationY;this.translationX=-u[0],this.translationY=-u[1],this.#S(),this.#f(),this.#a=A,this.#m=o,this.setDims(A,o);const M=a?p/this.scaleFactor/2:0;this.translate(D-this.translationX-M,k-this.translationY-M)}#O(){const{style:a}=this.div;this.#t>=1?(a.minHeight=`${L}px`,a.minWidth=`${Math.round(this.#t*L)}px`):(a.minWidth=`${L}px`,a.minHeight=`${Math.round(L/this.#t)}px`)}static deserialize(a,u){const p=super.deserialize(a,u);p.thickness=a.thickness,p.color=n.Util.makeHexColor(...a.color),p.opacity=a.opacity;const[A,o]=u.pageDimensions,g=p.width*A,b=p.height*o,D=u.scaleFactor,k=a.thickness/2;p.#t=g/b,p.#n=!0,p.#a=Math.round(g),p.#m=Math.round(b);for(const{bezier:m}of a.paths){const r=[];p.paths.push(r);let l=D*(m[0]-k),y=D*(b-m[1]-k);for(let P=2,j=m.length;P<j;P+=6){const N=D*(m[P]-k),tt=D*(b-m[P+1]-k),Z=D*(m[P+2]-k),B=D*(b-m[P+3]-k),U=D*(m[P+4]-k),q=D*(b-m[P+5]-k);r.push([[l,y],[N,tt],[Z,B],[U,q]]),l=U,y=q}const w=this.#F(r);p.bezierPath2D.push(w)}const M=p.#M();return p.#i=Math.max(L,M[2]-M[0]),p.#e=Math.max(L,M[3]-M[1]),p.#R(g,b),p}serialize(){if(this.isEmpty())return null;const a=this.getRect(0,0),u=this.rotation%180===0?a[3]-a[1]:a[2]-a[0],p=d.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:p,thickness:this.thickness,opacity:this.opacity,paths:this.#D(this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,u),pageIndex:this.parent.pageIndex,rect:a,rotation:this.rotation}}}e.InkEditor=_},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fitCurve=void 0;const n=E(26);e.fitCurve=n},$=>{function e(o,g,b){if(!Array.isArray(o))throw new TypeError("First argument should be an array");if(o.forEach(m=>{if(!Array.isArray(m)||m.some(r=>typeof r!="number")||m.length!==o[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),o=o.filter((m,r)=>r===0||!m.every((l,y)=>l===o[r-1][y])),o.length<2)return[];const D=o.length,k=u(o[1],o[0]),M=u(o[D-2],o[D-1]);return E(o,k,M,g,b)}function E(o,g,b,D,k){var m,r,l,y,w,P,j,N,tt,Z,B,U,q;if(o.length===2)return U=p.vectorLen(p.subtract(o[0],o[1]))/3,m=[o[0],p.addArrays(o[0],p.mulItems(g,U)),p.addArrays(o[1],p.mulItems(b,U)),o[1]],[m];if(r=L(o),[m,y,P]=n(o,r,r,g,b,k),y===0||y<D)return[m];if(y<D*D)for(l=r,w=y,j=P,q=0;q<20;q++){if(l=O(m,o,l),[m,y,P]=n(o,r,l,g,b,k),y<D)return[m];if(P===j){let Y=y/w;if(Y>.9999&&Y<1.0001)break}w=y,j=P}return B=[],N=p.subtract(o[P-1],o[P+1]),N.every(Y=>Y===0)&&(N=p.subtract(o[P-1],o[P]),[N[0],N[1]]=[-N[1],N[0]]),tt=p.normalize(N),Z=p.mulItems(tt,-1),B=B.concat(E(o.slice(0,P+1),g,tt,D,k)),B=B.concat(E(o.slice(P),Z,b,D,k)),B}function n(o,g,b,D,k,M){var m,r,l;return m=d(o,b,D,k),[r,l]=_(o,m,g),M&&M({bez:m,points:o,params:g,maxErr:r,maxPoint:l}),[m,r,l]}function d(o,g,b,D){var k,M,m,r,l,y,w,P,j,N,tt,Z,B,U,q,Y,z,x=o[0],h=o[o.length-1];for(k=[x,null,null,h],M=p.zeros_Xx2x2(g.length),B=0,U=g.length;B<U;B++)Y=g[B],z=1-Y,m=M[B],m[0]=p.mulItems(b,3*Y*(z*z)),m[1]=p.mulItems(D,3*z*(Y*Y));for(r=[[0,0],[0,0]],l=[0,0],B=0,U=o.length;B<U;B++)Y=g[B],m=M[B],r[0][0]+=p.dot(m[0],m[0]),r[0][1]+=p.dot(m[0],m[1]),r[1][0]+=p.dot(m[0],m[1]),r[1][1]+=p.dot(m[1],m[1]),q=p.subtract(o[B],A.q([x,x,h,h],Y)),l[0]+=p.dot(m[0],q),l[1]+=p.dot(m[1],q);return y=r[0][0]*r[1][1]-r[1][0]*r[0][1],w=r[0][0]*l[1]-r[1][0]*l[0],P=l[0]*r[1][1]-l[1]*r[0][1],j=y===0?0:P/y,N=y===0?0:w/y,Z=p.vectorLen(p.subtract(x,h)),tt=1e-6*Z,j<tt||N<tt?(k[1]=p.addArrays(x,p.mulItems(b,Z/3)),k[2]=p.addArrays(h,p.mulItems(D,Z/3))):(k[1]=p.addArrays(x,p.mulItems(b,j)),k[2]=p.addArrays(h,p.mulItems(D,N))),k}function O(o,g,b){return b.map((D,k)=>R(o,g[k],D))}function R(o,g,b){var D=p.subtract(A.q(o,b),g),k=A.qprime(o,b),M=p.mulMatrix(D,k),m=p.sum(p.squareItems(k))+2*p.mulMatrix(D,A.qprimeprime(o,b));return m===0?b:b-M/m}function L(o){var g=[],b,D,k;return o.forEach((M,m)=>{b=m?D+p.vectorLen(p.subtract(M,k)):0,g.push(b),D=b,k=M}),g=g.map(M=>M/D),g}function _(o,g,b){var D,k,M,m,r,l,y,w;k=0,M=Math.floor(o.length/2);const P=s(g,10);for(r=0,l=o.length;r<l;r++)y=o[r],w=a(g,b[r],P,10),m=p.subtract(A.q(g,w),y),D=m[0]*m[0]+m[1]*m[1],D>k&&(k=D,M=r);return[k,M]}var s=function(o,g){for(var b,D=[0],k=o[0],M=0,m=1;m<=g;m++)b=A.q(o,m/g),M+=p.vectorLen(p.subtract(b,k)),D.push(M),k=b;return D=D.map(r=>r/M),D};function a(o,g,b,D){if(g<0)return 0;if(g>1)return 1;for(var k,M,m,r,l,y=1;y<=D;y++)if(g<=b[y]){r=(y-1)/D,m=y/D,M=b[y-1],k=b[y],l=(g-M)/(k-M)*(m-r)+r;break}return l}function u(o,g){return p.normalize(p.subtract(o,g))}class p{static zeros_Xx2x2(g){for(var b=[];g--;)b.push([0,0]);return b}static mulItems(g,b){return g.map(D=>D*b)}static mulMatrix(g,b){return g.reduce((D,k,M)=>D+k*b[M],0)}static subtract(g,b){return g.map((D,k)=>D-b[k])}static addArrays(g,b){return g.map((D,k)=>D+b[k])}static addItems(g,b){return g.map(D=>D+b)}static sum(g){return g.reduce((b,D)=>b+D)}static dot(g,b){return p.mulMatrix(g,b)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,b){return g.map(D=>D/b)}static squareItems(g){return g.map(b=>b*b)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class A{static q(g,b){var D=1-b,k=p.mulItems(g[0],D*D*D),M=p.mulItems(g[1],3*D*D*b),m=p.mulItems(g[2],3*D*b*b),r=p.mulItems(g[3],b*b*b);return p.addArrays(p.addArrays(k,M),p.addArrays(m,r))}static qprime(g,b){var D=1-b,k=p.mulItems(p.subtract(g[1],g[0]),3*D*D),M=p.mulItems(p.subtract(g[2],g[1]),6*D*b),m=p.mulItems(p.subtract(g[3],g[2]),3*b*b);return p.addArrays(p.addArrays(k,M),m)}static qprimeprime(g,b){return p.addArrays(p.mulItems(p.addArrays(p.subtract(g[2],p.mulItems(g[1],2)),g[0]),6*(1-b)),p.mulItems(p.addArrays(p.subtract(g[3],p.mulItems(g[2],2)),g[1]),6*b))}}$.exports=e,$.exports.fitCubic=E,$.exports.createTangent=u},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationLayer=void 0;var n=E(1),d=E(8),O=E(5),R=E(28),L=E(29);const _=1e3,s=9,a=new WeakSet;function u(T){return{width:T[2]-T[0],height:T[3]-T[1]}}class p{static create(t){switch(t.data.annotationType){case n.AnnotationType.LINK:return new o(t);case n.AnnotationType.TEXT:return new g(t);case n.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new D(t);case"Btn":return t.data.radioButton?new M(t):t.data.checkBox?new k(t):new m(t);case"Ch":return new r(t)}return new b(t);case n.AnnotationType.POPUP:return new l(t);case n.AnnotationType.FREETEXT:return new w(t);case n.AnnotationType.LINE:return new P(t);case n.AnnotationType.SQUARE:return new j(t);case n.AnnotationType.CIRCLE:return new N(t);case n.AnnotationType.POLYLINE:return new tt(t);case n.AnnotationType.CARET:return new B(t);case n.AnnotationType.INK:return new U(t);case n.AnnotationType.POLYGON:return new Z(t);case n.AnnotationType.HIGHLIGHT:return new q(t);case n.AnnotationType.UNDERLINE:return new Y(t);case n.AnnotationType.SQUIGGLY:return new z(t);case n.AnnotationType.STRIKEOUT:return new x(t);case n.AnnotationType.STAMP:return new h(t);case n.AnnotationType.FILEATTACHMENT:return new c(t);default:return new A(t)}}}class A{constructor(t,{isRenderable:i=!1,ignoreBorder:f=!1,createQuadrilaterals:v=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,i&&(this.container=this._createContainer(f)),v&&(this.quadrilaterals=this._createQuadrilaterals(f))}_createContainer(t=!1){const i=this.data,f=this.page,v=this.viewport,C=document.createElement("section"),{width:F,height:I}=u(i.rect),[W,V,H,K]=v.viewBox,et=H-W,J=K-V;C.setAttribute("data-annotation-id",i.id);const nt=n.Util.normalizeRect([i.rect[0],f.view[3]-i.rect[1]+f.view[1],i.rect[2],f.view[3]-i.rect[3]+f.view[1]]);if(!t&&i.borderStyle.width>0){C.style.borderWidth=`${i.borderStyle.width}px`;const at=i.borderStyle.horizontalCornerRadius,ot=i.borderStyle.verticalCornerRadius;if(at>0||ot>0){const ft=`calc(${at}px * var(--scale-factor)) / calc(${ot}px * var(--scale-factor))`;C.style.borderRadius=ft}else if(this instanceof M){const ft=`calc(${F}px * var(--scale-factor)) / calc(${I}px * var(--scale-factor))`;C.style.borderRadius=ft}switch(i.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:C.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:C.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:C.style.borderBottomStyle="solid";break}const st=i.borderColor||null;st?C.style.borderColor=n.Util.makeHexColor(st[0]|0,st[1]|0,st[2]|0):C.style.borderWidth=0}C.style.left=`${100*(nt[0]-W)/et}%`,C.style.top=`${100*(nt[1]-V)/J}%`;const{rotation:it}=i;return i.hasOwnCanvas||it===0?(C.style.width=`${100*F/et}%`,C.style.height=`${100*I/J}%`):this.setRotation(it,C),C}setRotation(t,i=this.container){const[f,v,C,F]=this.viewport.viewBox,I=C-f,W=F-v,{width:V,height:H}=u(this.data.rect);let K,et;t%180===0?(K=100*V/I,et=100*H/W):(K=100*H/I,et=100*V/W),i.style.width=`${K}%`,i.style.height=`${et}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,f,v)=>{const C=v.detail[i];v.target.style[f]=R.ColorConverters[`${C[0]}_HTML`](C.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:i=>{const f=i.detail.display%2===1;this.container.style.visibility=f?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:f,print:i.detail.display===0||i.detail.display===3})},print:i=>{this.annotationStorage.setValue(this.data.id,{print:i.detail.print})},hidden:i=>{this.container.style.visibility=i.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:i.detail.hidden})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.detail.readonly?i.target.setAttribute("readonly",""):i.target.removeAttribute("readonly")},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const f=i.detail.rotation;this.setRotation(f),this.annotationStorage.setValue(this.data.id,{rotation:f})}})}_dispatchEventFromSandbox(t,i){const f=this._commonActions;for(const v of Object.keys(i.detail)){const C=t[v]||f[v];C&&C(i)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const f=this._commonActions;for(const[v,C]of Object.entries(i)){const F=f[v];if(F){const I={detail:{[v]:C},target:t};F(I),delete i[v]}}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const i=[],f=this.data.rect;for(const v of this.data.quadPoints)this.data.rect=[v[2].x,v[2].y,v[1].x,v[1].y],i.push(this._createContainer(t));return this.data.rect=f,i}_createPopup(t,i){let f=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,f=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.className="popupTriggerArea",f.append(t));const C=new y({container:f,trigger:t,color:i.color,titleObj:i.titleObj,modificationDate:i.modificationDate,contentsObj:i.contentsObj,richText:i.richText,hideWrapper:!0}).render();C.style.left="100%",f.append(C)}_renderQuadrilaterals(t){for(const i of this.quadrilaterals)i.className=t;return this.quadrilaterals}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const f=[];if(this._fieldObjects){const v=this._fieldObjects[t];if(v)for(const{page:C,id:F,exportValues:I}of v){if(C===-1||F===i)continue;const W=typeof I=="string"?I:null,V=document.querySelector(`[data-element-id="${F}"]`);if(V&&!a.has(V)){(0,n.warn)(`_getElementsByName - element not allowed: ${F}`);continue}f.push({id:F,exportValue:W,domElement:V})}return f}for(const v of document.getElementsByName(t)){const{id:C,exportValue:F}=v;C!==i&&a.has(v)&&f.push({id:C,exportValue:F,domElement:v})}return f}static get platform(){const t=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class o extends A{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,f=document.createElement("a");f.setAttribute("data-element-id",t.id);let v=!1;return t.url?(i.addLinkAttributes(f,t.url,t.newWindow),v=!0):t.action?(this._bindNamedAction(f,t.action),v=!0):t.dest?(this._bindLink(f,t.dest),v=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(f,t),v=!0),t.resetForm?(this._bindResetFormAction(f,t.resetForm),v=!0):this.isTooltipOnly&&!v&&(this._bindLink(f,""),v=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((C,F)=>{const I=F===0?f:f.cloneNode();return C.append(I),C}):(this.container.className="linkAnnotation",v&&this.container.append(f),this.container)}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&(t.className="internalLink")}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),t.className="internalLink"}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const f=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const v of Object.keys(i.actions)){const C=f.get(v);C&&(t[C]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:v}}),!1))}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,i){const f=t.onclick;if(f||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),f||(t.onclick=()=>!1);return}t.onclick=()=>{f&&f();const{fields:v,refs:C,include:F}=i,I=[];if(v.length!==0||C.length!==0){const H=new Set(C);for(const K of v){const et=this._fieldObjects[K]||[];for(const{id:J}of et)H.add(J)}for(const K of Object.values(this._fieldObjects))for(const et of K)H.has(et.id)===F&&I.push(et)}else for(const H of Object.values(this._fieldObjects))I.push(...H);const W=this.annotationStorage,V=[];for(const H of I){const{id:K}=H;switch(V.push(K),H.type){case"text":{const J=H.defaultValue||"";W.setValue(K,{value:J});break}case"checkbox":case"radiobutton":{const J=H.defaultValue===H.exportValues;W.setValue(K,{value:J});break}case"combobox":case"listbox":{const J=H.defaultValue||"";W.setValue(K,{value:J});break}default:continue}const et=document.querySelector(`[data-element-id="${K}"]`);if(et){if(!a.has(et)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${K}`);continue}}else continue;et.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:V,name:"ResetForm"}}),!1}}}class g extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.append(t),this.container}}class b extends A{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:i,isMac:f}=A.platform;return i&&t.ctrlKey||f&&t.metaKey}_setEventListener(t,i,f,v){i.includes("mouse")?t.addEventListener(i,C=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:f,value:v(C),shift:C.shiftKey,modifier:this._getKeyModifier(C)}})}):t.addEventListener(i,C=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:f,value:v(C)}})})}_setEventListeners(t,i,f){for(const[v,C]of i)(C==="Action"||this.data.actions?.[C])&&this._setEventListener(t,v,C,f)}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":n.Util.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:f}=this.data.defaultAppearanceData,v=this.data.defaultAppearanceData.fontSize||s,C=t.style;let F;if(this.data.multiLine){const I=Math.abs(this.data.rect[3]-this.data.rect[1]),W=Math.round(I/(n.LINE_FACTOR*v))||1,V=I/W;F=Math.min(v,Math.round(V/n.LINE_FACTOR))}else{const I=Math.abs(this.data.rect[3]-this.data.rect[1]);F=Math.min(v,Math.round(I/n.LINE_FACTOR))}C.fontSize=`calc(${F}px * var(--scale-factor))`,C.color=n.Util.makeHexColor(f[0],f[1],f[2]),this.data.textAlignment!==null&&(C.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class D extends b{constructor(t){const i=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,f,v){const C=this.annotationStorage;for(const F of this._getElementsByName(t.name,t.id))F.domElement&&(F.domElement[i]=f),C.setValue(F.id,{[v]:f})}render(){const t=this.annotationStorage,i=this.data.id;this.container.className="textWidgetAnnotation";let f=null;if(this.renderForms){const v=t.getValue(i,{value:this.data.fieldValue});let C=v.formattedValue||v.value||"";const F=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;F&&C.length>F&&(C=C.slice(0,F));const I={userValue:C,formattedValue:null,valueOnFocus:""};this.data.multiLine?(f=document.createElement("textarea"),f.textContent=C,this.data.doNotScroll&&(f.style.overflowY="hidden")):(f=document.createElement("input"),f.type="text",f.setAttribute("value",C),this.data.doNotScroll&&(f.style.overflowX="hidden")),a.add(f),f.setAttribute("data-element-id",i),f.disabled=this.data.readOnly,f.name=this.data.fieldName,f.tabIndex=_,this._setRequired(f,this.data.required),F&&(f.maxLength=F),f.addEventListener("input",V=>{t.setValue(i,{value:V.target.value}),this.setPropertyOnSiblings(f,"value",V.target.value,"value")}),f.addEventListener("resetform",V=>{const H=this.data.defaultFieldValue??"";f.value=I.userValue=H,I.formattedValue=null});let W=V=>{const{formattedValue:H}=I;H!=null&&(V.target.value=H),V.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){f.addEventListener("focus",H=>{I.userValue&&(H.target.value=I.userValue),I.valueOnFocus=H.target.value}),f.addEventListener("updatefromsandbox",H=>{const K={value(et){I.userValue=et.detail.value??"",t.setValue(i,{value:I.userValue.toString()}),et.target.value=I.userValue},formattedValue(et){const{formattedValue:J}=et.detail;I.formattedValue=J,J!=null&&et.target!==document.activeElement&&(et.target.value=J),t.setValue(i,{formattedValue:J})},selRange(et){et.target.setSelectionRange(...et.detail.selRange)},charLimit:et=>{const{charLimit:J}=et.detail,{target:nt}=et;if(J===0){nt.removeAttribute("maxLength");return}nt.setAttribute("maxLength",J);let it=I.userValue;!it||it.length<=J||(it=it.slice(0,J),nt.value=I.userValue=it,t.setValue(i,{value:it}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:it,willCommit:!0,commitKey:1,selStart:nt.selectionStart,selEnd:nt.selectionEnd}}))}};this._dispatchEventFromSandbox(K,H)}),f.addEventListener("keydown",H=>{let K=-1;if(H.key==="Escape"?K=0:H.key==="Enter"?K=2:H.key==="Tab"&&(K=3),K===-1)return;const{value:et}=H.target;I.valueOnFocus!==et&&(I.userValue=et,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:et,willCommit:!0,commitKey:K,selStart:H.target.selectionStart,selEnd:H.target.selectionEnd}}))});const V=W;W=null,f.addEventListener("blur",H=>{const{value:K}=H.target;I.userValue=K,this._mouseState.isDown&&I.valueOnFocus!==K&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:K,willCommit:!0,commitKey:1,selStart:H.target.selectionStart,selEnd:H.target.selectionEnd}}),V(H)}),this.data.actions?.Keystroke&&f.addEventListener("beforeinput",H=>{const{data:K,target:et}=H,{value:J,selectionStart:nt,selectionEnd:it}=et;let at=nt,ot=it;switch(H.inputType){case"deleteWordBackward":{const st=J.substring(0,nt).match(/\w*[^\w]*$/);st&&(at-=st[0].length);break}case"deleteWordForward":{const st=J.substring(nt).match(/^[^\w]*\w*/);st&&(ot+=st[0].length);break}case"deleteContentBackward":nt===it&&(at-=1);break;case"deleteContentForward":nt===it&&(ot+=1);break}H.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:J,change:K||"",willCommit:!1,selStart:at,selEnd:ot}})}),this._setEventListeners(f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],H=>H.target.value)}if(W&&f.addEventListener("blur",W),this.data.comb){const H=(this.data.rect[2]-this.data.rect[0])/F;f.classList.add("comb"),f.style.letterSpacing=`calc(${H}px * var(--scale-factor) - 1ch)`}}else f=document.createElement("div"),f.textContent=this.data.fieldValue,f.style.verticalAlign="middle",f.style.display="table-cell";return this._setTextStyle(f),this._setBackgroundColor(f),this._setDefaultPropertiesFromJS(f),this.container.append(f),this.container}}class k extends b{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,f=i.id;let v=t.getValue(f,{value:i.exportValue===i.fieldValue}).value;typeof v=="string"&&(v=v!=="Off",t.setValue(f,{value:v})),this.container.className="buttonWidgetAnnotation checkBox";const C=document.createElement("input");return a.add(C),C.setAttribute("data-element-id",f),C.disabled=i.readOnly,this._setRequired(C,this.data.required),C.type="checkbox",C.name=i.fieldName,v&&C.setAttribute("checked",!0),C.setAttribute("exportValue",i.exportValue),C.tabIndex=_,C.addEventListener("change",F=>{const{name:I,checked:W}=F.target;for(const V of this._getElementsByName(I,f)){const H=W&&V.exportValue===i.exportValue;V.domElement&&(V.domElement.checked=H),t.setValue(V.id,{value:H})}t.setValue(f,{value:W})}),C.addEventListener("resetform",F=>{const I=i.defaultFieldValue||"Off";F.target.checked=I===i.exportValue}),this.enableScripting&&this.hasJSActions&&(C.addEventListener("updatefromsandbox",F=>{const I={value(W){W.target.checked=W.detail.value!=="Off",t.setValue(f,{value:W.target.checked})}};this._dispatchEventFromSandbox(I,F)}),this._setEventListeners(C,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],F=>F.target.checked)),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class M extends b{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,i=this.data,f=i.id;let v=t.getValue(f,{value:i.fieldValue===i.buttonValue}).value;typeof v=="string"&&(v=v!==i.buttonValue,t.setValue(f,{value:v}));const C=document.createElement("input");if(a.add(C),C.setAttribute("data-element-id",f),C.disabled=i.readOnly,this._setRequired(C,this.data.required),C.type="radio",C.name=i.fieldName,v&&C.setAttribute("checked",!0),C.tabIndex=_,C.addEventListener("change",F=>{const{name:I,checked:W}=F.target;for(const V of this._getElementsByName(I,f))t.setValue(V.id,{value:!1});t.setValue(f,{value:W})}),C.addEventListener("resetform",F=>{const I=i.defaultFieldValue;F.target.checked=I!=null&&I===i.buttonValue}),this.enableScripting&&this.hasJSActions){const F=i.buttonValue;C.addEventListener("updatefromsandbox",I=>{const W={value:V=>{const H=F===V.detail.value;for(const K of this._getElementsByName(V.target.name)){const et=H&&K.id===f;K.domElement&&(K.domElement.checked=et),t.setValue(K.id,{value:et})}}};this._dispatchEventFromSandbox(W,I)}),this._setEventListeners(C,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.checked)}return this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class m extends o{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText);const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",f=>{this._dispatchEventFromSandbox({},f)})),t}}class r extends b{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,i=this.data.id,f=t.getValue(i,{value:this.data.fieldValue}),v=document.createElement("select");a.add(v),v.setAttribute("data-element-id",i),v.disabled=this.data.readOnly,this._setRequired(v,this.data.required),v.name=this.data.fieldName,v.tabIndex=_;let C=this.data.combo&&this.data.options.length>0;this.data.combo||(v.size=this.data.options.length,this.data.multiSelect&&(v.multiple=!0)),v.addEventListener("resetform",V=>{const H=this.data.defaultFieldValue;for(const K of v.options)K.selected=K.value===H});for(const V of this.data.options){const H=document.createElement("option");H.textContent=V.displayValue,H.value=V.exportValue,f.value.includes(V.exportValue)&&(H.setAttribute("selected",!0),C=!1),v.append(H)}let F=null;if(C){const V=document.createElement("option");V.value=" ",V.setAttribute("hidden",!0),V.setAttribute("selected",!0),v.prepend(V),F=()=>{V.remove(),v.removeEventListener("input",F),F=null},v.addEventListener("input",F)}const I=(V,H)=>{const K=H?"value":"textContent",et=V.target.options;return V.target.multiple?Array.prototype.filter.call(et,J=>J.selected).map(J=>J[K]):et.selectedIndex===-1?null:et[et.selectedIndex][K]},W=V=>{const H=V.target.options;return Array.prototype.map.call(H,K=>({displayValue:K.textContent,exportValue:K.value}))};return this.enableScripting&&this.hasJSActions?(v.addEventListener("updatefromsandbox",V=>{const H={value(K){F?.();const et=K.detail.value,J=new Set(Array.isArray(et)?et:[et]);for(const nt of v.options)nt.selected=J.has(nt.value);t.setValue(i,{value:I(K,!0)})},multipleSelection(K){v.multiple=!0},remove(K){const et=v.options,J=K.detail.remove;et[J].selected=!1,v.remove(J),et.length>0&&Array.prototype.findIndex.call(et,it=>it.selected)===-1&&(et[0].selected=!0),t.setValue(i,{value:I(K,!0),items:W(K)})},clear(K){for(;v.length!==0;)v.remove(0);t.setValue(i,{value:null,items:[]})},insert(K){const{index:et,displayValue:J,exportValue:nt}=K.detail.insert,it=v.children[et],at=document.createElement("option");at.textContent=J,at.value=nt,it?it.before(at):v.append(at),t.setValue(i,{value:I(K,!0),items:W(K)})},items(K){const{items:et}=K.detail;for(;v.length!==0;)v.remove(0);for(const J of et){const{displayValue:nt,exportValue:it}=J,at=document.createElement("option");at.textContent=nt,at.value=it,v.append(at)}v.options.length>0&&(v.options[0].selected=!0),t.setValue(i,{value:I(K,!0),items:W(K)})},indices(K){const et=new Set(K.detail.indices);for(const J of K.target.options)J.selected=et.has(J.index);t.setValue(i,{value:I(K,!0)})},editable(K){K.target.disabled=!K.detail.editable}};this._dispatchEventFromSandbox(H,V)}),v.addEventListener("input",V=>{const H=I(V,!0),K=I(V,!1);t.setValue(i,{value:H}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:K,changeEx:H,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],V=>V.target.checked)):v.addEventListener("input",function(V){t.setValue(i,{value:I(V,!0)})}),this.data.combo&&this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class l extends A{constructor(t){const i=!!(t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i})}render(){const t=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",t.includes(this.data.parentType))return this.container;const i=`[data-annotation-id="${this.data.parentId}"]`,f=this.layer.querySelectorAll(i);if(f.length===0)return this.container;const v=new y({container:this.container,trigger:Array.from(f),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),C=this.page,F=n.Util.normalizeRect([this.data.parentRect[0],C.view[3]-this.data.parentRect[1]+C.view[1],this.data.parentRect[2],C.view[3]-this.data.parentRect[3]+C.view[1]]),I=F[0]+this.data.parentRect[2]-this.data.parentRect[0],W=F[1],[V,H,K,et]=this.viewport.viewBox,J=K-V,nt=et-H;return this.container.style.left=`${100*(I-V)/J}%`,this.container.style.top=`${100*(W-H)/nt}%`,this.container.append(v.render()),this.container}}class y{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const i=document.createElement("div");i.className="popupWrapper",this.hideElement=this.hideWrapper?i:this.container,this.hideElement.hidden=!0;const f=document.createElement("div");f.className="popup";const v=this.color;if(v){const I=.7*(255-v[0])+v[0],W=.7*(255-v[1])+v[1],V=.7*(255-v[2])+v[2];f.style.backgroundColor=n.Util.makeHexColor(I|0,W|0,V|0)}const C=document.createElement("h1");C.dir=this.titleObj.dir,C.textContent=this.titleObj.str,f.append(C);const F=d.PDFDateString.toDateObject(this.modificationDate);if(F){const I=document.createElement("span");I.className="popupDate",I.textContent="{{date}}, {{time}}",I.dataset.l10nId="annotation_date_string",I.dataset.l10nArgs=JSON.stringify({date:F.toLocaleDateString(),time:F.toLocaleTimeString()}),f.append(I)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))L.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:f}),f.lastChild.className="richText popupContent";else{const I=this._formatContents(this.contentsObj);f.append(I)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const I of this.trigger)I.addEventListener("click",this._toggle.bind(this)),I.addEventListener("mouseover",this._show.bind(this,!1)),I.addEventListener("mouseout",this._hide.bind(this,!1));return f.addEventListener("click",this._hide.bind(this,!0)),i.append(f),i}_formatContents({str:t,dir:i}){const f=document.createElement("p");f.className="popupContent",f.dir=i;const v=t.split(/(?:\r\n?|\n)/);for(let C=0,F=v.length;C<F;++C){const I=v[C];f.append(document.createTextNode(I)),C<F-1&&f.append(document.createElement("br"))}return f}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class w extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0}),this.textContent=t.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const t=document.createElement("div");t.className="annotationTextContent",t.setAttribute("role","comment");for(const i of this.textContent){const f=document.createElement("span");f.textContent=i,t.append(f)}this.container.append(t)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class P extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:i,height:f}=u(t.rect),v=this.svgFactory.create(i,f,!0),C=this.svgFactory.createElement("svg:line");return C.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),C.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),C.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),C.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),C.setAttribute("stroke-width",t.borderStyle.width||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","transparent"),v.append(C),this.container.append(v),this._createPopup(C,t),this.container}}class j extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:i,height:f}=u(t.rect),v=this.svgFactory.create(i,f,!0),C=t.borderStyle.width,F=this.svgFactory.createElement("svg:rect");return F.setAttribute("x",C/2),F.setAttribute("y",C/2),F.setAttribute("width",i-C),F.setAttribute("height",f-C),F.setAttribute("stroke-width",C||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),v.append(F),this.container.append(v),this._createPopup(F,t),this.container}}class N extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:i,height:f}=u(t.rect),v=this.svgFactory.create(i,f,!0),C=t.borderStyle.width,F=this.svgFactory.createElement("svg:ellipse");return F.setAttribute("cx",i/2),F.setAttribute("cy",f/2),F.setAttribute("rx",i/2-C/2),F.setAttribute("ry",f/2-C/2),F.setAttribute("stroke-width",C||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),v.append(F),this.container.append(v),this._createPopup(F,t),this.container}}class tt extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:i,height:f}=u(t.rect),v=this.svgFactory.create(i,f,!0);let C=[];for(const I of t.vertices){const W=I.x-t.rect[0],V=t.rect[3]-I.y;C.push(W+","+V)}C=C.join(" ");const F=this.svgFactory.createElement(this.svgElementName);return F.setAttribute("points",C),F.setAttribute("stroke-width",t.borderStyle.width||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),v.append(F),this.container.append(v),this._createPopup(F,t),this.container}}class Z extends tt{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class B extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class U extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:i,height:f}=u(t.rect),v=this.svgFactory.create(i,f,!0);for(const C of t.inkLists){let F=[];for(const W of C){const V=W.x-t.rect[0],H=t.rect[3]-W.y;F.push(`${V},${H}`)}F=F.join(" ");const I=this.svgFactory.createElement(this.svgElementName);I.setAttribute("points",F),I.setAttribute("stroke-width",t.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),this._createPopup(I,t),v.append(I)}return this.container.append(v),this.container}}class q extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class Y extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class z extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class x extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class h extends A{constructor(t){const i=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class c extends A{constructor(t){super(t,{isRenderable:!0});const{filename:i,content:f}=this.data.file;this.filename=(0,d.getFilenameFromUrl)(i),this.content=f,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:i,content:f})}render(){this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.className="popupTriggerArea",t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(t,this.data),this.container.append(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class S{static#t(t,i,f,v){const C=t.firstChild||t;C.id=`${d.AnnotationPrefix}${i}`,f.append(t),v?.moveElementInDOM(f,t,C,!1)}static render(t){const{annotations:i,div:f,viewport:v,accessibilityManager:C}=t;this.#e(f,v);let F=0;for(const I of i){if(I.annotationType!==n.AnnotationType.POPUP){const{width:V,height:H}=u(I.rect);if(V<=0||H<=0)continue}const W=p.create({data:I,layer:f,page:t.page,viewport:v,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new d.DOMSVGFactory,annotationStorage:t.annotationStorage||new O.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(W.isRenderable){const V=W.render();if(I.hidden&&(V.style.visibility="hidden"),Array.isArray(V))for(const H of V)H.style.zIndex=F++,S.#t(H,I.id,f,C);else V.style.zIndex=F++,W instanceof l?f.prepend(V):S.#t(V,I.id,f,C)}}this.#i(f,t.annotationCanvasMap)}static update(t){const{annotationCanvasMap:i,div:f,viewport:v}=t;this.#e(f,v),this.#i(f,i),f.hidden=!1}static#e(t,{width:i,height:f,rotation:v}){const{style:C}=t,F=v%180!==0,I=Math.floor(i)+"px",W=Math.floor(f)+"px";C.width=F?W:I,C.height=F?I:W,t.setAttribute("data-main-rotation",v)}static#i(t,i){if(i){for(const[f,v]of i){const C=t.querySelector(`[data-annotation-id="${f}"]`);if(!C)continue;const{firstChild:F}=C;F?F.nodeName==="CANVAS"?F.replaceWith(v):F.before(v):C.append(v)}i.clear()}}}e.AnnotationLayer=S},($,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function E(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}class n{static CMYK_G([O,R,L,_]){return["G",1-Math.min(1,.3*O+.59*L+.11*R+_)]}static G_CMYK([O]){return["CMYK",0,0,0,1-O]}static G_RGB([O]){return["RGB",O,O,O]}static G_HTML([O]){const R=E(O);return`#${R}${R}${R}`}static RGB_G([O,R,L]){return["G",.3*O+.59*R+.11*L]}static RGB_HTML([O,R,L]){const _=E(O),s=E(R),a=E(L);return`#${_}${s}${a}`}static T_HTML(){return"#00000000"}static CMYK_RGB([O,R,L,_]){return["RGB",1-Math.min(1,O+_),1-Math.min(1,L+_),1-Math.min(1,R+_)]}static CMYK_HTML(O){const R=this.CMYK_RGB(O).slice(1);return this.RGB_HTML(R)}static RGB_CMYK([O,R,L]){const _=1-O,s=1-R,a=1-L,u=Math.min(_,s,a);return["CMYK",_,s,a,u]}}e.ColorConverters=n},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=E(20);class d{static setupStorage(R,L,_,s,a){const u=s.getValue(L,{value:null});switch(_.name){case"textarea":if(u.value!==null&&(R.textContent=u.value),a==="print")break;R.addEventListener("input",p=>{s.setValue(L,{value:p.target.value})});break;case"input":if(_.attributes.type==="radio"||_.attributes.type==="checkbox"){if(u.value===_.attributes.xfaOn?R.setAttribute("checked",!0):u.value===_.attributes.xfaOff&&R.removeAttribute("checked"),a==="print")break;R.addEventListener("change",p=>{s.setValue(L,{value:p.target.checked?p.target.getAttribute("xfaOn"):p.target.getAttribute("xfaOff")})})}else{if(u.value!==null&&R.setAttribute("value",u.value),a==="print")break;R.addEventListener("input",p=>{s.setValue(L,{value:p.target.value})})}break;case"select":if(u.value!==null)for(const p of _.children)p.attributes.value===u.value&&(p.attributes.selected=!0);R.addEventListener("input",p=>{const A=p.target.options,o=A.selectedIndex===-1?"":A[A.selectedIndex].value;s.setValue(L,{value:o})});break}}static setAttributes({html:R,element:L,storage:_=null,intent:s,linkService:a}){const{attributes:u}=L,p=R instanceof HTMLAnchorElement;u.type==="radio"&&(u.name=`${u.name}-${s}`);for(const[A,o]of Object.entries(u))if(o!=null)switch(A){case"class":o.length&&R.setAttribute(A,o.join(" "));break;case"dataId":break;case"id":R.setAttribute("data-element-id",o);break;case"style":Object.assign(R.style,o);break;case"textContent":R.textContent=o;break;default:(!p||A!=="href"&&A!=="newWindow")&&R.setAttribute(A,o)}p&&a.addLinkAttributes(R,u.href,u.newWindow),_&&u.dataId&&this.setupStorage(R,u.dataId,L,_)}static render(R){const L=R.annotationStorage,_=R.linkService,s=R.xfaHtml,a=R.intent||"display",u=document.createElement(s.name);s.attributes&&this.setAttributes({html:u,element:s,intent:a,linkService:_});const p=[[s,-1,u]],A=R.div;if(A.append(u),R.viewport){const g=`matrix(${R.viewport.transform.join(",")})`;A.style.transform=g}a!=="richText"&&A.setAttribute("class","xfaLayer xfaFont");const o=[];for(;p.length>0;){const[g,b,D]=p.at(-1);if(b+1===g.children.length){p.pop();continue}const k=g.children[++p.at(-1)[1]];if(k===null)continue;const{name:M}=k;if(M==="#text"){const r=document.createTextNode(k.value);o.push(r),D.append(r);continue}let m;if(k?.attributes?.xmlns?m=document.createElementNS(k.attributes.xmlns,M):m=document.createElement(M),D.append(m),k.attributes&&this.setAttributes({html:m,element:k,storage:L,intent:a,linkService:_}),k.children&&k.children.length>0)p.push([k,-1,m]);else if(k.value){const r=document.createTextNode(k.value);n.XfaText.shouldBuildText(M)&&o.push(r),m.append(r)}}for(const g of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:o}}static update(R){const L=`matrix(${R.viewport.transform.join(",")})`;R.div.style.transform=L,R.div.hidden=!1}}e.XfaLayer=d},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=k;var n=E(1),d=E(8);const O=1e5,R=30,L=.8,_=new Map,s=/^\s+$/g;function a(M,m){const r=_.get(M);if(r)return r;m.save(),m.font=`${R}px ${M}`;const l=m.measureText("");let y=l.fontBoundingBoxAscent,w=Math.abs(l.fontBoundingBoxDescent);if(y){m.restore();const j=y/(y+w);return _.set(M,j),j}m.strokeStyle="red",m.clearRect(0,0,R,R),m.strokeText("g",0,0);let P=m.getImageData(0,0,R,R).data;w=0;for(let j=P.length-1-3;j>=0;j-=4)if(P[j]>0){w=Math.ceil(j/4/R);break}m.clearRect(0,0,R,R),m.strokeText("A",0,R),P=m.getImageData(0,0,R,R).data,y=0;for(let j=0,N=P.length;j<N;j+=4)if(P[j]>0){y=R-Math.floor(j/4/R);break}if(m.restore(),y){const j=y/(y+w);return _.set(M,j),j}return _.set(M,L),L}function u(M,m,r,l){const y=document.createElement("span"),w=M._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:m.str!=="",hasEOL:m.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:m.str!=="",hasEOL:m.hasEOL,fontSize:0};M._textDivs.push(y);const P=n.Util.transform(M._viewport.transform,m.transform);let j=Math.atan2(P[1],P[0]);const N=r[m.fontName];N.vertical&&(j+=Math.PI/2);const tt=Math.hypot(P[2],P[3]),Z=tt*a(N.fontFamily,l);let B,U;j===0?(B=P[4],U=P[5]-Z):(B=P[4]+Z*Math.sin(j),U=P[5]-Z*Math.cos(j)),y.style.left=`${B}px`,y.style.top=`${U}px`,y.style.fontSize=`${tt}px`,y.style.fontFamily=N.fontFamily,w.fontSize=tt,y.setAttribute("role","presentation"),y.textContent=m.str,y.dir=m.dir,M._fontInspectorEnabled&&(y.dataset.fontName=m.fontName),j!==0&&(w.angle=j*(180/Math.PI));let q=!1;if(m.str.length>1||M._enhanceTextSelection&&s.test(m.str))q=!0;else if(m.str!==" "&&m.transform[0]!==m.transform[3]){const Y=Math.abs(m.transform[0]),z=Math.abs(m.transform[3]);Y!==z&&Math.max(Y,z)/Math.min(Y,z)>1.5&&(q=!0)}if(q&&(N.vertical?w.canvasWidth=m.height*M._viewport.scale:w.canvasWidth=m.width*M._viewport.scale),M._textDivProperties.set(y,w),M._textContentStream&&M._layoutText(y),M._enhanceTextSelection&&w.hasText){let Y=1,z=0;j!==0&&(Y=Math.cos(j),z=Math.sin(j));const x=(N.vertical?m.height:m.width)*M._viewport.scale,h=tt;let c,S;j!==0?(c=[Y,z,-z,Y,B,U],S=n.Util.getAxialAlignedBoundingBox([0,0,x,h],c)):S=[B,U,B+x,U+h],M._bounds.push({left:S[0],top:S[1],right:S[2],bottom:S[3],div:y,size:[x,h],m:c})}}function p(M){if(M._canceled)return;const m=M._textDivs,r=M._capability,l=m.length;if(l>O){M._renderingDone=!0,r.resolve();return}if(!M._textContentStream)for(let y=0;y<l;y++)M._layoutText(m[y]);M._renderingDone=!0,r.resolve()}function A(M,m,r){let l=0;for(let y=0;y<r;y++){const w=M[m++];w>0&&(l=l?Math.min(w,l):w)}return l}function o(M){const m=M._bounds,r=M._viewport,l=g(r.width,r.height,m);for(let y=0;y<l.length;y++){const w=m[y].div,P=M._textDivProperties.get(w);if(P.angle===0){P.paddingLeft=m[y].left-l[y].left,P.paddingTop=m[y].top-l[y].top,P.paddingRight=l[y].right-m[y].right,P.paddingBottom=l[y].bottom-m[y].bottom,M._textDivProperties.set(w,P);continue}const j=l[y],N=m[y],tt=N.m,Z=tt[0],B=tt[1],U=[[0,0],[0,N.size[1]],[N.size[0],0],N.size],q=new Float64Array(64);for(let z=0,x=U.length;z<x;z++){const h=n.Util.applyTransform(U[z],tt);q[z+0]=Z&&(j.left-h[0])/Z,q[z+4]=B&&(j.top-h[1])/B,q[z+8]=Z&&(j.right-h[0])/Z,q[z+12]=B&&(j.bottom-h[1])/B,q[z+16]=B&&(j.left-h[0])/-B,q[z+20]=Z&&(j.top-h[1])/Z,q[z+24]=B&&(j.right-h[0])/-B,q[z+28]=Z&&(j.bottom-h[1])/Z,q[z+32]=Z&&(j.left-h[0])/-Z,q[z+36]=B&&(j.top-h[1])/-B,q[z+40]=Z&&(j.right-h[0])/-Z,q[z+44]=B&&(j.bottom-h[1])/-B,q[z+48]=B&&(j.left-h[0])/B,q[z+52]=Z&&(j.top-h[1])/-Z,q[z+56]=B&&(j.right-h[0])/B,q[z+60]=Z&&(j.bottom-h[1])/-Z}const Y=1+Math.min(Math.abs(Z),Math.abs(B));P.paddingLeft=A(q,32,16)/Y,P.paddingTop=A(q,48,16)/Y,P.paddingRight=A(q,0,16)/Y,P.paddingBottom=A(q,16,16)/Y,M._textDivProperties.set(w,P)}}function g(M,m,r){const l=r.map(function(w,P){return{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom,index:P,x1New:void 0,x2New:void 0}});b(M,l);const y=new Array(r.length);for(const w of l){const P=w.index;y[P]={left:w.x1New,top:0,right:w.x2New,bottom:0}}r.map(function(w,P){const j=y[P],N=l[P];N.x1=w.top,N.y1=M-j.right,N.x2=w.bottom,N.y2=M-j.left,N.index=P,N.x1New=void 0,N.x2New=void 0}),b(m,l);for(const w of l){const P=w.index;y[P].top=w.x1New,y[P].bottom=w.x2New}return y}function b(M,m){m.sort(function(y,w){return y.x1-w.x1||y.index-w.index});const l=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const y of m){let w=0;for(;w<l.length&&l[w].end<=y.y1;)w++;let P=l.length-1;for(;P>=0&&l[P].start>=y.y2;)P--;let j,N,tt,Z,B=-1/0;for(tt=w;tt<=P;tt++){j=l[tt],N=j.boundary;let Y;N.x2>y.x1?Y=N.index>y.index?N.x1New:y.x1:N.x2New===void 0?Y=(N.x2+y.x1)/2:Y=N.x2New,Y>B&&(B=Y)}for(y.x1New=B,tt=w;tt<=P;tt++)j=l[tt],N=j.boundary,N.x2New===void 0?N.x2>y.x1?N.index>y.index&&(N.x2New=N.x2):N.x2New=B:N.x2New>B&&(N.x2New=Math.max(B,N.x2));const U=[];let q=null;for(tt=w;tt<=P;tt++){j=l[tt],N=j.boundary;const Y=N.x2>y.x2?N:y;q===Y?U.at(-1).end=j.end:(U.push({start:j.start,end:j.end,boundary:Y}),q=Y)}for(l[w].start<y.y1&&(U[0].start=y.y1,U.unshift({start:l[w].start,end:y.y1,boundary:l[w].boundary})),y.y2<l[P].end&&(U.at(-1).end=y.y2,U.push({start:y.y2,end:l[P].end,boundary:l[P].boundary})),tt=w;tt<=P;tt++){if(j=l[tt],N=j.boundary,N.x2New!==void 0)continue;let Y=!1;for(Z=w-1;!Y&&Z>=0&&l[Z].start>=N.y1;Z--)Y=l[Z].boundary===N;for(Z=P+1;!Y&&Z<l.length&&l[Z].end<=N.y2;Z++)Y=l[Z].boundary===N;for(Z=0;!Y&&Z<U.length;Z++)Y=U[Z].boundary===N;Y||(N.x2New=B)}Array.prototype.splice.apply(l,[w,P-w+1,...U])}for(const y of l){const w=y.boundary;w.x2New===void 0&&(w.x2New=Math.max(M,w.x2))}}class D{constructor({textContent:m,textContentStream:r,container:l,viewport:y,textDivs:w,textContentItemsStr:P,enhanceTextSelection:j}){j&&(0,d.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=m,this._textContentStream=r,this._container=l,this._document=l.ownerDocument,this._viewport=y,this._textDivs=w||[],this._textContentItemsStr=P||[],this._enhanceTextSelection=!!j,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,n.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(m,r){for(let l=0,y=m.length;l<y;l++){if(m[l].str===void 0){if(m[l].type==="beginMarkedContentProps"||m[l].type==="beginMarkedContent"){const w=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),m[l].id!==null&&this._container.setAttribute("id",`${m[l].id}`),w.append(this._container)}else m[l].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(m[l].str),u(this,m[l],r,this._layoutTextCtx)}}_layoutText(m){const r=this._textDivProperties.get(m);let l="";if(r.canvasWidth!==0&&r.hasText){const{fontFamily:y}=m.style,{fontSize:w}=r;(w!==this._layoutTextLastFontSize||y!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${w*this._devicePixelRatio}px ${y}`,this._layoutTextLastFontSize=w,this._layoutTextLastFontFamily=y);const{width:P}=this._layoutTextCtx.measureText(m.textContent);if(P>0){const j=this._devicePixelRatio*r.canvasWidth/P;this._enhanceTextSelection&&(r.scale=j),l=`scaleX(${j})`}}if(r.angle!==0&&(l=`rotate(${r.angle}deg) ${l}`),l.length>0&&(this._enhanceTextSelection&&(r.originalTransform=l),m.style.transform=l),r.hasText&&this._container.append(m),r.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(m=0){const r=(0,n.createPromiseCapability)();let l=Object.create(null);const y=this._document.createElement("canvas");if(y.height=y.width=R,this._layoutTextCtx=y.getContext("2d",{alpha:!1}),this._textContent){const w=this._textContent.items,P=this._textContent.styles;this._processItems(w,P),r.resolve()}else if(this._textContentStream){const w=()=>{this._reader.read().then(({value:P,done:j})=>{if(j){r.resolve();return}Object.assign(l,P.styles),this._processItems(P.items,l),w()},r.reject)};this._reader=this._textContentStream.getReader(),w()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');r.promise.then(()=>{l=null,m?this._renderTimer=setTimeout(()=>{p(this),this._renderTimer=null},m):p(this)},this._capability.reject)}expandTextDivs(m=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(o(this),this._bounds=null);const r=[],l=[];for(let y=0,w=this._textDivs.length;y<w;y++){const P=this._textDivs[y],j=this._textDivProperties.get(P);j.hasText&&(m?(r.length=0,l.length=0,j.originalTransform&&r.push(j.originalTransform),j.paddingTop>0?(l.push(`${j.paddingTop}px`),r.push(`translateY(${-j.paddingTop}px)`)):l.push(0),j.paddingRight>0?l.push(`${j.paddingRight/j.scale}px`):l.push(0),j.paddingBottom>0?l.push(`${j.paddingBottom}px`):l.push(0),j.paddingLeft>0?(l.push(`${j.paddingLeft/j.scale}px`),r.push(`translateX(${-j.paddingLeft/j.scale}px)`)):l.push(0),P.style.padding=l.join(" "),r.length&&(P.style.transform=r.join(" "))):(P.style.padding=null,P.style.transform=j.originalTransform))}}}e.TextLayerRenderTask=D;function k(M){const m=new D({textContent:M.textContent,textContentStream:M.textContentStream,container:M.container,viewport:M.viewport,textDivs:M.textDivs,textContentItemsStr:M.textContentItemsStr,enhanceTextSelection:M.enhanceTextSelection});return m._render(M.timeout),m}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=E(8),d=E(1),O=E(3);let R=class{constructor(){(0,d.unreachable)("Not implemented: SVGGraphics")}};e.SVGGraphics=R;{let g=function(r){let l=[];const y=[];for(const w of r){if(w.fn==="save"){l.push({fnId:92,fn:"group",items:[]}),y.push(l),l=l.at(-1).items;continue}w.fn==="restore"?l=y.pop():l.push(w)}return l},b=function(r){if(Number.isInteger(r))return r.toString();const l=r.toFixed(10);let y=l.length-1;if(l[y]!=="0")return l;do y--;while(l[y]==="0");return l.substring(0,l[y]==="."?y:y+1)},D=function(r){if(r[4]===0&&r[5]===0){if(r[1]===0&&r[2]===0)return r[0]===1&&r[3]===1?"":`scale(${b(r[0])} ${b(r[3])})`;if(r[0]===r[3]&&r[1]===-r[2]){const l=Math.acos(r[0])*180/Math.PI;return`rotate(${b(l)})`}}else if(r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1)return`translate(${b(r[4])} ${b(r[5])})`;return`matrix(${b(r[0])} ${b(r[1])} ${b(r[2])} ${b(r[3])} ${b(r[4])} ${b(r[5])})`};const L={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},_="http://www.w3.org/XML/1998/namespace",s="http://www.w3.org/1999/xlink",a=["butt","round","square"],u=["miter","round","bevel"],p=function(r,l="",y=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!y)return URL.createObjectURL(new Blob([r],{type:l}));const w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let P=`data:${l};base64,`;for(let j=0,N=r.length;j<N;j+=3){const tt=r[j]&255,Z=r[j+1]&255,B=r[j+2]&255,U=tt>>2,q=(tt&3)<<4|Z>>4,Y=j+1<N?(Z&15)<<2|B>>6:64,z=j+2<N?B&63:64;P+=w[U]+w[q]+w[Y]+w[z]}return P},A=function(){const r=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,y=new Int32Array(256);for(let B=0;B<256;B++){let U=B;for(let q=0;q<8;q++)U&1?U=3988292384^U>>1&2147483647:U=U>>1&2147483647;y[B]=U}function w(B,U,q){let Y=-1;for(let z=U;z<q;z++){const x=(Y^B[z])&255,h=y[x];Y=Y>>>8^h}return Y^-1}function P(B,U,q,Y){let z=Y;const x=U.length;q[z]=x>>24&255,q[z+1]=x>>16&255,q[z+2]=x>>8&255,q[z+3]=x&255,z+=4,q[z]=B.charCodeAt(0)&255,q[z+1]=B.charCodeAt(1)&255,q[z+2]=B.charCodeAt(2)&255,q[z+3]=B.charCodeAt(3)&255,z+=4,q.set(U,z),z+=U.length;const h=w(q,Y+4,z);q[z]=h>>24&255,q[z+1]=h>>16&255,q[z+2]=h>>8&255,q[z+3]=h&255}function j(B,U,q){let Y=1,z=0;for(let x=U;x<q;++x)Y=(Y+(B[x]&255))%65521,z=(z+Y)%65521;return z<<16|Y}function N(B){if(!O.isNodeJS)return tt(B);try{let U;parseInt(process.versions.node)>=8?U=B:U=Buffer.from(B);const q=require$$5.deflateSync(U,{level:9});return q instanceof Uint8Array?q:new Uint8Array(q)}catch(U){(0,d.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+U)}return tt(B)}function tt(B){let U=B.length;const q=65535,Y=Math.ceil(U/q),z=new Uint8Array(2+U+Y*5+4);let x=0;z[x++]=120,z[x++]=156;let h=0;for(;U>q;)z[x++]=0,z[x++]=255,z[x++]=255,z[x++]=0,z[x++]=0,z.set(B.subarray(h,h+q),x),x+=q,h+=q,U-=q;z[x++]=1,z[x++]=U&255,z[x++]=U>>8&255,z[x++]=~U&65535&255,z[x++]=(~U&65535)>>8&255,z.set(B.subarray(h),x),x+=B.length-h;const c=j(B,0,B.length);return z[x++]=c>>24&255,z[x++]=c>>16&255,z[x++]=c>>8&255,z[x++]=c&255,z}function Z(B,U,q,Y){const z=B.width,x=B.height;let h,c,S;const T=B.data;switch(U){case d.ImageKind.GRAYSCALE_1BPP:c=0,h=1,S=z+7>>3;break;case d.ImageKind.RGB_24BPP:c=2,h=8,S=z*3;break;case d.ImageKind.RGBA_32BPP:c=6,h=8,S=z*4;break;default:throw new Error("invalid format")}const t=new Uint8Array((1+S)*x);let i=0,f=0;for(let V=0;V<x;++V)t[i++]=0,t.set(T.subarray(f,f+S),i),f+=S,i+=S;if(U===d.ImageKind.GRAYSCALE_1BPP&&Y){i=0;for(let V=0;V<x;V++){i++;for(let H=0;H<S;H++)t[i++]^=255}}const v=new Uint8Array([z>>24&255,z>>16&255,z>>8&255,z&255,x>>24&255,x>>16&255,x>>8&255,x&255,h,c,0,0,0]),C=N(t),F=r.length+l*3+v.length+C.length,I=new Uint8Array(F);let W=0;return I.set(r,W),W+=r.length,P("IHDR",v,I,W),W+=l+v.length,P("IDATA",C,I,W),W+=l+C.length,P("IEND",new Uint8Array(0),I,W),p(I,"image/png",q)}return function(U,q,Y){const z=U.kind===void 0?d.ImageKind.GRAYSCALE_1BPP:U.kind;return Z(U,z,q,Y)}}();class o{constructor(){this.fontSizeScale=1,this.fontWeight=L.fontWeight,this.fontSize=0,this.textMatrix=d.IDENTITY_MATRIX,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=d.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=L.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,y){this.x=l,this.y=y}}let k=0,M=0,m=0;e.SVGGraphics=R=class{constructor(r,l,y=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new o,this.transformMatrix=d.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=r,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!y,this._operatorIdMapping=[];for(const w in d.OPS)this._operatorIdMapping[d.OPS[w]]=w}save(){this.transformStack.push(this.transformMatrix);const r=this.current;this.extraStack.push(r),this.current=r.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(r){this.save(),this.executeOpTree(r),this.restore()}loadDependencies(r){const l=r.fnArray,y=r.argsArray;for(let w=0,P=l.length;w<P;w++)if(l[w]===d.OPS.dependency)for(const j of y[w]){const N=j.startsWith("g_")?this.commonObjs:this.objs,tt=new Promise(Z=>{N.get(j,Z)});this.current.dependencies.push(tt)}return Promise.all(this.current.dependencies)}transform(r,l,y,w,P,j){const N=[r,l,y,w,P,j];this.transformMatrix=d.Util.transform(this.transformMatrix,N),this.tgrp=null}getSVG(r,l){this.viewport=l;const y=this._initialize(l);return this.loadDependencies(r).then(()=>(this.transformMatrix=d.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(r)),y))}convertOpList(r){const l=this._operatorIdMapping,y=r.argsArray,w=r.fnArray,P=[];for(let j=0,N=w.length;j<N;j++){const tt=w[j];P.push({fnId:tt,fn:l[tt],args:y[j]})}return g(P)}executeOpTree(r){for(const l of r){const y=l.fn,w=l.fnId,P=l.args;switch(w|0){case d.OPS.beginText:this.beginText();break;case d.OPS.dependency:break;case d.OPS.setLeading:this.setLeading(P);break;case d.OPS.setLeadingMoveText:this.setLeadingMoveText(P[0],P[1]);break;case d.OPS.setFont:this.setFont(P);break;case d.OPS.showText:this.showText(P[0]);break;case d.OPS.showSpacedText:this.showText(P[0]);break;case d.OPS.endText:this.endText();break;case d.OPS.moveText:this.moveText(P[0],P[1]);break;case d.OPS.setCharSpacing:this.setCharSpacing(P[0]);break;case d.OPS.setWordSpacing:this.setWordSpacing(P[0]);break;case d.OPS.setHScale:this.setHScale(P[0]);break;case d.OPS.setTextMatrix:this.setTextMatrix(P[0],P[1],P[2],P[3],P[4],P[5]);break;case d.OPS.setTextRise:this.setTextRise(P[0]);break;case d.OPS.setTextRenderingMode:this.setTextRenderingMode(P[0]);break;case d.OPS.setLineWidth:this.setLineWidth(P[0]);break;case d.OPS.setLineJoin:this.setLineJoin(P[0]);break;case d.OPS.setLineCap:this.setLineCap(P[0]);break;case d.OPS.setMiterLimit:this.setMiterLimit(P[0]);break;case d.OPS.setFillRGBColor:this.setFillRGBColor(P[0],P[1],P[2]);break;case d.OPS.setStrokeRGBColor:this.setStrokeRGBColor(P[0],P[1],P[2]);break;case d.OPS.setStrokeColorN:this.setStrokeColorN(P);break;case d.OPS.setFillColorN:this.setFillColorN(P);break;case d.OPS.shadingFill:this.shadingFill(P[0]);break;case d.OPS.setDash:this.setDash(P[0],P[1]);break;case d.OPS.setRenderingIntent:this.setRenderingIntent(P[0]);break;case d.OPS.setFlatness:this.setFlatness(P[0]);break;case d.OPS.setGState:this.setGState(P[0]);break;case d.OPS.fill:this.fill();break;case d.OPS.eoFill:this.eoFill();break;case d.OPS.stroke:this.stroke();break;case d.OPS.fillStroke:this.fillStroke();break;case d.OPS.eoFillStroke:this.eoFillStroke();break;case d.OPS.clip:this.clip("nonzero");break;case d.OPS.eoClip:this.clip("evenodd");break;case d.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case d.OPS.paintImageXObject:this.paintImageXObject(P[0]);break;case d.OPS.paintInlineImageXObject:this.paintInlineImageXObject(P[0]);break;case d.OPS.paintImageMaskXObject:this.paintImageMaskXObject(P[0]);break;case d.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(P[0],P[1]);break;case d.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case d.OPS.closePath:this.closePath();break;case d.OPS.closeStroke:this.closeStroke();break;case d.OPS.closeFillStroke:this.closeFillStroke();break;case d.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case d.OPS.nextLine:this.nextLine();break;case d.OPS.transform:this.transform(P[0],P[1],P[2],P[3],P[4],P[5]);break;case d.OPS.constructPath:this.constructPath(P[0],P[1]);break;case d.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,d.warn)(`Unimplemented operator ${y}`);break}}}setWordSpacing(r){this.current.wordSpacing=r}setCharSpacing(r){this.current.charSpacing=r}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(r,l,y,w,P,j){const N=this.current;N.textMatrix=N.lineMatrix=[r,l,y,w,P,j],N.textMatrixScale=Math.hypot(r,l),N.x=N.lineX=0,N.y=N.lineY=0,N.xcoords=[],N.ycoords=[],N.tspan=this.svgFactory.createElement("svg:tspan"),N.tspan.setAttributeNS(null,"font-family",N.fontFamily),N.tspan.setAttributeNS(null,"font-size",`${b(N.fontSize)}px`),N.tspan.setAttributeNS(null,"y",b(-N.y)),N.txtElement=this.svgFactory.createElement("svg:text"),N.txtElement.append(N.tspan)}beginText(){const r=this.current;r.x=r.lineX=0,r.y=r.lineY=0,r.textMatrix=d.IDENTITY_MATRIX,r.lineMatrix=d.IDENTITY_MATRIX,r.textMatrixScale=1,r.tspan=this.svgFactory.createElement("svg:tspan"),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtgrp=this.svgFactory.createElement("svg:g"),r.xcoords=[],r.ycoords=[]}moveText(r,l){const y=this.current;y.x=y.lineX+=r,y.y=y.lineY+=l,y.xcoords=[],y.ycoords=[],y.tspan=this.svgFactory.createElement("svg:tspan"),y.tspan.setAttributeNS(null,"font-family",y.fontFamily),y.tspan.setAttributeNS(null,"font-size",`${b(y.fontSize)}px`),y.tspan.setAttributeNS(null,"y",b(-y.y))}showText(r){const l=this.current,y=l.font,w=l.fontSize;if(w===0)return;const P=l.fontSizeScale,j=l.charSpacing,N=l.wordSpacing,tt=l.fontDirection,Z=l.textHScale*tt,B=y.vertical,U=B?1:-1,q=y.defaultVMetrics,Y=w*l.fontMatrix[0];let z=0;for(const c of r){if(c===null){z+=tt*N;continue}else if(typeof c=="number"){z+=U*c*w/1e3;continue}const S=(c.isSpace?N:0)+j,T=c.fontChar;let t,i,f=c.width;if(B){let C;const F=c.vmetric||q;C=c.vmetric?F[1]:f*.5,C=-C*Y;const I=F[2]*Y;f=F?-F[0]:f,t=C/P,i=(z+I)/P}else t=z/P,i=0;(c.isInFont||y.missingFile)&&(l.xcoords.push(l.x+t),B&&l.ycoords.push(-l.y+i),l.tspan.textContent+=T);let v;B?v=f*Y-S*tt:v=f*Y+S*tt,z+=v}l.tspan.setAttributeNS(null,"x",l.xcoords.map(b).join(" ")),B?l.tspan.setAttributeNS(null,"y",l.ycoords.map(b).join(" ")):l.tspan.setAttributeNS(null,"y",b(-l.y)),B?l.y-=z:l.x+=z*Z,l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${b(l.fontSize)}px`),l.fontStyle!==L.fontStyle&&l.tspan.setAttributeNS(null,"font-style",l.fontStyle),l.fontWeight!==L.fontWeight&&l.tspan.setAttributeNS(null,"font-weight",l.fontWeight);const x=l.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;if(x===d.TextRenderingMode.FILL||x===d.TextRenderingMode.FILL_STROKE?(l.fillColor!==L.fillColor&&l.tspan.setAttributeNS(null,"fill",l.fillColor),l.fillAlpha<1&&l.tspan.setAttributeNS(null,"fill-opacity",l.fillAlpha)):l.textRenderingMode===d.TextRenderingMode.ADD_TO_PATH?l.tspan.setAttributeNS(null,"fill","transparent"):l.tspan.setAttributeNS(null,"fill","none"),x===d.TextRenderingMode.STROKE||x===d.TextRenderingMode.FILL_STROKE){const c=1/(l.textMatrixScale||1);this._setStrokeAttributes(l.tspan,c)}let h=l.textMatrix;l.textRise!==0&&(h=h.slice(),h[5]+=l.textRise),l.txtElement.setAttributeNS(null,"transform",`${D(h)} scale(${b(Z)}, -1)`),l.txtElement.setAttributeNS(_,"xml:space","preserve"),l.txtElement.append(l.tspan),l.txtgrp.append(l.txtElement),this._ensureTransformGroup().append(l.txtElement)}setLeadingMoveText(r,l){this.setLeading(-l),this.moveText(r,l)}addFontStyle(r){if(!r.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const l=p(r.data,r.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${r.loadedName}"; src: url(${l}); }
`}setFont(r){const l=this.current,y=this.commonObjs.get(r[0]);let w=r[1];l.font=y,this.embedFonts&&!y.missingFile&&!this.embeddedFonts[y.loadedName]&&(this.addFontStyle(y),this.embeddedFonts[y.loadedName]=y),l.fontMatrix=y.fontMatrix||d.FONT_IDENTITY_MATRIX;let P="normal";y.black?P="900":y.bold&&(P="bold");const j=y.italic?"italic":"normal";w<0?(w=-w,l.fontDirection=-1):l.fontDirection=1,l.fontSize=w,l.fontFamily=y.loadedName,l.fontWeight=P,l.fontStyle=j,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",b(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){const r=this.current;r.textRenderingMode&d.TextRenderingMode.ADD_TO_PATH_FLAG&&r.txtElement?.hasChildNodes()&&(r.element=r.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(r){r>0&&(this.current.lineWidth=r)}setLineCap(r){this.current.lineCap=a[r]}setLineJoin(r){this.current.lineJoin=u[r]}setMiterLimit(r){this.current.miterLimit=r}setStrokeAlpha(r){this.current.strokeAlpha=r}setStrokeRGBColor(r,l,y){this.current.strokeColor=d.Util.makeHexColor(r,l,y)}setFillAlpha(r){this.current.fillAlpha=r}setFillRGBColor(r,l,y){this.current.fillColor=d.Util.makeHexColor(r,l,y),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(r){this.current.strokeColor=this._makeColorN_Pattern(r)}setFillColorN(r){this.current.fillColor=this._makeColorN_Pattern(r)}shadingFill(r){const l=this.viewport.width,y=this.viewport.height,w=d.Util.inverseTransform(this.transformMatrix),P=d.Util.applyTransform([0,0],w),j=d.Util.applyTransform([0,y],w),N=d.Util.applyTransform([l,0],w),tt=d.Util.applyTransform([l,y],w),Z=Math.min(P[0],j[0],N[0],tt[0]),B=Math.min(P[1],j[1],N[1],tt[1]),U=Math.max(P[0],j[0],N[0],tt[0]),q=Math.max(P[1],j[1],N[1],tt[1]),Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x",Z),Y.setAttributeNS(null,"y",B),Y.setAttributeNS(null,"width",U-Z),Y.setAttributeNS(null,"height",q-B),Y.setAttributeNS(null,"fill",this._makeShadingPattern(r)),this.current.fillAlpha<1&&Y.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Y)}_makeColorN_Pattern(r){return r[0]==="TilingPattern"?this._makeTilingPattern(r):this._makeShadingPattern(r)}_makeTilingPattern(r){const l=r[1],y=r[2],w=r[3]||d.IDENTITY_MATRIX,[P,j,N,tt]=r[4],Z=r[5],B=r[6],U=r[7],q=`shading${m++}`,[Y,z,x,h]=d.Util.normalizeRect([...d.Util.applyTransform([P,j],w),...d.Util.applyTransform([N,tt],w)]),[c,S]=d.Util.singularValueDecompose2dScale(w),T=Z*c,t=B*S,i=this.svgFactory.createElement("svg:pattern");i.setAttributeNS(null,"id",q),i.setAttributeNS(null,"patternUnits","userSpaceOnUse"),i.setAttributeNS(null,"width",T),i.setAttributeNS(null,"height",t),i.setAttributeNS(null,"x",`${Y}`),i.setAttributeNS(null,"y",`${z}`);const f=this.svg,v=this.transformMatrix,C=this.current.fillColor,F=this.current.strokeColor,I=this.svgFactory.create(x-Y,h-z);if(this.svg=I,this.transformMatrix=w,U===2){const W=d.Util.makeHexColor(...l);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(y)),this.svg=f,this.transformMatrix=v,this.current.fillColor=C,this.current.strokeColor=F,i.append(I.childNodes[0]),this.defs.append(i),`url(#${q})`}_makeShadingPattern(r){switch(typeof r=="string"&&(r=this.objs.get(r)),r[0]){case"RadialAxial":const l=`shading${m++}`,y=r[3];let w;switch(r[1]){case"axial":const P=r[4],j=r[5];w=this.svgFactory.createElement("svg:linearGradient"),w.setAttributeNS(null,"id",l),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"x1",P[0]),w.setAttributeNS(null,"y1",P[1]),w.setAttributeNS(null,"x2",j[0]),w.setAttributeNS(null,"y2",j[1]);break;case"radial":const N=r[4],tt=r[5],Z=r[6],B=r[7];w=this.svgFactory.createElement("svg:radialGradient"),w.setAttributeNS(null,"id",l),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"cx",tt[0]),w.setAttributeNS(null,"cy",tt[1]),w.setAttributeNS(null,"r",B),w.setAttributeNS(null,"fx",N[0]),w.setAttributeNS(null,"fy",N[1]),w.setAttributeNS(null,"fr",Z);break;default:throw new Error(`Unknown RadialAxial type: ${r[1]}`)}for(const P of y){const j=this.svgFactory.createElement("svg:stop");j.setAttributeNS(null,"offset",P[0]),j.setAttributeNS(null,"stop-color",P[1]),w.append(j)}return this.defs.append(w),`url(#${l})`;case"Mesh":return(0,d.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${r[0]}`)}}setDash(r,l){this.current.dashArray=r,this.current.dashPhase=l}constructPath(r,l){const y=this.current;let w=y.x,P=y.y,j=[],N=0;for(const tt of r)switch(tt|0){case d.OPS.rectangle:w=l[N++],P=l[N++];const Z=l[N++],B=l[N++],U=w+Z,q=P+B;j.push("M",b(w),b(P),"L",b(U),b(P),"L",b(U),b(q),"L",b(w),b(q),"Z");break;case d.OPS.moveTo:w=l[N++],P=l[N++],j.push("M",b(w),b(P));break;case d.OPS.lineTo:w=l[N++],P=l[N++],j.push("L",b(w),b(P));break;case d.OPS.curveTo:w=l[N+4],P=l[N+5],j.push("C",b(l[N]),b(l[N+1]),b(l[N+2]),b(l[N+3]),b(w),b(P)),N+=6;break;case d.OPS.curveTo2:j.push("C",b(w),b(P),b(l[N]),b(l[N+1]),b(l[N+2]),b(l[N+3])),w=l[N+2],P=l[N+3],N+=4;break;case d.OPS.curveTo3:w=l[N+2],P=l[N+3],j.push("C",b(l[N]),b(l[N+1]),b(w),b(P),b(w),b(P)),N+=4;break;case d.OPS.closePath:j.push("Z");break}j=j.join(" "),y.path&&r.length>0&&r[0]!==d.OPS.rectangle&&r[0]!==d.OPS.moveTo?j=y.path.getAttributeNS(null,"d")+j:(y.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(y.path)),y.path.setAttributeNS(null,"d",j),y.path.setAttributeNS(null,"fill","none"),y.element=y.path,y.setCurrentPoint(w,P)}endPath(){const r=this.current;if(r.path=null,!this.pendingClip)return;if(!r.element){this.pendingClip=null;return}const l=`clippath${k++}`,y=this.svgFactory.createElement("svg:clipPath");y.setAttributeNS(null,"id",l),y.setAttributeNS(null,"transform",D(this.transformMatrix));const w=r.element.cloneNode(!0);if(this.pendingClip==="evenodd"?w.setAttributeNS(null,"clip-rule","evenodd"):w.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,y.append(w),this.defs.append(y),r.activeClipUrl){r.clipGroup=null;for(const P of this.extraStack)P.clipGroup=null;y.setAttributeNS(null,"clip-path",r.activeClipUrl)}r.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(r){this.pendingClip=r}closePath(){const r=this.current;if(r.path){const l=`${r.path.getAttributeNS(null,"d")}Z`;r.path.setAttributeNS(null,"d",l)}}setLeading(r){this.current.leading=-r}setTextRise(r){this.current.textRise=r}setTextRenderingMode(r){this.current.textRenderingMode=r}setHScale(r){this.current.textHScale=r/100}setRenderingIntent(r){}setFlatness(r){}setGState(r){for(const[l,y]of r)switch(l){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y);break;case"CA":this.setStrokeAlpha(y);break;case"ca":this.setFillAlpha(y);break;default:(0,d.warn)(`Unimplemented graphic state operator ${l}`);break}}fill(){const r=this.current;r.element&&(r.element.setAttributeNS(null,"fill",r.fillColor),r.element.setAttributeNS(null,"fill-opacity",r.fillAlpha),this.endPath())}stroke(){const r=this.current;r.element&&(this._setStrokeAttributes(r.element),r.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(r,l=1){const y=this.current;let w=y.dashArray;l!==1&&w.length>0&&(w=w.map(function(P){return l*P})),r.setAttributeNS(null,"stroke",y.strokeColor),r.setAttributeNS(null,"stroke-opacity",y.strokeAlpha),r.setAttributeNS(null,"stroke-miterlimit",b(y.miterLimit)),r.setAttributeNS(null,"stroke-linecap",y.lineCap),r.setAttributeNS(null,"stroke-linejoin",y.lineJoin),r.setAttributeNS(null,"stroke-width",b(l*y.lineWidth)+"px"),r.setAttributeNS(null,"stroke-dasharray",w.map(b).join(" ")),r.setAttributeNS(null,"stroke-dashoffset",b(l*y.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","1px"),r.setAttributeNS(null,"height","1px"),r.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(r)}paintImageXObject(r){const l=r.startsWith("g_")?this.commonObjs.get(r):this.objs.get(r);if(!l){(0,d.warn)(`Dependent image with object ID ${r} is not ready yet`);return}this.paintInlineImageXObject(l)}paintInlineImageXObject(r,l){const y=r.width,w=r.height,P=A(r,this.forceDataSchema,!!l),j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x","0"),j.setAttributeNS(null,"y","0"),j.setAttributeNS(null,"width",b(y)),j.setAttributeNS(null,"height",b(w)),this.current.element=j,this.clip("nonzero");const N=this.svgFactory.createElement("svg:image");N.setAttributeNS(s,"xlink:href",P),N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y",b(-w)),N.setAttributeNS(null,"width",b(y)+"px"),N.setAttributeNS(null,"height",b(w)+"px"),N.setAttributeNS(null,"transform",`scale(${b(1/y)} ${b(-1/w)})`),l?l.append(N):this._ensureTransformGroup().append(N)}paintImageMaskXObject(r){const l=this.current,y=r.width,w=r.height,P=l.fillColor;l.maskId=`mask${M++}`;const j=this.svgFactory.createElement("svg:mask");j.setAttributeNS(null,"id",l.maskId);const N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",b(y)),N.setAttributeNS(null,"height",b(w)),N.setAttributeNS(null,"fill",P),N.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(j),this._ensureTransformGroup().append(N),this.paintInlineImageXObject(r,j)}paintFormXObjectBegin(r,l){if(Array.isArray(r)&&r.length===6&&this.transform(r[0],r[1],r[2],r[3],r[4],r[5]),l){const y=l[2]-l[0],w=l[3]-l[1],P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x",l[0]),P.setAttributeNS(null,"y",l[1]),P.setAttributeNS(null,"width",b(y)),P.setAttributeNS(null,"height",b(w)),this.current.element=P,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(r){const l=this.svgFactory.create(r.width,r.height),y=this.svgFactory.createElement("svg:defs");l.append(y),this.defs=y;const w=this.svgFactory.createElement("svg:g");return w.setAttributeNS(null,"transform",D(r.transform)),l.append(w),this.svg=w,l}_ensureClipGroup(){if(!this.current.clipGroup){const r=this.svgFactory.createElement("svg:g");r.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(r),this.current.clipGroup=r}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",D(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=E(1),d=E(33);const O=require$$5,R=require$$5,L=require$$5,_=require$$5,s=/^file:\/\/\/[a-zA-Z]:\//;function a(M){const m=_.parse(M);return m.protocol==="file:"||m.host?m:/^[a-z]:[/\\]/i.test(M)?_.parse(`file:///${M}`):(m.host||(m.protocol="file:"),m)}class u{constructor(m){this.source=m,this.url=a(m.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new D(this):new g(this),this._fullRequestReader}getRangeReader(m,r){if(r<=this._progressiveDataLength)return null;const l=this.isFsUrl?new k(this,m,r):new b(this,m,r);return this._rangeRequestReaders.push(l),l}cancelAllRequests(m){this._fullRequestReader&&this._fullRequestReader.cancel(m);for(const r of this._rangeRequestReaders.slice(0))r.cancel(m)}}e.PDFNodeStream=u;class p{constructor(m){this._url=m.url,this._done=!1,this._storedError=null,this.onProgress=null;const r=m.source;this._contentLength=r.length,this._loaded=0,this._filename=null,this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._headersCapability=(0,n.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const m=this._readableStream.read();return m===null?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=m.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){if(!this._readableStream){this._error(m);return}this._readableStream.destroy(m)}_error(m){this._storedError=m,this._readCapability.resolve()}_setReadableStream(m){this._readableStream=m,m.on("readable",()=>{this._readCapability.resolve()}),m.on("end",()=>{m.destroy(),this._done=!0,this._readCapability.resolve()}),m.on("error",r=>{this._error(r)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(m){this._url=m.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)();const r=m.source;this._isStreamingSupported=!r.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const m=this._readableStream.read();return m===null?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=m.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){if(!this._readableStream){this._error(m);return}this._readableStream.destroy(m)}_error(m){this._storedError=m,this._readCapability.resolve()}_setReadableStream(m){this._readableStream=m,m.on("readable",()=>{this._readCapability.resolve()}),m.on("end",()=>{m.destroy(),this._done=!0,this._readCapability.resolve()}),m.on("error",r=>{this._error(r)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function o(M,m){return{protocol:M.protocol,auth:M.auth,host:M.hostname,port:M.port,path:M.path,method:"GET",headers:m}}class g extends p{constructor(m){super(m);const r=l=>{if(l.statusCode===404){const j=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=j,this._headersCapability.reject(j);return}this._headersCapability.resolve(),this._setReadableStream(l);const y=j=>this._readableStream.headers[j.toLowerCase()],{allowRangeRequests:w,suggestedLength:P}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:m.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=P||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(y)};this._request=null,this._url.protocol==="http:"?this._request=R.request(o(this._url,m.httpHeaders),r):this._request=L.request(o(this._url,m.httpHeaders),r),this._request.on("error",l=>{this._storedError=l,this._headersCapability.reject(l)}),this._request.end()}}class b extends A{constructor(m,r,l){super(m),this._httpHeaders={};for(const w in m.httpHeaders){const P=m.httpHeaders[w];typeof P>"u"||(this._httpHeaders[w]=P)}this._httpHeaders.Range=`bytes=${r}-${l-1}`;const y=w=>{if(w.statusCode===404){const P=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=P;return}this._setReadableStream(w)};this._request=null,this._url.protocol==="http:"?this._request=R.request(o(this._url,this._httpHeaders),y):this._request=L.request(o(this._url,this._httpHeaders),y),this._request.on("error",w=>{this._storedError=w}),this._request.end()}}class D extends p{constructor(m){super(m);let r=decodeURIComponent(this._url.path);s.test(this._url.href)&&(r=r.replace(/^\//,"")),O.lstat(r,(l,y)=>{if(l){l.code==="ENOENT"&&(l=new n.MissingPDFException(`Missing PDF "${r}".`)),this._storedError=l,this._headersCapability.reject(l);return}this._contentLength=y.size,this._setReadableStream(O.createReadStream(r)),this._headersCapability.resolve()})}}class k extends A{constructor(m,r,l){super(m);let y=decodeURIComponent(this._url.path);s.test(this._url.href)&&(y=y.replace(/^\//,"")),this._setReadableStream(O.createReadStream(y,{start:r,end:l-1}))}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=_,e.extractFilenameFromHeader=L,e.validateRangeRequestCapabilities=R,e.validateResponseStatus=s;var n=E(1),d=E(34),O=E(8);function R({getResponseHeader:a,isHttp:u,rangeChunkSize:p,disableRange:A}){const o={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(a("Content-Length"),10);return!Number.isInteger(g)||(o.suggestedLength=g,g<=2*p)||A||!u||a("Accept-Ranges")!=="bytes"||(a("Content-Encoding")||"identity")!=="identity"||(o.allowRangeRequests=!0),o}function L(a){const u=a("Content-Disposition");if(u){let p=(0,d.getFilenameFromContentDispositionHeader)(u);if(p.includes("%"))try{p=decodeURIComponent(p)}catch{}if((0,O.isPdfFile)(p))return p}return null}function _(a,u){return a===404||a===0&&u.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+u+'".'):new n.UnexpectedResponseException(`Unexpected server response (${a}) while retrieving PDF "${u}".`,a)}function s(a){return a===200||a===206}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=d;var n=E(1);function d(O){let R=!0,L=_("filename\\*","i").exec(O);if(L){L=L[1];let g=p(L);return g=unescape(g),g=A(g),g=o(g),a(g)}if(L=u(O),L){const g=o(L);return a(g)}if(L=_("filename","i").exec(O),L){L=L[1];let g=p(L);return g=o(g),a(g)}function _(g,b){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function s(g,b){if(g){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const D=new TextDecoder(g,{fatal:!0}),k=(0,n.stringToBytes)(b);b=D.decode(k),R=!1}catch{}}return b}function a(g){return R&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),R&&(g=s("iso-8859-1",g))),g}function u(g){const b=[];let D;const k=_("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(D=k.exec(g))!==null;){let[,m,r,l]=D;if(m=parseInt(m,10),m in b){if(m===0)break;continue}b[m]=[r,l]}const M=[];for(let m=0;m<b.length&&m in b;++m){let[r,l]=b[m];l=p(l),r&&(l=unescape(l),m===0&&(l=A(l))),M.push(l)}return M.join("")}function p(g){if(g.startsWith('"')){const b=g.slice(1).split('\\"');for(let D=0;D<b.length;++D){const k=b[D].indexOf('"');k!==-1&&(b[D]=b[D].slice(0,k),b.length=D+1),b[D]=b[D].replace(/\\(.)/g,"$1")}g=b.join('"')}return g}function A(g){const b=g.indexOf("'");if(b===-1)return g;const D=g.slice(0,b),M=g.slice(b+1).replace(/^[^']*'/,"");return s(D,M)}function o(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,D,k,M){if(k==="q"||k==="Q")return M=M.replace(/_/g," "),M=M.replace(/=([0-9a-fA-F]{2})/g,function(m,r){return String.fromCharCode(parseInt(r,16))}),s(D,M);try{M=atob(M)}catch{}return s(D,M)})}return""}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=E(1),d=E(33);const O=200,R=206;function L(p){const A=p.response;return typeof A!="string"?A:(0,n.stringToBytes)(A).buffer}class _{constructor(A,o={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&o.httpHeaders||Object.create(null),this.withCredentials=o.withCredentials||!1,this.getXhr=o.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,o,g){const b={begin:A,end:o};for(const D in g)b[D]=g[D];return this.request(b)}requestFull(A){return this.request(A)}request(A){const o=this.getXhr(),g=this.currXhrId++,b=this.pendingRequests[g]={xhr:o};o.open("GET",this.url),o.withCredentials=this.withCredentials;for(const D in this.httpHeaders){const k=this.httpHeaders[D];typeof k>"u"||o.setRequestHeader(D,k)}return this.isHttp&&"begin"in A&&"end"in A?(o.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),b.expectedStatus=R):b.expectedStatus=O,o.responseType="arraybuffer",A.onError&&(o.onerror=function(D){A.onError(o.status)}),o.onreadystatechange=this.onStateChange.bind(this,g),o.onprogress=this.onProgress.bind(this,g),b.onHeadersReceived=A.onHeadersReceived,b.onDone=A.onDone,b.onError=A.onError,b.onProgress=A.onProgress,o.send(null),g}onProgress(A,o){const g=this.pendingRequests[A];g&&g.onProgress?.(o)}onStateChange(A,o){const g=this.pendingRequests[A];if(!g)return;const b=g.xhr;if(b.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),b.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],b.status===0&&this.isHttp){g.onError?.(b.status);return}const D=b.status||O;if(!(D===O&&g.expectedStatus===R)&&D!==g.expectedStatus){g.onError?.(b.status);return}const M=L(b);if(D===R){const m=b.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(m);g.onDone({begin:parseInt(r[1],10),chunk:M})}else M?g.onDone({begin:0,chunk:M}):g.onError?.(b.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const o=this.pendingRequests[A].xhr;delete this.pendingRequests[A],o.abort()}}class s{constructor(A){this._source=A,this._manager=new _(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const o=this._rangeRequestReaders.indexOf(A);o>=0&&this._rangeRequestReaders.splice(o,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new a(this._manager,this._source),this._fullRequestReader}getRangeReader(A,o){const g=new u(this._manager,A,o);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(A){this._fullRequestReader?.cancel(A);for(const o of this._rangeRequestReaders.slice(0))o.cancel(A)}}e.PDFNetworkStream=s;class a{constructor(A,o){this._manager=A;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=o.url,this._fullRequestId=A.requestFull(g),this._headersReceivedCapability=(0,n.createPromiseCapability)(),this._disableRange=o.disableRange||!1,this._contentLength=o.length,this._rangeChunkSize=o.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,o=this._manager.getRequestXhr(A),g=k=>o.getResponseHeader(k),{allowRangeRequests:b,suggestedLength:D}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});b&&(this._isRangeSupported=!0),this._contentLength=D||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,d.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const o of this._requests)o.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){this.onProgress?.({loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,n.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class u{constructor(A,o,g){this._manager=A;const b={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(o,g,b),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(A){const o=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:o,done:!1}):this._queuedChunk=o,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,d.createResponseStatusError)(A,this._url);for(const o of this._requests)o.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){this.isStreamingSupported||this.onProgress?.({loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const o=this._queuedChunk;return this._queuedChunk=null,{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,n.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},($,e,E)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=E(1),d=E(33);function O(a,u,p){return{method:"GET",headers:a,signal:p.signal,mode:"cors",credentials:u?"include":"same-origin",redirect:"follow"}}function R(a){const u=new Headers;for(const p in a){const A=a[p];typeof A>"u"||u.append(p,A)}return u}class L{constructor(u){this.source=u,this.isHttp=/^https?:/i.test(u.url),this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new _(this),this._fullRequestReader}getRangeReader(u,p){if(p<=this._progressiveDataLength)return null;const A=new s(this,u,p);return this._rangeRequestReaders.push(A),A}cancelAllRequests(u){this._fullRequestReader&&this._fullRequestReader.cancel(u);for(const p of this._rangeRequestReaders.slice(0))p.cancel(u)}}e.PDFFetchStream=L;class _{constructor(u){this._stream=u,this._reader=null,this._loaded=0,this._filename=null;const p=u.source;this._withCredentials=p.withCredentials||!1,this._contentLength=p.length,this._headersCapability=(0,n.createPromiseCapability)(),this._disableRange=p.disableRange||!1,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._headers=R(this._stream.httpHeaders);const A=p.url;fetch(A,O(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,d.validateResponseStatus)(o.status))throw(0,d.createResponseStatusError)(o.status,A);this._reader=o.body.getReader(),this._headersCapability.resolve();const g=k=>o.headers.get(k),{allowRangeRequests:b,suggestedLength:D}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=D||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:u,done:p}=await this._reader.read();return p?{value:u,done:p}:(this._loaded+=u.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){this._reader&&this._reader.cancel(u),this._abortController.abort()}}class s{constructor(u,p,A){this._stream=u,this._reader=null,this._loaded=0;const o=u.source;this._withCredentials=o.withCredentials||!1,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController,this._headers=R(this._stream.httpHeaders),this._headers.append("Range",`bytes=${p}-${A-1}`);const g=o.url;fetch(g,O(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,d.validateResponseStatus)(b.status))throw(0,d.createResponseStatusError)(b.status,g);this._readCapability.resolve(),this._reader=b.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:u,done:p}=await this._reader.read();return p?{value:u,done:p}:(this._loaded+=u.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){this._reader&&this._reader.cancel(u),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__($){var e=__webpack_module_cache__[$];if(e!==void 0)return e.exports;var E=__webpack_module_cache__[$]={exports:{}};return __webpack_modules__[$](E,E.exports,__w_pdfjs_require__),E.exports}var __webpack_exports__={};return(()=>{var $=__webpack_exports__;Object.defineProperty($,"__esModule",{value:!0}),Object.defineProperty($,"AnnotationEditorLayer",{enumerable:!0,get:function(){return d.AnnotationEditorLayer}}),Object.defineProperty($,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty($,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty($,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return O.AnnotationEditorUIManager}}),Object.defineProperty($,"AnnotationLayer",{enumerable:!0,get:function(){return R.AnnotationLayer}}),Object.defineProperty($,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty($,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty($,"GlobalWorkerOptions",{enumerable:!0,get:function(){return L.GlobalWorkerOptions}}),Object.defineProperty($,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty($,"LoopbackPort",{enumerable:!0,get:function(){return E.LoopbackPort}}),Object.defineProperty($,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty($,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty($,"PDFDataRangeTransport",{enumerable:!0,get:function(){return E.PDFDataRangeTransport}}),Object.defineProperty($,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty($,"PDFWorker",{enumerable:!0,get:function(){return E.PDFWorker}}),Object.defineProperty($,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty($,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty($,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty($,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty($,"SVGGraphics",{enumerable:!0,get:function(){return a.SVGGraphics}}),Object.defineProperty($,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return e.UNSUPPORTED_FEATURES}}),Object.defineProperty($,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty($,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty($,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty($,"XfaLayer",{enumerable:!0,get:function(){return u.XfaLayer}}),Object.defineProperty($,"build",{enumerable:!0,get:function(){return E.build}}),Object.defineProperty($,"createPromiseCapability",{enumerable:!0,get:function(){return e.createPromiseCapability}}),Object.defineProperty($,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty($,"getDocument",{enumerable:!0,get:function(){return E.getDocument}}),Object.defineProperty($,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty($,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty($,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty($,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty($,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty($,"renderTextLayer",{enumerable:!0,get:function(){return s.renderTextLayer}}),Object.defineProperty($,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty($,"version",{enumerable:!0,get:function(){return E.version}});var e=__w_pdfjs_require__(1),E=__w_pdfjs_require__(4),n=__w_pdfjs_require__(8),d=__w_pdfjs_require__(22),O=__w_pdfjs_require__(7),R=__w_pdfjs_require__(27),L=__w_pdfjs_require__(15),_=__w_pdfjs_require__(3),s=__w_pdfjs_require__(30),a=__w_pdfjs_require__(31),u=__w_pdfjs_require__(29);if(_.isNodeJS){const{PDFNodeStream:p}=__w_pdfjs_require__(32);(0,E.setPDFNetworkStreamFactory)(A=>new p(A))}else{const{PDFNetworkStream:p}=__w_pdfjs_require__(35),{PDFFetchStream:A}=__w_pdfjs_require__(36);(0,E.setPDFNetworkStreamFactory)(o=>(0,n.isValidFetchUrl)(o.url)?new A(o):new p(o))}})(),__webpack_exports__})())}(pdf$2)),pdf$2.exports}var pdfExports=requirePdf();const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
